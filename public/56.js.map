{"version":3,"sources":["webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.Particle/index.js","webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.Particle/Viewing.Extension.Particle.js","webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.Particle/Viewing.Extension.Particle.Tool.PointCloud.js","webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.Particle/Viewing.Extension.Particle.Tool.Mesh.js","webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.Particle/Viewing.Tool.Particle.Translate.js","webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.Particle/TransformGizmos.js","webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.Particle/Viewing.Extension.Particle.Panel.js","webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.Particle/utils/GUIObjectAdapter.js","webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.Particle/utils/ToolPanelBase.js","webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.Particle/utils/ToolPanelBase.css?5653","webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.Particle/utils/ToolPanelBase.css","webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.Particle/Viewing.Extension.Particle.css?bec8","webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.Particle/Viewing.Extension.Particle.css","webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.Particle/utils/FPSMeter.js","webpack:///./src/client/components/Viewer/Extensions/Viewer.MultiModelExtensionBase/index.js","webpack:///./src/client/components/Viewer/Extensions/Viewer.MultiModelExtensionBase/Viewer.MultiModelExtensionBase.js","webpack:///./src/client/components/Viewer/Extensions/Viewer.ExtensionBase/index.js","webpack:///./src/client/components/Viewer/Extensions/Viewer.ExtensionBase/Viewer.ExtensionBase.js","webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.Particle/ParticleSystem/Vector.js","webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.Particle/ParticleSystem/BaseObject.js","webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.Particle/ParticleSystem/ParticleEmitter.js","webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.Particle/ParticleSystem/MagneticField.js","webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.Particle/ParticleSystem/Field.js","webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.Particle/ParticleSystem/EventsEmitter.js","webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.Particle/ParticleSystem/Particle.js","webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.Particle/ParticleSystem/ParticleSystem.js","webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.Particle/ParticleSystem/index.js"],"names":["__webpack_require__","r","__webpack_exports__","ParticleExtension","viewer","options","_this","_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2___default","this","_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4___default","_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5___default","call","particlePanel","transformTool","TranslateTool","objectMaterials","createObjectMaterials","maxParticles","particleSystem","ParticleSystem","Instance","particleToolPointCloud","ParticleToolPointCloud","particleToolMesh","ParticleToolMesh","activeParticleTool","tool","console","log","loader","show","_this2","loadScene","then","setProgressiveRendering","$","container","append","css","position","left","top","fps","FPSMeter","document","getElementById","maxFps","smoothing","decimals","theme","heat","graph","toggleOn","history","onTxChange","bind","on","event","onSelect","tick","activate","autoStart","loadPanel","_this3","ParticlePanel","onObjectModified","value","setMaxParticles","active","clearParticles","deactivate","loadToolGUI","activateShaders","setVisible","remove","off","destroy","txChange","_this4","dbIds","forEach","dbId","updateObjectPosition","select","length","obj","getObjectById","setSelected","transformable","getTransformable","selectable","getSelectable","property","matIdx","material","Toolkit","setMaterial","model","object","getId","props","THREE","MeshPhongMaterial","impl","matman","addMaterial","name","createMaterial","shading","FlatShading","guid","shininess","specular","parseInt","color","getWorldBoundingBox","bbox","setPosition","min","x","max","y","z","_this5","Promise","resolve","reject","search","_ref","_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default","_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default","a","mark","_callee2","propSettings","settings","i","propBounds","tasks","wrap","_context2","prev","next","abrupt","getProperty","sent","JSON","parse","displayValue","setDof","dof","bounds","push","parseBound","loadEmitters","loadObjects","loadFields","all","t0","stop","_x2","apply","arguments","propBound","bound","type","center","Vector","size","_this6","_ref2","_callee3","_context3","clr","transparent","opacity","_x3","_x4","_this7","map","loadObject","_this8","_ref3","_callee4","emitter","offset","magnitude","_context4","addEmitter","setTransformable","transfo","setEmissionRate","rate","setSelectable","setVelocity","velocity","setCharge","charge","setSpread","spread","dir","setOffset","getX","getY","getZ","_x5","_x6","_this9","loadEmitter","_this10","_ref4","_callee5","field","_context5","addMagneticField","setForce","force","_x7","_x8","_this11","loadField","MultiModelExtensionBase","Autodesk","Viewing","theExtensionManager","registerExtension","ExtensionId","undefined","_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default","_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default","_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default","toolController","registerTool","_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default","stopwatch","Stopwatch","getElapsedMs","pointCloud","createPointCloud","activateTool","getName","emit","deactivateTool","geometry","vertices","verticesNeedUpdate","invalidate","particle","result","getPosition","withinSphere","withinBox","step","initParticleLoop","index","nextParticle","ptr","updateParticle","vertex","getRecycled","filterParticle","setLifeTime","pos","maxPoints","vertexShader","fragmentShader","shader","side","DoubleSide","depthWrite","depthTest","attributes","Geometry","Vector3","Vector4","Math","random","shaderMaterial","ShaderMaterial","PointCloud","scene","add","EventsEmitter","nbParticleTypes","particleMaterials","createRandomMaterials","shaders","destroyParticle","nb","materials","mesh","updateChunk","setTimeout","start","Date","getTime","randomInt","createMesh","getRadius","visible","uniforms","updateParticleShadersOn","updateParticleShadersOff","SphereGeometry","Mesh","floor","TransformTool","_dbIds","_hitPoint","_selectSet","_isDragging","_transformMesh","_modifiedFragIdMap","_transformControlTx","_selectedFragProxyMap","onAggregateSelectionChanged","onCameraChanged","handleSelectionChanged","sphere","set","fragId","fragProxy","updateAnimTransform","sceneUpdated","fragIds","Object","keys","update","dbIdArray","fragIdsArray","selections","selection","removeEventListener","CAMERA_CHANGE_EVENT","addEventListener","getFragmentProxy","getAnimTransform","screenPoint","viewport","navigation","getScreenViewport","width","height","clientX","clientY","n","normalize","utilities","getHitPoint","getBoundingBox","createOverlayScene","TransformControls","camera","canvas","setSize","getBoundingSphere","radius","addOverlay","createTransformMesh","attach","AGGREGATE_SELECTION_CHANGED_EVENT","removeOverlay","removeOverlayScene","button","onPointerDown","onPointerUp","onPointerMove","onPointerHover","GizmoMaterial","parameters","MeshBasicMaterial","FrontSide","setValues","oldColor","clone","oldOpacity","highlight","highlighted","setRGB","copy","prototype","create","GizmoLineMaterial","LineBasicMaterial","linewidth","PolyhedronGeometry","indices","detail","that","l","prepare","p","faces","j","v1","v2","v3","Face3","centroid","subdivide","faceVertexUvs","uvs","x0","x1","x2","multiplyScalar","vector","u","azimuth","PI","v","atan2","sqrt","inclination","uv","Vector2","make","face","divideScalar","azi","correctUV","cols","pow","b","c","aj","lerp","bj","rows","k","mergeVertices","computeFaceNormals","boundingSphere","Sphere","OctahedronGeometry","TorusGeometry","tube","radialSegments","tubularSegments","arc","normals","cos","sin","sub","d","createCircleGeometry","facing","createArrowGeometry","radiusTop","radiusBottom","heightSegments","openEnded","arrowGeometry","CylinderGeometry","updateMatrix","merge","matrix","createLineGeometry","axis","lineGeometry","TransformGizmo","scope","init","Object3D","handles","pickers","planes","highlights","hemiPicker","subPickers","planeGeometry","PlaneBufferGeometry","planeMaterial","wireframe","XY","YZ","XZ","XYZE","activePlane","rotation","setupGizmos","activeMode","traverse","child","tempGeometry","BufferGeometry","fromBufferGeometry","scale","hide","parent","addGizmos","gizmoMap","visble","setHandlePickerGizmos","handleGizmos","pickerGizmos","highlightGizmos","hemiPickerGizmos","subPickerGizmos","eye","vec1","vec2","lookAtMatrix","Matrix4","quaternion","setFromRotationMatrix","lookAt","setFromEuler","TransformGizmoTranslate","lineXGeometry","lineYGeometry","lineZGeometry","X","Line","Y","Z","XYZ","BoxGeometry","setActivePlane","tempMatrix","applyMatrix4","getInverse","extractRotation","matrixWorld","abs","TransformGizmoRotate","RX","RY","RZ","RE","RXYZE","eye2","worldRotation","Euler","tempQuaternion","Quaternion","unitX","unitY","unitZ","quaternionX","quaternionY","quaternionZ","makeRotationFromQuaternion","setFromAxisAngle","multiplyQuaternions","TransformGizmoTranslateRotate","theta","useAllPickers","TransformGizmoScale","domElement","mode","gizmo","snap","snapDelta","space","normal","startLine","endLine","LineDashedMaterial","centerLine","ImageUtils","loadTexture","Private","getResourceUrl","magFilter","minFilter","NearestFilter","CircleGeometry","centerMark","ticks","h","_dragging","_mode","changeEvent","mouseDownEvent","mouseUpEvent","objectChangeEvent","ray","Raycaster","pointerVector","pointerDir","point","offsetRotation","tempVector","projX","projY","projZ","quaternionXYZ","quaternionE","oldPosition","oldScale","oldRotationMatrix","parentRotationMatrix","parentScale","worldPosition","worldRotationMatrix","camPosition","intersectObjects","pointer","objects","rect","getBoundingClientRect","isPerspective","unproject","transformDirection","intersections","updateUnitVectors","detach","setMode","dispatchEvent","getPicker","children","setNormal","setFromUnitVectors","applyQuaternion","multiply","setSnap","delta","setSpace","updateMatrixWorld","setFromMatrixPosition","applyEuler","dist","distanceTo","tan","fov","showRotationGizmos","intersect","pointers","pointerType","planeIntersect","setFromMatrixScale","getAttribute","pt1","fromAttribute","pt2","pt3","pt4","dashSize","gapSize","computeLineDistances","dot","rotz","rotsnap","round","tempAxis","cross","rot","angleTo","projx","projy","projz","tempx","tempy","tempz","rotx","roty","matrixAutoUpdate","extension","btnElement","buttonElement","closable","addClass","gui","dat","GUI","autoPlace","id","appendChild","folder","addFolder","maxParticleCtrl","onFinishChange","toolCtrl","open","style","concat","getType","selectedObjectGUI","GUIObjectAdapter","getEmitter","emissionRate","getter","setter","emitterFolder","onChange","getMagneticField","fieldFolder","window","meshFolder","shadersCtrl","loadObjectGUI","ToolPanelBase","mapping","key","title","_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_1___default","_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_2___default","assign","shadow","movable","_dialogResult","_events","_isVisible","_isMinimized","_btnElement","format","replace","toString","classList","_babel_runtime_helpers_get__WEBPACK_IMPORTED_MODULE_3___default","createTitleBar","titleLabel","setTitle","initializeMoveHandlers","closer","createCloseButton","$content","htmlContent","content","titleBar","createElement","className","titleTextId","titleImgId","html","movedSinceLastClick","onTitleClick","onTitleDoubleClick","text","localizeTitle","attr","i18n","translate","removeAttr","_height","min-height","fct","splice","indexOf","handlers","slice","Array","UI","DockingPanel","module","locals","exports","w","newEl","applyTheme","element","e","String","_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0___default","match","toLowerCase","inArray","array","extend","args","hasOwnProperty","componentToHex","listener","eventName","handler","attachEvent","perf","performance","now","webkitNow","perfNow","cAF","cancelAnimationFrame","cancelRequestAnimationFrame","rAF","requestAnimationFrame","vendors","lastTime","callback","currTime","timeToCall","clearTimeout","textProp","textContent","anchor","nodeType","body","heatmaps","time","frameID","renderID","graphHeight","count","self","o","defaults","el","heatDepth","heating","frameTime","threshold","frameStart","lastLoop","fpsHistory","durationHistory","showFps","getHeat","heatmap","updateCounter","legend","duration","toFixed","render","interval","historyTick","heatOn","column","requestRender","eventHandler","preventDefault","stopPropagation","returnValue","cancelBubble","toggle","removeMeter","removeChild","createMeter","compiledHeatmaps","s","saturation","lightness","g","sextant","vsf","setTheme","spacing","bottom","right","positionMeter","clientHeight","cursor","isPaused","tickStart","pause","resume","rebuilders","repositioners","showDuration","display","zIndex","margin","base","padding","minWidth","lineHeight","textAlign","textShadow","fontSize","fontFamily","boxSizing","MozBoxSizing","dark","background","border","light","boxShadow","colorful","backgroundColor","_Viewer_MultiModelExtensionBase__WEBPACK_IMPORTED_MODULE_0__","defaultOptions","_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default","_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3___default","_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4___default","_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_5___default","serviceContext","onModelCompletedLoad","onObjectTreeCreated","onModelRootLoaded","onExtensionLoaded","onModelActivated","onGeometryLoaded","onToolbarCreated","onModelBeginLoad","onModelUnloaded","onSelection","__onModelRootLoaded","__onModelActivated","__onModelUnloaded","__onModelLoaded","models","modelQueue","getModels","initializeEvents","viewerEvents","eventSink","viewerEvent","OBJECT_TREE_CREATED_EVENT","GEOMETRY_LOADED_EVENT","_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default","filter","EXTENSION_LOADED_EVENT","MODEL_ROOT_LOADED_EVENT","TOOLBAR_CREATED_EVENT","eventId","eventTasks","isArray","__handler","Composer","Extension","_Viewer_ExtensionBase__WEBPACK_IMPORTED_MODULE_0__","ViewerExtensionBase","ExtensionBase","_viewer","_options","classCallCheck_default","_x","_y","_z","m","scaleFactor","data","BaseObject","_offset","_position","_selectable","_transformable","_type","_id","ParticleEmitter","possibleConstructorReturn_default","getPrototypeOf_default","_spread","_emissionRate","_velocity","_charge","dt","angle1","angle2","MagneticField","_force","particlePos","fieldPos","dX","dY","dZ","particleAcc","_acceleration","Field","tmpArray","Particle","_recycled","_radius","_dof","_lifeTime","fields","applyForce","lifeTime","_maxParticles","_emittedParticles","_particleIdx","_recycleBin","_particles","_emitters","_fields","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","done","err","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","addNewParticles","filterParticles","emitNumber","popRecycle","emitParticle","pop","reset","pushRecycle","submitToFields"],"mappings":"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","file":"56.js","sourcesContent":["import './Viewing.Extension.Particle'\n\nexport default 'Viewing.Extension.Particle'\n","/// //////////////////////////////////////////////////////////////////\n// Viewing.Extension.Particle\n// by Philippe Leefsma, March 2016\n//\n/// //////////////////////////////////////////////////////////////////\nimport ParticleToolPointCloud from './Viewing.Extension.Particle.Tool.PointCloud'\nimport ParticleToolMesh from './Viewing.Extension.Particle.Tool.Mesh'\nimport MultiModelExtensionBase from 'Viewer.MultiModelExtensionBase'\nimport TranslateTool from './Viewing.Tool.Particle.Translate'\nimport ParticlePanel from './Viewing.Extension.Particle.Panel'\nimport ExtensionBase from 'Viewer.ExtensionBase'\nimport ParticleSystem from './ParticleSystem'\nimport Toolkit from 'Viewer.Toolkit'\nimport FPS from './utils/FPSMeter'\nimport dat from 'dat-gui'\n\nclass ParticleExtension extends MultiModelExtensionBase {\n  /// //////////////////////////////////////////////////////////////\n  // Class constructor\n  //\n  /// //////////////////////////////////////////////////////////////\n  constructor (viewer, options) {\n    super(viewer, options)\n\n    this.options = options\n\n    this.viewer = viewer\n\n    this.particlePanel = null\n\n    this.transformTool = new TranslateTool(\n      this.viewer)\n\n    this.objectMaterials =\n      this.createObjectMaterials()\n\n    this.maxParticles = this.options.maxParticles || 0\n\n    this.particleSystem = new ParticleSystem.Instance(\n      this.maxParticles)\n\n    this.particleToolPointCloud = new ParticleToolPointCloud(\n      this.viewer, this.particleSystem, options)\n\n    this.particleToolMesh = new ParticleToolMesh(\n      this.viewer, this.particleSystem, options)\n\n    this.activeParticleTool = this.particleToolMesh\n\n    this.tool = 'Point Cloud'\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  // Extension Id\n  //\n  /// //////////////////////////////////////////////////////////////\n  static get ExtensionId () {\n    return 'Viewing.Extension.Particle'\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  // Load callback\n  //\n  /// //////////////////////////////////////////////////////////////\n  load () {\n    console.log('Viewing.Extension.Particle loaded')\n\n    return true\n  }\n\n  /// //////////////////////////////////////////////////////\n  //\n  //\n  /// //////////////////////////////////////////////////////\n  onModelRootLoaded () {\n    this.options.loader.show(false)\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  //\n  //\n  /// //////////////////////////////////////////////////////////////\n  onGeometryLoaded () {\n    this.loadScene().then(() => {\n      this.viewer.setProgressiveRendering(false)\n\n      $(this.viewer.container).append(\n        '<div id=\"particle-toolbar\"> </div>')\n\n      $('#particle-toolbar').css({\n        position: 'absolute',\n        left: '10px',\n        top: '90px'\n      })\n\n      var fps = new FPSMeter(\n        document.getElementById('particle-toolbar'), {\n          maxFps: 20, // expected\n          smoothing: 10,\n          show: 'fps',\n          decimals: 1,\n          left: '0px',\n          top: '-80px',\n          theme: 'transparent',\n          heat: 1,\n          graph: 1,\n          toggleOn: null,\n          history: 32\n        })\n\n      this.onTxChange =\n        this.onTxChange.bind(this)\n\n      this.transformTool.on('transform.TxChange',\n        this.onTxChange)\n\n      this.transformTool.on('transform.select',\n        (event) => {\n          return this.onSelect(event)\n        })\n\n      this.particleToolMesh.on('fps.tick', () => {\n        fps.tick()\n      })\n\n      this.particleToolPointCloud.on('fps.tick', () => {\n        fps.tick()\n      })\n\n      this.transformTool.activate()\n\n      this.activeParticleTool = this.particleToolPointCloud\n\n      if (this.options.autoStart) {\n        this.particleToolPointCloud.activate()\n      }\n\n      this.loadPanel()\n    })\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  // load control panel\n  //\n  /// //////////////////////////////////////////////////////////////\n  loadPanel () {\n    this.particlePanel = new ParticlePanel(\n      this, this.viewer, null)\n\n    this.particlePanel.on('objectModified', (event) => {\n      this.onObjectModified(event)\n    })\n\n    this.particlePanel.on('maxParticles.changed', (value) => {\n      this.particleToolPointCloud.setMaxParticles(value)\n\n      this.particleToolMesh.setMaxParticles(value)\n\n      this.particleSystem.setMaxParticles(value)\n\n      if (value > 0) {\n        if (!this.activeParticleTool.active) {\n          this.activeParticleTool.activate()\n        } else {\n          this.activeParticleTool.clearParticles()\n        }\n      } else {\n        this.activeParticleTool.deactivate()\n      }\n    })\n\n    this.particlePanel.on('tool.changed', (value) => {\n      switch (value) {\n        case 'Mesh':\n          this.activeParticleTool = this.particleToolMesh\n          this.particleToolPointCloud.deactivate()\n          this.particleToolMesh.activate()\n          break\n\n        case 'Point Cloud':\n          this.activeParticleTool = this.particleToolPointCloud\n          this.particleToolPointCloud.activate()\n          this.particleToolMesh.deactivate()\n          break\n      }\n\n      this.particlePanel.loadToolGUI(this.activeParticleTool)\n    })\n\n    this.particlePanel.on('shaders.changed', (value) => {\n      this.particleToolMesh.activateShaders(value === 'ON')\n    })\n\n    this.particlePanel.setVisible(true)\n\n    this.particlePanel.loadToolGUI(\n      this.activeParticleTool)\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  // Unload callback\n  //\n  /// //////////////////////////////////////////////////////////////\n  unload () {\n    console.log('Viewing.Extension.Particle unloaded')\n\n    $('#particle-toolbar').remove()\n\n    if (this.particlePanel) {\n      this.particlePanel.setVisible(false)\n    }\n\n    if (this.viewer.activeParticleTool) {\n      this.viewer.activeParticleTool.deactivate()\n    }\n\n    this.transformTool.off()\n\n    this.transformTool.deactivate()\n\n    this.particleToolMesh.particleSystem.destroy()\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  //\n  //\n  /// //////////////////////////////////////////////////////////////\n  onTxChange (txChange) {\n    txChange.dbIds.forEach((dbId) => {\n      this.updateObjectPosition(dbId)\n    })\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  //\n  //\n  /// //////////////////////////////////////////////////////////////\n  onSelect (select) {\n    if (select.dbIds.length) {\n      var obj = this.particleSystem.getObjectById(\n        select.dbIds[0])\n\n      if (this.particlePanel) {\n        this.particlePanel.setSelected(obj)\n      }\n\n      if (obj) {\n        return {\n          transformable: obj.getTransformable(),\n          selectable: obj.getSelectable()\n        }\n      }\n\n      return { selectable: false }\n    } else {\n      if (this.particlePanel) {\n        this.particlePanel.setSelected(null)\n      }\n    }\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  //\n  //\n  /// //////////////////////////////////////////////////////////////\n  onObjectModified (event) {\n    switch (event.property) {\n      case 'charge':\n      case 'force':\n\n        // red material < 0\n        // blue material >= 0\n        var matIdx = event.value < 0 ? 0 : 1\n\n        var material = this.objectMaterials[matIdx]\n\n        Toolkit.setMaterial(\n          this.viewer.model,\n          event.object.getId(),\n          material)\n\n        break\n    }\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  //\n  //\n  /// //////////////////////////////////////////////////////////////\n  createMaterial (props) {\n    var material = new THREE.MeshPhongMaterial(props)\n\n    this.viewer.impl.matman().addMaterial(\n      props.name,\n      material,\n      true)\n\n    return material\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  // Creates object materials\n  //\n  /// //////////////////////////////////////////////////////////////\n  createObjectMaterials () {\n    var materials = [\n\n      this.createMaterial({\n        shading: THREE.FlatShading,\n        name: Toolkit.guid(),\n        shininess: 80,\n        specular: parseInt('B80000', 16),\n        color: parseInt('B80000', 16)\n      }),\n\n      this.createMaterial({\n        shading: THREE.FlatShading,\n        name: Toolkit.guid(),\n        shininess: 80,\n        specular: parseInt('0000B8', 16),\n        color: parseInt('0000B8', 16)\n      })\n    ]\n\n    return materials\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  // Update object position\n  //\n  /// //////////////////////////////////////////////////////////////\n  async updateObjectPosition (dbId) {\n    var bbox = await Toolkit.getWorldBoundingBox(\n      this.viewer.model, dbId)\n\n    var obj = this.particleSystem.getObjectById(dbId)\n\n    obj.setPosition(\n      (bbox.min.x + bbox.max.x) / 2,\n      (bbox.min.y + bbox.max.y) / 2,\n      (bbox.min.z + bbox.max.z) / 2)\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  // Load Scene settings from properties\n  //\n  /// //////////////////////////////////////////////////////////////\n  loadScene () {\n    return new Promise((resolve, reject) => {\n      this.viewer.search('particle.scene', async (dbIds) => {\n        if (dbIds.length != 1) { return reject('Invalid Particle scene') }\n\n        try {\n          var propSettings = await Toolkit.getProperty(\n            this.viewer.model, dbIds[0], 'particle.settings')\n\n          var settings = JSON.parse(\n            propSettings.displayValue)\n\n          this.particleSystem.setDof(\n            settings.dof[0],\n            settings.dof[1],\n            settings.dof[2])\n\n          this.bounds = []\n\n          for (var i = 1; i <= settings.bounds; ++i) {\n            var propBounds = await Toolkit.getProperty(\n              this.viewer.model, dbIds[0], 'particle.bound' + i)\n\n            this.bounds.push(this.parseBound(propBounds))\n          }\n\n          this.particleToolPointCloud.bounds = this.bounds\n\n          this.particleToolMesh.bounds = this.bounds\n\n          var tasks = [\n            this.loadEmitters(),\n            this.loadObjects(),\n            this.loadFields()\n          ]\n\n          return resolve(Promise.all(tasks))\n        } catch (ex) {\n          return reject(ex)\n        }\n      })\n    })\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  // Parses scene bounds\n  //\n  /// //////////////////////////////////////////////////////////////\n  parseBound (propBound) {\n    var bound = JSON.parse(propBound.displayValue)\n\n    switch (bound.type) {\n      case 'box':\n\n        return {\n\n          center: new ParticleSystem.Vector(\n            bound.center[0],\n            bound.center[1],\n            bound.center[2]),\n\n          size: new ParticleSystem.Vector(\n            bound.size[0],\n            bound.size[1],\n            bound.size[2]),\n\n          type: 'box'\n        }\n\n      case 'sphere':\n\n        return {\n\n          center: new ParticleSystem.Vector(\n            bound.center[0],\n            bound.center[1],\n            bound.center[2]),\n\n          min: bound.min,\n          max: bound.max,\n          type: 'sphere'\n        }\n    }\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  // Loads scene objects\n  //\n  /// //////////////////////////////////////////////////////////////\n  loadObject (dbId) {\n    return new Promise(async (resolve, reject) => {\n      try {\n        var propSettings = await Toolkit.getProperty(\n          this.viewer.model, dbId, 'particle.settings')\n\n        var settings = JSON.parse(\n          propSettings.displayValue)\n\n        var color = parseInt(settings.clr, 16)\n\n        var material = this.createMaterial({\n          transparent: settings.transparent,\n          opacity: settings.opacity,\n          shading: THREE.FlatShading,\n          name: Toolkit.guid(),\n          shininess: 30,\n          specular: color,\n          color: color\n        })\n\n        Toolkit.setMaterial(\n          this.viewer.model, dbId, material)\n\n        return resolve()\n      } catch (ex) {\n        // throwing Invalid DbId\n        // return reject(ex)\n        return resolve()\n      }\n    })\n  }\n\n  loadObjects () {\n    return new Promise((resolve, reject) => {\n      this.viewer.search('particle.object', (dbIds) => {\n        var tasks = dbIds.map((dbId) => {\n          return this.loadObject(dbId)\n        })\n\n        return resolve(Promise.all(tasks))\n      })\n    })\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  // Load scene emitters\n  //\n  /// //////////////////////////////////////////////////////////////\n  loadEmitter (dbId) {\n    return new Promise(async (resolve, reject) => {\n      try {\n        var bbox = await Toolkit.getWorldBoundingBox(\n          this.viewer.model, dbId)\n\n        var emitter = this.particleSystem.addEmitter(dbId)\n\n        var propSettings = await Toolkit.getProperty(\n          this.viewer.model, dbId, 'particle.settings')\n\n        var settings = JSON.parse(\n          propSettings.displayValue)\n\n        emitter.setTransformable(settings.transfo)\n        emitter.setEmissionRate(settings.rate)\n        emitter.setSelectable(settings.select)\n        emitter.setVelocity(settings.velocity)\n        emitter.setCharge(settings.charge)\n        emitter.setSpread(settings.spread)\n\n        var offset = new ParticleSystem.Vector(\n          settings.dir[0],\n          settings.dir[1],\n          settings.dir[2])\n\n        var magnitude = offset.magnitude()\n\n        emitter.setOffset(\n          offset.getX() * 0.5 / magnitude,\n          offset.getY() * 0.5 / magnitude,\n          offset.getZ() * 0.5 / magnitude)\n\n        emitter.setPosition(\n          (bbox.min.x + bbox.max.x) / 2,\n          (bbox.min.y + bbox.max.y) / 2,\n          (bbox.min.z + bbox.max.z) / 2)\n\n        var matIdx = emitter.charge < 0 ? 0 : 1\n\n        var material = this.objectMaterials[matIdx]\n\n        Toolkit.setMaterial(\n          this.viewer.model,\n          dbId, material)\n\n        return resolve()\n      } catch (ex) {\n        console.log(ex)\n\n        // throwing Invalid DbId\n        // return reject(ex)\n        return resolve()\n      }\n    })\n  }\n\n  loadEmitters () {\n    return new Promise((resolve, reject) => {\n      this.viewer.search('particle.emitter', (dbIds) => {\n        var tasks = dbIds.map((dbId) => {\n          return this.loadEmitter(dbId)\n        })\n\n        return resolve(Promise.all(tasks))\n      })\n    })\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  // Load scene fields\n  //\n  /// //////////////////////////////////////////////////////////////\n  loadField (dbId) {\n    return new Promise(async (resolve, reject) => {\n      try {\n        var bbox = await Toolkit.getWorldBoundingBox(\n          this.viewer.model, dbId)\n\n        var field = this.particleSystem.addMagneticField(dbId)\n\n        var propSettings = await Toolkit.getProperty(\n          this.viewer.model, dbId,\n          'particle.settings')\n\n        var settings = JSON.parse(\n          propSettings.displayValue)\n\n        field.setTransformable(settings.transfo)\n        field.setSelectable(settings.select)\n        field.setForce(settings.force)\n\n        field.setPosition(\n          (bbox.min.x + bbox.max.x) / 2,\n          (bbox.min.y + bbox.max.y) / 2,\n          (bbox.min.z + bbox.max.z) / 2)\n\n        var matIdx = settings.force < 0 ? 0 : 1\n\n        var material = this.objectMaterials[matIdx]\n\n        Toolkit.setMaterial(\n          this.viewer.model,\n          dbId, material)\n\n        return resolve()\n      } catch (ex) {\n        // throwing Invalid DbId\n        // return reject(ex)\n        return resolve()\n      }\n    })\n  }\n\n  loadFields () {\n    return new Promise((resolve, reject) => {\n      this.viewer.search('particle.field', (dbIds) => {\n        var tasks = dbIds.map((dbId) => {\n          return this.loadField(dbId)\n        })\n\n        return resolve(Promise.all(tasks))\n      })\n    })\n  }\n}\n\nAutodesk.Viewing.theExtensionManager.registerExtension(\n  ParticleExtension.ExtensionId,\n  ParticleExtension)\n","import EventsEmitter from 'EventsEmitter'\nimport Toolkit from 'Viewer.Toolkit'\nimport Stopwatch from 'Stopwatch'\n\nexport default class ParticleToolPointCloud extends EventsEmitter {\n  /// //////////////////////////////////////////////////////////////\n  // Class constructor\n  //\n  /// //////////////////////////////////////////////////////////////\n  constructor (viewer, particleSystem, options = {}) {\n    super()\n\n    viewer.toolController.registerTool(this)\n\n    this.particleSystem = particleSystem\n\n    this.stopwatch = new Stopwatch()\n\n    this.options = options\n\n    this.viewer = viewer\n\n    this.active = false\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  // Tool names\n  //\n  /// //////////////////////////////////////////////////////////////\n  getNames () {\n    return ['Viewing.Particle.Tool.PointCloud']\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  // Tool name\n  //\n  /// //////////////////////////////////////////////////////////////\n  getName () {\n    return 'Viewing.Particle.Tool.PointCloud'\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  // Activate Tool\n  //\n  /// //////////////////////////////////////////////////////////////\n  activate () {\n    if (!this.active) {\n      this.stopwatch.getElapsedMs()\n\n      this.active = true\n\n      if (!this.pointCloud) {\n        this.createPointCloud()\n      }\n\n      this.viewer.toolController.activateTool(\n        this.getName())\n\n      this.emit('activate')\n    }\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  // Deactivate tool\n  //\n  /// //////////////////////////////////////////////////////////////\n  deactivate () {\n    if (this.active) {\n      this.active = false\n\n      this.viewer.toolController.deactivateTool(\n        this.getName())\n\n      this.clearParticles()\n\n      this.emit('deactivate')\n    }\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  //\n  //\n  /// //////////////////////////////////////////////////////////////\n  setMaxParticles (maxParticles) {\n    this.maxParticles = maxParticles\n\n    if (this.geometry) {\n      for (var i = 0; i < this.geometry.vertices.length; ++i) {\n        this.geometry.vertices[i].x = -5000\n        this.geometry.vertices[i].y = -5000\n        this.geometry.vertices[i].z = -5000\n      }\n\n      this.geometry.verticesNeedUpdate = true\n\n      this.viewer.impl.invalidate(true, false, false)\n    }\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  //\n  //\n  /// //////////////////////////////////////////////////////////////\n  clearParticles () {\n    for (var i = 0; i < this.geometry.vertices.length; ++i) {\n      this.geometry.vertices[i].x = -5000\n      this.geometry.vertices[i].y = -5000\n      this.geometry.vertices[i].z = -5000\n    }\n\n    this.geometry.verticesNeedUpdate = true\n\n    this.viewer.impl.invalidate(true, false, false)\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  //\n  //\n  /// //////////////////////////////////////////////////////////////\n  filterParticle (particle) {\n    var result = false\n\n    this.bounds.forEach((bound) => {\n      switch (bound.type) {\n        case 'sphere':\n\n          if (bound.max) {\n            if (!particle.getPosition().withinSphere(\n              bound.center, bound.max)) {\n              result = true\n            }\n          }\n\n          if (bound.min) {\n            if (particle.getPosition().withinSphere(\n              bound.center, bound.min)) {\n              result = true\n            }\n          }\n\n          break\n\n        case 'box':\n\n          if (!particle.getPosition().withinBox(\n            bound.center, bound.size)) {\n            result = true\n          }\n\n          break\n      }\n    })\n\n    return result\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  // Update loop without shaders\n  //\n  /// //////////////////////////////////////////////////////////////\n  update () {\n    this.particleSystem.step(\n      this.stopwatch.getElapsedMs() * 0.001)\n\n    this.particleSystem.initParticleLoop()\n\n    let index = -1\n\n    let particle\n\n    while (true) {\n      particle = this.particleSystem.nextParticle()\n\n      ++index\n\n      if (!particle.ptr) {\n        break\n      }\n\n      this.updateParticle(particle, index)\n    }\n\n    this.geometry.verticesNeedUpdate = true\n\n    // invalidate (needsClear, needsRender, overlayDirty)\n    this.viewer.impl.invalidate(true, false, false)\n\n    this.emit('fps.tick')\n  }\n\n  /// //////////////////////////////////////////////////////////\n  //\n  //\n  /// //////////////////////////////////////////////////////////\n  updateParticle (particle, index) {\n    var vertex = this.geometry.vertices[index]\n\n    if (particle.getRecycled()) {\n      vertex.x = -5000.0\n      vertex.y = -5000.0\n      vertex.z = -5000.0\n    } else if (this.filterParticle(particle)) {\n      particle.setLifeTime(-1)\n\n      vertex.x = -5000.0\n      vertex.y = -5000.0\n      vertex.z = -5000.0\n    } else {\n      const pos = particle.getPosition()\n\n      vertex.x = pos.getX()\n      vertex.y = pos.getY()\n      vertex.z = pos.getZ()\n\n      // var color = this.shader.uniforms.color.value\n      //\n      // color.x = Math.random()\n      // color.y = Math.random()\n      // color.z = Math.random()\n    }\n  }\n\n  /// //////////////////////////////////////////////////////////\n  // Creates 1M vertices PointCloud supported by Forge Viewer\n  //\n  /// //////////////////////////////////////////////////////////\n  createPointCloud (maxPoints = 1000000) {\n    // Vertex Shader code\n    const vertexShader = `\n      attribute vec4 color;\n      varying vec4 vColor;\n      void main() {\n        vec4 vPosition = modelViewMatrix * vec4(position, 1.0);\n        gl_Position = projectionMatrix * vPosition;\n        gl_PointSize = 4.0;\n        vColor = color;\n      }\n    `\n\n    // Fragment Shader code\n    const fragmentShader = `\n      #ifdef GL_ES\n      precision highp float;\n      #endif\n      varying vec4 vColor;\n      void main() {\n        gl_FragColor = vColor;\n      }\n    `\n\n    // Shader material parameters\n    this.shader = {\n      side: THREE.DoubleSide,\n      depthWrite: false,\n      depthTest: false,\n      fragmentShader,\n      vertexShader,\n      attributes: {\n        color: {\n          type: 'v4',\n          value: []\n        }\n      }\n    }\n\n    // Initialize geometry vertices\n    // and shader attribute colors\n    this.geometry = new THREE.Geometry()\n\n    for (var i = 0; i < maxPoints; ++i) {\n      this.geometry.vertices.push(\n        new THREE.Vector3(-5000, -5000, -5000))\n\n      this.shader.attributes.color.value.push(\n        new THREE.Vector4(\n          Math.random(),\n          Math.random(),\n          Math.random(),\n          1.0)\n      )\n    }\n\n    // creates shader material\n    const shaderMaterial =\n      new THREE.ShaderMaterial(\n        this.shader)\n\n    // creates THREE.PointCloud\n    this.pointCloud = new THREE.PointCloud(\n      this.geometry, shaderMaterial)\n\n    // adds to the viewer scene\n    this.viewer.impl.scene.add(this.pointCloud)\n\n    // triggers refresh\n    this.viewer.impl.invalidate(true)\n  }\n}\n","import EventsEmitter from 'EventsEmitter'\nimport Toolkit from 'Viewer.Toolkit'\nimport Stopwatch from 'Stopwatch'\n\nconst vertexShader = `\n\n  // switch on high precision floats\n  #ifdef GL_ES\n  precision highp float;\n  #endif\n\n  uniform vec3 offset;\n\n  void main() {\n\n    vec3 newPosition = position + offset;\n\n    gl_Position = projectionMatrix *\n      modelViewMatrix *\n      vec4(newPosition, 1.0);\n  }\n`\n\nconst fragmentShader = `\n\n  #ifdef GL_ES\n  precision highp float;\n  #endif\n\n  uniform vec4 color;\n\n  void main() {\n\n    gl_FragColor = color;\n  }\n`\n\nexport default class ParticleToolMesh extends EventsEmitter {\n  /// //////////////////////////////////////////////////////////////\n  // Class constructor\n  //\n  /// //////////////////////////////////////////////////////////////\n  constructor (viewer, particleSystem, options = {}) {\n    super()\n\n    this.viewer = viewer\n\n    viewer.toolController.registerTool(this)\n\n    this.particleSystem = particleSystem\n\n    this.stopwatch = new Stopwatch()\n\n    this.nbParticleTypes = 50\n\n    this.particleMaterials =\n      this.createRandomMaterials(\n        this.nbParticleTypes)\n\n    this.activateShaders(true)\n\n    this.options = options\n\n    this.shaders = 'ON'\n\n    this.active = false\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  // Tool names\n  //\n  /// //////////////////////////////////////////////////////////////\n  getNames () {\n    return ['Viewing.Particle.Tool.Mesh']\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  // Tool name\n  //\n  /// //////////////////////////////////////////////////////////////\n  getName () {\n    return 'Viewing.Particle.Tool.Mesh'\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  // Activate Tool\n  //\n  /// //////////////////////////////////////////////////////////////\n  activate () {\n    if (!this.active) {\n      console.log(this.getName() + ' activated')\n\n      this.stopwatch.getElapsedMs()\n\n      this.active = true\n\n      this.viewer.toolController.activateTool(\n        this.getName())\n\n      this.emit('activate')\n    }\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  // Deactivate tool\n  //\n  /// //////////////////////////////////////////////////////////////\n  deactivate () {\n    if (this.active) {\n      console.log(this.getName() + ' deactivated')\n\n      this.active = false\n\n      this.viewer.toolController.deactivateTool(\n        this.getName())\n\n      this.clearParticles()\n\n      this.emit('deactivate')\n    }\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  //\n  //\n  /// //////////////////////////////////////////////////////////////\n  setMaxParticles (maxParticles) {\n\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  //\n  //\n  /// //////////////////////////////////////////////////////////////\n  clearParticles () {\n    this.particleSystem.initParticleLoop()\n\n    while (true) {\n      var particle = this.particleSystem.nextParticle()\n\n      if (!particle.ptr) {\n        break\n      }\n\n      this.destroyParticle(particle)\n    }\n\n    this.viewer.impl.invalidate(true)\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  // Creates a bunch of materials with random colors\n  //\n  /// //////////////////////////////////////////////////////////////\n  createRandomMaterials (nb) {\n    var materials = []\n\n    for (var i = 0; i < nb; ++i) {\n      var clr = Math.random() * 16777215\n\n      materials.push(this.createMaterial({\n        shading: THREE.FlatShading,\n        name: Toolkit.guid(),\n        shininess: 50,\n        specular: clr,\n        color: clr\n      }))\n    }\n\n    return materials\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  //\n  //\n  /// //////////////////////////////////////////////////////////////\n  destroyParticle (particle) {\n    this.viewer.impl.scene.remove(\n      particle.mesh)\n\n    particle.mesh = null\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  //\n  //\n  /// //////////////////////////////////////////////////////////////\n  filterParticle (particle) {\n    var result = false\n\n    this.bounds.forEach((bound) => {\n      switch (bound.type) {\n        case 'sphere':\n\n          if (bound.max) {\n            if (!particle.getPosition().withinSphere(\n              bound.center, bound.max)) {\n              result = true\n            }\n          }\n\n          if (bound.min) {\n            if (particle.getPosition().withinSphere(\n              bound.center, bound.min)) {\n              result = true\n            }\n          }\n\n          break\n\n        case 'box':\n\n          if (!particle.getPosition().withinBox(\n            bound.center, bound.size)) {\n            result = true\n          }\n\n          break\n      }\n    })\n\n    return result\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  // Update loop without shaders\n  //\n  /// //////////////////////////////////////////////////////////////\n  update () {\n    this.particleSystem.step(\n      this.stopwatch.getElapsedMs() * 0.001)\n\n    this.updateChunk()\n\n    // invalidate (needsClear, needsRender, overlayDirty)\n    this.viewer.impl.invalidate(true, false, false)\n\n    this.emit('fps.tick')\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  //\n  //\n  /// //////////////////////////////////////////////////////////////\n  updateChunk () {\n    this.particleSystem.initParticleLoop()\n\n    let particle\n\n    const tick = () => {\n      var start = new Date().getTime()\n\n      while (true) {\n        particle = this.particleSystem.nextParticle()\n\n        if (!particle.ptr) {\n          break\n        } else if ((new Date().getTime() - start) > 50) {\n          // Yield execution to rendering logic\n          setTimeout(tick, 25)\n\n          break\n        } else {\n          this.updateParticle(particle)\n        }\n      }\n    }\n\n    setTimeout(tick, 25)\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  //\n  //\n  /// //////////////////////////////////////////////////////////////\n  updateParticleShadersOff (particle) {\n    if (!particle.mesh) {\n      var type = this.randomInt(0, this.nbParticleTypes)\n\n      particle.mesh = this.createMesh(\n        particle.getRadius(),\n        this.particleMaterials[type])\n\n      this.viewer.impl.scene.add(particle.mesh)\n    }\n\n    particle.mesh.visible = !particle.getRecycled()\n\n    if (this.filterParticle(particle)) {\n      particle.setLifeTime(-1)\n    } else if (particle.mesh.visible) {\n      var pos = particle.getPosition()\n\n      particle.mesh.position.x = pos.getX()\n      particle.mesh.position.y = pos.getY()\n      particle.mesh.position.z = pos.getZ()\n    }\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  //\n  //\n  /// //////////////////////////////////////////////////////////////\n  updateParticleShadersOn (particle) {\n    if (!particle.mesh) {\n      particle.shader = {\n        uniforms: {\n          offset: {\n            type: 'v3',\n            value: new THREE.Vector3(0, 0, 0)\n          },\n          color: {\n            type: 'v4',\n            value: new THREE.Vector4(\n              Math.random(),\n              Math.random(),\n              Math.random(), 1)\n          }\n        },\n        vertexShader,\n        fragmentShader\n      }\n\n      var shaderMaterial = new THREE.ShaderMaterial(\n        particle.shader)\n\n      particle.mesh = this.createMesh(\n        particle.getRadius(),\n        shaderMaterial)\n\n      this.viewer.impl.scene.add(particle.mesh)\n    }\n\n    particle.mesh.visible = !particle.getRecycled()\n\n    if (this.filterParticle(particle)) {\n      particle.setLifeTime(-1)\n    } else if (particle.mesh.visible) {\n      var pos = particle.getPosition()\n\n      var offset = particle.shader.uniforms.offset.value\n\n      offset.x = pos.getX()\n      offset.y = pos.getY()\n      offset.z = pos.getZ()\n    }\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  //\n  //\n  /// //////////////////////////////////////////////////////////////\n  activateShaders (activate) {\n    this.updateParticle = (activate\n      ? this.updateParticleShadersOn\n      : this.updateParticleShadersOff)\n\n    this.clearParticles()\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  //\n  //\n  /// //////////////////////////////////////////////////////////////\n  createMaterial (props) {\n    var material = new THREE.MeshPhongMaterial(props)\n\n    this.viewer.impl.matman().addMaterial(\n      props.name,\n      material,\n      true)\n\n    return material\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  //\n  //\n  /// //////////////////////////////////////////////////////////////\n  createMesh (size, material) {\n    var geometry = new THREE.SphereGeometry(\n      size, 4, 4)\n\n    var mesh = new THREE.Mesh(\n      geometry,\n      material)\n\n    return mesh\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  // Random int in [min, max[\n  //\n  /// //////////////////////////////////////////////////////////////\n  randomInt (min, max) {\n    return Math.floor(Math.random() * (max - min)) + min\n  }\n}\n","import EventsEmitter from 'EventsEmitter'\nimport './TransformGizmos'\n\nexport default class TransformTool extends EventsEmitter {\n  /// //////////////////////////////////////////////////////////////\n  // Class constructor\n  //\n  /// //////////////////////////////////////////////////////////////\n  constructor (viewer) {\n    super()\n\n    viewer.toolController.registerTool(this)\n\n    this.viewer = viewer\n\n    this._dbIds = []\n\n    this._hitPoint = null\n\n    this._selectSet = null\n\n    this._isDragging = false\n\n    this._transformMesh = null\n\n    this._modifiedFragIdMap = {}\n\n    this._transformControlTx = null\n\n    this._selectedFragProxyMap = {}\n\n    this.onTxChange =\n      this.onTxChange.bind(this)\n\n    this.onAggregateSelectionChanged =\n      this.onAggregateSelectionChanged.bind(this)\n\n    this.onCameraChanged =\n      this.onCameraChanged.bind(this)\n\n    this.handleSelectionChanged =\n      this.handleSelectionChanged.bind(this)\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  //\n  //\n  /// //////////////////////////////////////////////////////////////\n  getNames () {\n    return ['Viewing.Transform.Tool']\n  }\n\n  /// //////////////////////////////////////////////////////////////\n  //\n  //\n  /// //////////////////////////////////////////////////////////////\n  getName () {\n    return 'Viewing.Transform.Tool'\n  }\n\n  /// ////////////////////////////////////////////////////////////////////////\n  // Creates a dummy mesh to attach control to\n  //\n  /// ////////////////////////////////////////////////////////////////////////\n  createTransformMesh () {\n    var material = new THREE.MeshPhongMaterial(\n      { color: 0xff0000 })\n\n    this.viewer.impl.matman().addMaterial(\n      'transform-tool-material',\n      material,\n      true)\n\n    var sphere = new THREE.Mesh(\n      new THREE.SphereGeometry(0.0001, 5),\n      material)\n\n    sphere.position.set(0, 0, 0)\n\n    return sphere\n  }\n\n  /// ////////////////////////////////////////////////////////////////////////\n  // on translation change\n  //\n  /// ////////////////////////////////////////////////////////////////////////\n  onTxChange () {\n    for (var fragId in this._selectedFragProxyMap) {\n      var fragProxy = this._selectedFragProxyMap[fragId]\n\n      var position = new THREE.Vector3(\n        this._transformMesh.position.x - fragProxy.offset.x,\n        this._transformMesh.position.y - fragProxy.offset.y,\n        this._transformMesh.position.z - fragProxy.offset.z)\n\n      fragProxy.position = position\n\n      fragProxy.updateAnimTransform()\n    }\n\n    this.viewer.impl.sceneUpdated(true)\n\n    this.emit('transform.TxChange', {\n      dbIds: this._dbIds,\n      fragIds: Object.keys(this._selectedFragProxyMap)\n    })\n  }\n\n  /// ////////////////////////////////////////////////////////////////////////\n  // on camera changed\n  //\n  /// ////////////////////////////////////////////////////////////////////////\n  onCameraChanged () {\n    if (this._transformControlTx) {\n      this._transformControlTx.update()\n    }\n  }\n\n  /// ////////////////////////////////////////////////////////////////////////\n  // item selected callback\n  //\n  /// ////////////////////////////////////////////////////////////////////////\n  onAggregateSelectionChanged (event) {\n    var dbIdArray = []\n    var fragIdsArray = []\n\n    if (event.selections && event.selections.length) {\n      var selection = event.selections[0]\n\n      dbIdArray = selection.dbIdArray\n\n      fragIdsArray = selection.fragIdsArray\n    }\n\n    this.handleSelectionChanged(dbIdArray, fragIdsArray)\n  }\n\n  handleSelectionChanged (dbIdArray, fragIdsArray) {\n    this._selectedFragProxyMap = {}\n\n    this._dbIds = dbIdArray\n\n    // component unselected\n\n    if (!fragIdsArray.length) {\n      this._hitPoint = null\n\n      this._transformControlTx.visible = false\n\n      this._transformControlTx.removeEventListener(\n        'change', this.onTxChange)\n\n      this.viewer.removeEventListener(\n        Autodesk.Viewing.CAMERA_CHANGE_EVENT,\n        this.onCameraChanged)\n\n      this.emit('transform.select', {\n        dbIds: this._dbIds\n      })\n\n      return\n    }\n\n    if (this._hitPoint) {\n      this._selectSet = this.emit('transform.select', {\n        dbIds: this._dbIds\n      })\n\n      if (this._selectSet) {\n        if (!this._selectSet.selectable) {\n          this._hitPoint = null\n          this.viewer.select([])\n          return\n        }\n\n        if (!this._selectSet.transformable) {\n          this._hitPoint = null\n          return\n        }\n      }\n\n      this._transformControlTx.visible = true\n\n      this._transformControlTx.setPosition(\n        this._hitPoint)\n\n      this._transformControlTx.addEventListener(\n        'change', this.onTxChange)\n\n      this.viewer.addEventListener(\n        Autodesk.Viewing.CAMERA_CHANGE_EVENT,\n        this.onCameraChanged)\n\n      fragIdsArray.forEach((fragId) => {\n        var fragProxy = this.viewer.impl.getFragmentProxy(\n          this.viewer.model,\n          fragId)\n\n        fragProxy.getAnimTransform()\n\n        var offset = {\n\n          x: this._hitPoint.x - fragProxy.position.x,\n          y: this._hitPoint.y - fragProxy.position.y,\n          z: this._hitPoint.z - fragProxy.position.z\n        }\n\n        fragProxy.offset = offset\n\n        this._selectedFragProxyMap[fragId] = fragProxy\n\n        this._modifiedFragIdMap[fragId] = {}\n      })\n\n      this._hitPoint = null\n    }\n  }\n\n  /// ////////////////////////////////////////////////////////////////////////\n  // normalize screen coordinates\n  //\n  /// ////////////////////////////////////////////////////////////////////////\n  normalize (screenPoint) {\n    var viewport = this.viewer.navigation.getScreenViewport()\n\n    var n = {\n      x: (screenPoint.x - viewport.left) / viewport.width,\n      y: (screenPoint.y - viewport.top) / viewport.height\n    }\n\n    return n\n  }\n\n  /// ////////////////////////////////////////////////////////////////////////\n  // get 3d hit point on mesh\n  //\n  /// ////////////////////////////////////////////////////////////////////////\n  getHitPoint (event) {\n    var screenPoint = {\n      x: event.clientX,\n      y: event.clientY\n    }\n\n    var n = this.normalize(screenPoint)\n\n    var hitPoint = this.viewer.utilities.getHitPoint(n.x, n.y)\n\n    return hitPoint\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  //\n  //\n  /// ////////////////////////////////////////////////////////////////\n  activate () {\n    if (!this.active) {\n      console.log(this.getName() + ' activated')\n\n      this.active = true\n\n      this.viewer.select([])\n\n      var bbox = this.viewer.model.getBoundingBox()\n\n      this.viewer.impl.createOverlayScene(\n        'TransformToolOverlay')\n\n      this._transformControlTx = new THREE.TransformControls(\n        this.viewer.impl.camera,\n        this.viewer.impl.canvas,\n        'translate')\n\n      this._transformControlTx.setSize(\n        bbox.getBoundingSphere().radius * 5)\n\n      this._transformControlTx.visible = false\n\n      this.viewer.impl.addOverlay(\n        'TransformToolOverlay',\n        this._transformControlTx)\n\n      this._transformMesh = this.createTransformMesh()\n\n      this._transformControlTx.attach(\n        this._transformMesh)\n\n      this.viewer.addEventListener(\n        Autodesk.Viewing.AGGREGATE_SELECTION_CHANGED_EVENT,\n        this.onAggregateSelectionChanged)\n\n      this.viewer.toolController.activateTool(\n        this.getName())\n\n      this.emit('activate')\n    }\n  }\n\n  /// ////////////////////////////////////////////////////////////////////////\n  // deactivate tool\n  //\n  /// ////////////////////////////////////////////////////////////////////////\n  deactivate () {\n    if (this.active) {\n      this.active = false\n\n      this.viewer.toolController.deactivateTool(\n        this.getName())\n\n      this.viewer.impl.removeOverlay(\n        'TransformToolOverlay',\n        this._transformControlTx)\n\n      this._transformControlTx.removeEventListener(\n        'change',\n        this.onTxChange)\n\n      this._transformControlTx = null\n\n      this.viewer.impl.removeOverlayScene(\n        'TransformToolOverlay')\n\n      this.viewer.removeEventListener(\n        Autodesk.Viewing.CAMERA_CHANGE_EVENT,\n        this.onCameraChanged)\n\n      this.viewer.removeEventListener(\n        Autodesk.Viewing.AGGREGATE_SELECTION_CHANGED_EVENT,\n        this.onAggregateSelectionChanged)\n\n      this.emit('deactivate')\n    }\n  }\n\n  /// ////////////////////////////////////////////////////////////////////////\n  //\n  //\n  /// ////////////////////////////////////////////////////////////////////////\n  handleButtonDown (event, button) {\n    this._hitPoint = this.getHitPoint(event)\n\n    this._isDragging = true\n\n    if (this._transformControlTx.onPointerDown(event)) { return true }\n\n    // return _transRotControl.onPointerDown(event)\n    return false\n  }\n\n  /// ////////////////////////////////////////////////////////////////////////\n  //\n  //\n  /// ////////////////////////////////////////////////////////////////////////\n  handleButtonUp (event, button) {\n    this._isDragging = false\n\n    if (this._transformControlTx.onPointerUp(event)) { return true }\n\n    // return _transRotControl.onPointerUp(event)\n    return false\n  }\n\n  /// ////////////////////////////////////////////////////////////////////////\n  //\n  //\n  /// ////////////////////////////////////////////////////////////////////////\n  handleMouseMove (event) {\n    if (this._isDragging) {\n      if (this._transformControlTx.onPointerMove(event)) {\n        return true\n      }\n\n      return false\n    }\n\n    if (this._transformControlTx.onPointerHover(event)) { return true }\n\n    // return _transRotControl.onPointerHover(event)\n    return false\n  }\n}\n","(function init_TransformGizmos () {\n  'use strict'\n\n  var GizmoMaterial = function (parameters) {\n    THREE.MeshBasicMaterial.call(this)\n\n    this.depthTest = false\n    this.depthWrite = false\n    this.side = THREE.FrontSide\n    this.transparent = true\n\n    this.setValues(parameters)\n\n    this.oldColor = this.color.clone()\n    this.oldOpacity = this.opacity\n\n    this.highlight = function (highlighted) {\n      if (highlighted) {\n        this.color.setRGB(1, 230 / 255, 3 / 255)\n        this.opacity = 1\n      } else {\n        this.color.copy(this.oldColor)\n        this.opacity = this.oldOpacity\n      }\n    }\n  }\n\n  GizmoMaterial.prototype = Object.create(THREE.MeshBasicMaterial.prototype)\n\n  var GizmoLineMaterial = function (parameters) {\n    THREE.LineBasicMaterial.call(this)\n\n    this.depthTest = false\n    this.depthWrite = false\n    this.transparent = true\n    this.linewidth = 3\n\n    this.setValues(parameters)\n\n    this.oldColor = this.color.clone()\n    this.oldOpacity = this.opacity\n\n    this.highlight = function (highlighted) {\n      if (highlighted) {\n        this.color.setRGB(1, 230 / 255, 3 / 255)\n        this.opacity = 1\n      } else {\n        this.color.copy(this.oldColor)\n        this.opacity = this.oldOpacity\n      }\n    }\n  }\n\n  GizmoLineMaterial.prototype = Object.create(THREE.LineBasicMaterial.prototype)\n\n  // polyfill\n  if (THREE.PolyhedronGeometry === undefined) {\n    THREE.PolyhedronGeometry = function (vertices, indices, radius, detail) {\n      THREE.Geometry.call(this)\n\n      this.type = 'PolyhedronGeometry'\n\n      this.parameters = {\n        vertices: vertices,\n        indices: indices,\n        radius: radius,\n        detail: detail\n      }\n\n      radius = radius || 1\n      detail = detail || 0\n\n      var that = this\n\n      for (var i = 0, l = vertices.length; i < l; i += 3) {\n        prepare(new THREE.Vector3(vertices[i], vertices[i + 1], vertices[i + 2]))\n      }\n\n      var midpoints = []; var p = this.vertices\n\n      var faces = []\n\n      for (var i = 0, j = 0, l = indices.length; i < l; i += 3, j++) {\n        var v1 = p[indices[i]]\n        var v2 = p[indices[i + 1]]\n        var v3 = p[indices[i + 2]]\n\n        faces[j] = new THREE.Face3(v1.index, v2.index, v3.index, [v1.clone(), v2.clone(), v3.clone()])\n      }\n\n      var centroid = new THREE.Vector3()\n\n      for (var i = 0, l = faces.length; i < l; i++) {\n        subdivide(faces[i], detail)\n      }\n\n      // Handle case when face straddles the seam\n\n      for (var i = 0, l = this.faceVertexUvs[0].length; i < l; i++) {\n        var uvs = this.faceVertexUvs[0][i]\n\n        var x0 = uvs[0].x\n        var x1 = uvs[1].x\n        var x2 = uvs[2].x\n\n        var max = Math.max(x0, Math.max(x1, x2))\n        var min = Math.min(x0, Math.min(x1, x2))\n\n        if (max > 0.9 && min < 0.1) { // 0.9 is somewhat arbitrary\n          if (x0 < 0.2) uvs[0].x += 1\n          if (x1 < 0.2) uvs[1].x += 1\n          if (x2 < 0.2) uvs[2].x += 1\n        }\n      }\n\n      // Apply radius\n\n      for (var i = 0, l = this.vertices.length; i < l; i++) {\n        this.vertices[i].multiplyScalar(radius)\n      }\n\n      // Merge vertices\n\n      this.mergeVertices()\n\n      this.computeFaceNormals()\n\n      this.boundingSphere = new THREE.Sphere(new THREE.Vector3(), radius)\n\n      // Project vector onto sphere's surface\n\n      function prepare (vector) {\n        var vertex = vector.normalize().clone()\n        vertex.index = that.vertices.push(vertex) - 1\n\n        // Texture coords are equivalent to map coords, calculate angle and convert to fraction of a circle.\n\n        var u = azimuth(vector) / 2 / Math.PI + 0.5\n        var v = inclination(vector) / Math.PI + 0.5\n        vertex.uv = new THREE.Vector2(u, 1 - v)\n\n        return vertex\n      }\n\n      // Approximate a curved face with recursively sub-divided triangles.\n\n      function make (v1, v2, v3) {\n        var face = new THREE.Face3(v1.index, v2.index, v3.index, [v1.clone(), v2.clone(), v3.clone()])\n        that.faces.push(face)\n\n        centroid.copy(v1).add(v2).add(v3).divideScalar(3)\n\n        var azi = azimuth(centroid)\n\n        that.faceVertexUvs[0].push([\n          correctUV(v1.uv, v1, azi),\n          correctUV(v2.uv, v2, azi),\n          correctUV(v3.uv, v3, azi)\n        ])\n      }\n\n      // Analytically subdivide a face to the required detail level.\n\n      function subdivide (face, detail) {\n        var cols = Math.pow(2, detail)\n        var cells = Math.pow(4, detail)\n        var a = prepare(that.vertices[face.a])\n        var b = prepare(that.vertices[face.b])\n        var c = prepare(that.vertices[face.c])\n        var v = []\n\n        // Construct all of the vertices for this subdivision.\n\n        for (var i = 0; i <= cols; i++) {\n          v[i] = []\n\n          var aj = prepare(a.clone().lerp(c, i / cols))\n          var bj = prepare(b.clone().lerp(c, i / cols))\n          var rows = cols - i\n\n          for (var j = 0; j <= rows; j++) {\n            if (j == 0 && i == cols) {\n              v[i][j] = aj\n            } else {\n              v[i][j] = prepare(aj.clone().lerp(bj, j / rows))\n            }\n          }\n        }\n\n        // Construct all of the faces.\n\n        for (var i = 0; i < cols; i++) {\n          for (var j = 0; j < 2 * (cols - i) - 1; j++) {\n            var k = Math.floor(j / 2)\n\n            if (j % 2 == 0) {\n              make(\n                v[i][k + 1],\n                v[i + 1][k],\n                v[i][k]\n              )\n            } else {\n              make(\n                v[i][k + 1],\n                v[i + 1][k + 1],\n                v[i + 1][k]\n              )\n            }\n          }\n        }\n      }\n\n      // Angle around the Y axis, counter-clockwise when looking from above.\n\n      function azimuth (vector) {\n        return Math.atan2(vector.z, -vector.x)\n      }\n\n      // Angle above the XZ plane.\n\n      function inclination (vector) {\n        return Math.atan2(-vector.y, Math.sqrt((vector.x * vector.x) + (vector.z * vector.z)))\n      }\n\n      // Texture fixing helper. Spheres have some odd behaviours.\n\n      function correctUV (uv, vector, azimuth) {\n        if ((azimuth < 0) && (uv.x === 1)) uv = new THREE.Vector2(uv.x - 1, uv.y)\n        if ((vector.x === 0) && (vector.z === 0)) uv = new THREE.Vector2(azimuth / 2 / Math.PI + 0.5, uv.y)\n        return uv.clone()\n      }\n    }\n\n    THREE.PolyhedronGeometry.prototype = Object.create(THREE.Geometry.prototype)\n  }\n\n  // polyfill\n  if (THREE.OctahedronGeometry === undefined) {\n    THREE.OctahedronGeometry = function (radius, detail) {\n      this.parameters = {\n        radius: radius,\n        detail: detail\n      }\n\n      var vertices = [\n        1, 0, 0, -1, 0, 0, 0, 1, 0, 0, -1, 0, 0, 0, 1, 0, 0, -1\n      ]\n\n      var indices = [\n        0, 2, 4, 0, 4, 3, 0, 3, 5, 0, 5, 2, 1, 2, 5, 1, 5, 3, 1, 3, 4, 1, 4, 2\n      ]\n\n      THREE.PolyhedronGeometry.call(this, vertices, indices, radius, detail)\n\n      this.type = 'OctahedronGeometry'\n\n      this.parameters = {\n        radius: radius,\n        detail: detail\n      }\n    }\n\n    THREE.OctahedronGeometry.prototype = Object.create(THREE.Geometry.prototype)\n  }\n\n  // polyfill\n  if (THREE.TorusGeometry === undefined) {\n    THREE.TorusGeometry = function (radius, tube, radialSegments, tubularSegments, arc) {\n      THREE.Geometry.call(this)\n\n      this.type = 'TorusGeometry'\n\n      this.parameters = {\n        radius: radius,\n        tube: tube,\n        radialSegments: radialSegments,\n        tubularSegments: tubularSegments,\n        arc: arc\n      }\n\n      radius = radius || 100\n      tube = tube || 40\n      radialSegments = radialSegments || 8\n      tubularSegments = tubularSegments || 6\n      arc = arc || Math.PI * 2\n\n      var center = new THREE.Vector3(); var uvs = []; var normals = []\n\n      for (var j = 0; j <= radialSegments; j++) {\n        for (var i = 0; i <= tubularSegments; i++) {\n          var u = i / tubularSegments * arc\n          var v = j / radialSegments * Math.PI * 2\n\n          center.x = radius * Math.cos(u)\n          center.y = radius * Math.sin(u)\n\n          var vertex = new THREE.Vector3()\n          vertex.x = (radius + tube * Math.cos(v)) * Math.cos(u)\n          vertex.y = (radius + tube * Math.cos(v)) * Math.sin(u)\n          vertex.z = tube * Math.sin(v)\n\n          this.vertices.push(vertex)\n\n          uvs.push(new THREE.Vector2(i / tubularSegments, j / radialSegments))\n          normals.push(vertex.clone().sub(center).normalize())\n        }\n      }\n\n      for (var j = 1; j <= radialSegments; j++) {\n        for (var i = 1; i <= tubularSegments; i++) {\n          var a = (tubularSegments + 1) * j + i - 1\n          var b = (tubularSegments + 1) * (j - 1) + i - 1\n          var c = (tubularSegments + 1) * (j - 1) + i\n          var d = (tubularSegments + 1) * j + i\n\n          var face = new THREE.Face3(a, b, d, [normals[a].clone(), normals[b].clone(), normals[d].clone()])\n          this.faces.push(face)\n          this.faceVertexUvs[0].push([uvs[a].clone(), uvs[b].clone(), uvs[d].clone()])\n\n          face = new THREE.Face3(b, c, d, [normals[b].clone(), normals[c].clone(), normals[d].clone()])\n          this.faces.push(face)\n          this.faceVertexUvs[0].push([uvs[b].clone(), uvs[c].clone(), uvs[d].clone()])\n        }\n      }\n\n      this.computeFaceNormals()\n    }\n\n    THREE.TorusGeometry.prototype = Object.create(THREE.Geometry.prototype)\n  }\n\n  var createCircleGeometry = function (radius, facing, arc) {\n    var geometry = new THREE.Geometry()\n    arc = arc || 1\n    for (var i = 0; i <= 64 * arc; ++i) {\n      if (facing == 'x') geometry.vertices.push(new THREE.Vector3(0, Math.cos(i / 32 * Math.PI), Math.sin(i / 32 * Math.PI)).multiplyScalar(radius))\n      if (facing == 'y') geometry.vertices.push(new THREE.Vector3(Math.cos(i / 32 * Math.PI), 0, Math.sin(i / 32 * Math.PI)).multiplyScalar(radius))\n      if (facing == 'z') geometry.vertices.push(new THREE.Vector3(Math.sin(i / 32 * Math.PI), Math.cos(i / 32 * Math.PI), 0).multiplyScalar(radius))\n    }\n\n    return geometry\n  }\n\n  var createArrowGeometry = function (radiusTop, radiusBottom, height, radialSegments, heightSegments, openEnded) {\n    var arrowGeometry = new THREE.Geometry()\n    var mesh = new THREE.Mesh(new THREE.CylinderGeometry(radiusTop, radiusBottom, height, radialSegments, heightSegments, openEnded))\n    mesh.position.y = 0.5\n    mesh.updateMatrix()\n\n    arrowGeometry.merge(mesh.geometry, mesh.matrix)\n\n    return arrowGeometry\n  }\n\n  var createLineGeometry = function (axis) {\n    var lineGeometry = new THREE.Geometry()\n    if (axis === 'X') { lineGeometry.vertices.push(new THREE.Vector3(0, 0, 0), new THREE.Vector3(1, 0, 0)) } else if (axis === 'Y') { lineGeometry.vertices.push(new THREE.Vector3(0, 0, 0), new THREE.Vector3(0, 1, 0)) } else if (axis === 'Z') { lineGeometry.vertices.push(new THREE.Vector3(0, 0, 0), new THREE.Vector3(0, 0, 1)) }\n\n    return lineGeometry\n  }\n\n  THREE.TransformGizmo = function () {\n    var scope = this\n    var showPickers = false // debug\n    var showActivePlane = false // debug\n\n    this.init = function () {\n      THREE.Object3D.call(this)\n\n      this.handles = new THREE.Object3D()\n      this.pickers = new THREE.Object3D()\n      this.planes = new THREE.Object3D()\n      this.highlights = new THREE.Object3D()\n      this.hemiPicker = new THREE.Object3D()\n      this.subPickers = new THREE.Object3D()\n\n      this.add(this.handles)\n      this.add(this.pickers)\n      this.add(this.planes)\n      this.add(this.highlights)\n      this.add(this.hemiPicker)\n      this.add(this.subPickers)\n\n      /// / PLANES\n\n      var planeGeometry = new THREE.PlaneBufferGeometry(50, 50, 2, 2)\n      var planeMaterial = new THREE.MeshBasicMaterial({ wireframe: true })\n      planeMaterial.side = THREE.DoubleSide\n\n      var planes = {\n        XY: new THREE.Mesh(planeGeometry, planeMaterial),\n        YZ: new THREE.Mesh(planeGeometry, planeMaterial),\n        XZ: new THREE.Mesh(planeGeometry, planeMaterial),\n        XYZE: new THREE.Mesh(planeGeometry, planeMaterial)\n      }\n\n      this.activePlane = planes.XYZE\n\n      planes.YZ.rotation.set(0, Math.PI / 2, 0)\n      planes.XZ.rotation.set(-Math.PI / 2, 0, 0)\n\n      for (var i in planes) {\n        planes[i].name = i\n        this.planes.add(planes[i])\n        this.planes[i] = planes[i]\n        planes[i].visible = false\n      }\n\n      this.setupGizmos()\n      this.activeMode = ''\n\n      // reset Transformations\n\n      this.traverse(function (child) {\n        if (child instanceof THREE.Mesh) {\n          child.updateMatrix()\n\n          var tempGeometry = new THREE.Geometry()\n          if (child.geometry instanceof THREE.BufferGeometry) {\n            child.geometry = new THREE.Geometry().fromBufferGeometry(child.geometry)\n          }\n          tempGeometry.merge(child.geometry, child.matrix)\n\n          child.geometry = tempGeometry\n          child.position.set(0, 0, 0)\n          child.rotation.set(0, 0, 0)\n          child.scale.set(1, 1, 1)\n        }\n      })\n    }\n\n    this.hide = function () {\n      this.traverse(function (child) {\n        child.visible = false\n      })\n    }\n\n    this.show = function () {\n      this.traverse(function (child) {\n        child.visible = true\n        if (child.parent == scope.pickers || child.parent == scope.hemiPicker) child.visible = showPickers\n        if (child.parent == scope.planes) child.visible = false\n      })\n      this.activePlane.visible = showActivePlane\n    }\n\n    this.highlight = function (axis) {\n      this.traverse(function (child) {\n        if (child.material && child.material.highlight) {\n          if (child.name == axis) {\n            child.material.highlight(true)\n          } else {\n            child.material.highlight(false)\n          }\n        }\n      })\n    }\n\n    this.setupGizmos = function () {\n      var addGizmos = function (gizmoMap, parent) {\n        for (var name in gizmoMap) {\n          for (var i = gizmoMap[name].length; i--;) {\n            var object = gizmoMap[name][i][0]\n            var position = gizmoMap[name][i][1]\n            var rotation = gizmoMap[name][i][2]\n            var visble = gizmoMap[name][i][3]\n\n            object.name = name\n\n            if (position) object.position.set(position[0], position[1], position[2])\n            if (rotation) object.rotation.set(rotation[0], rotation[1], rotation[2])\n            if (visble) object.visble = visble\n\n            parent.add(object)\n          }\n        }\n      }\n\n      this.setHandlePickerGizmos()\n\n      addGizmos(this.handleGizmos, this.handles)\n      addGizmos(this.pickerGizmos, this.pickers)\n      addGizmos(this.highlightGizmos, this.highlights)\n      addGizmos(this.hemiPickerGizmos, this.hemiPicker)\n      addGizmos(this.subPickerGizmos, this.subPickers)\n\n      this.hide()\n      this.show()\n    }\n  }\n\n  THREE.TransformGizmo.prototype = Object.create(THREE.Object3D.prototype)\n\n  THREE.TransformGizmo.prototype.update = function (rotation, eye) {\n    var vec1 = new THREE.Vector3(0, 0, 0)\n    var vec2 = new THREE.Vector3(0, 1, 0)\n    var lookAtMatrix = new THREE.Matrix4()\n\n    this.traverse(function (child) {\n      if (child.name) {\n        if (child.name.search('E') != -1) {\n          child.quaternion.setFromRotationMatrix(lookAtMatrix.lookAt(eye, vec1, vec2))\n        } else if (child.name.search('X') != -1 || child.name.search('Y') != -1 || child.name.search('Z') != -1) {\n          child.quaternion.setFromEuler(rotation)\n        }\n      }\n    })\n  }\n\n  THREE.TransformGizmoTranslate = function () {\n    THREE.TransformGizmo.call(this)\n\n    this.setHandlePickerGizmos = function () {\n      var arrowGeometry = createArrowGeometry(0, 0.05, 0.2, 12, 1, false)\n      var lineXGeometry = createLineGeometry('X')\n      var lineYGeometry = createLineGeometry('Y')\n      var lineZGeometry = createLineGeometry('Z')\n\n      this.handleGizmos = {\n        X: [\n          [new THREE.Mesh(arrowGeometry, new GizmoMaterial({ color: 0xf12c2c })), [0.5, 0, 0], [0, 0, -Math.PI / 2]],\n          [new THREE.Line(lineXGeometry, new GizmoLineMaterial({ color: 0xf12c2c }))]\n        ],\n        Y: [\n          [new THREE.Mesh(arrowGeometry, new GizmoMaterial({ color: 0x0bb80b })), [0, 0.5, 0]],\n          [new THREE.Line(lineYGeometry, new GizmoLineMaterial({ color: 0x0bb80b }))]\n        ],\n        Z: [\n          [new THREE.Mesh(arrowGeometry, new GizmoMaterial({ color: 0x2c2cf1 })), [0, 0, 0.5], [Math.PI / 2, 0, 0]],\n          [new THREE.Line(lineZGeometry, new GizmoLineMaterial({ color: 0x2c2cf1 }))]\n        ],\n        XYZ: [\n          [new THREE.Mesh(new THREE.OctahedronGeometry(0.1, 0), new GizmoMaterial({ color: 0xffffff, opacity: 0.25 })), [0, 0, 0], [0, 0, 0]]\n        ],\n        XY: [\n          [new THREE.Mesh(new THREE.PlaneBufferGeometry(0.29, 0.29), new GizmoMaterial({ color: 0xffff00, opacity: 0.25 })), [0.15, 0.15, 0]]\n        ],\n        YZ: [\n          [new THREE.Mesh(new THREE.PlaneBufferGeometry(0.29, 0.29), new GizmoMaterial({ color: 0x00ffff, opacity: 0.25 })), [0, 0.15, 0.15], [0, Math.PI / 2, 0]]\n        ],\n        XZ: [\n          [new THREE.Mesh(new THREE.PlaneBufferGeometry(0.29, 0.29), new GizmoMaterial({ color: 0xff00ff, opacity: 0.25 })), [0.15, 0, 0.15], [-Math.PI / 2, 0, 0]]\n        ]\n      }\n\n      this.pickerGizmos = {\n        X: [\n          [new THREE.Mesh(new THREE.CylinderGeometry(0.2, 0, 1, 4, 1, false), new GizmoMaterial({ color: 0xff0000, opacity: 0.25 })), [0.6, 0, 0], [0, 0, -Math.PI / 2]]\n        ],\n        Y: [\n          [new THREE.Mesh(new THREE.CylinderGeometry(0.2, 0, 1, 4, 1, false), new GizmoMaterial({ color: 0x00ff00, opacity: 0.25 })), [0, 0.6, 0]]\n        ],\n        Z: [\n          [new THREE.Mesh(new THREE.CylinderGeometry(0.2, 0, 1, 4, 1, false), new GizmoMaterial({ color: 0x0000ff, opacity: 0.25 })), [0, 0, 0.6], [Math.PI / 2, 0, 0]]\n        ],\n        XYZ: [\n          [new THREE.Mesh(new THREE.OctahedronGeometry(0.2, 0), new GizmoMaterial({ color: 0xffffff, opacity: 0.25 }))]\n        ],\n        XY: [\n          [new THREE.Mesh(new THREE.PlaneBufferGeometry(0.4, 0.4), new GizmoMaterial({ color: 0xffff00, opacity: 0.25 })), [0.2, 0.2, 0]]\n        ],\n        YZ: [\n          [new THREE.Mesh(new THREE.PlaneBufferGeometry(0.4, 0.4), new GizmoMaterial({ color: 0x00ffff, opacity: 0.25 })), [0, 0.2, 0.2], [0, Math.PI / 2, 0]]\n        ],\n        XZ: [\n          [new THREE.Mesh(new THREE.PlaneBufferGeometry(0.4, 0.4), new GizmoMaterial({ color: 0xff00ff, opacity: 0.25 })), [0.2, 0, 0.2], [-Math.PI / 2, 0, 0]]\n        ]\n      }\n\n      this.hemiPickerGizmos = {\n        XYZ: [\n          [new THREE.Mesh(new THREE.BoxGeometry(1.2, 1.2, 1.2), new GizmoMaterial({ color: 0x0000ff })), [0.5, 0.5, 0.5], null, false]\n        ]\n      }\n    }\n\n    this.setActivePlane = function (axis, eye) {\n      var tempMatrix = new THREE.Matrix4()\n      eye.applyMatrix4(tempMatrix.getInverse(tempMatrix.extractRotation(this.planes.XY.matrixWorld)))\n\n      if (axis == 'X') {\n        this.activePlane = this.planes.XY\n        if (Math.abs(eye.y) > Math.abs(eye.z)) this.activePlane = this.planes.XZ\n      }\n\n      if (axis == 'Y') {\n        this.activePlane = this.planes.XY\n        if (Math.abs(eye.x) > Math.abs(eye.z)) this.activePlane = this.planes.YZ\n      }\n\n      if (axis == 'Z') {\n        this.activePlane = this.planes.XZ\n        if (Math.abs(eye.x) > Math.abs(eye.y)) this.activePlane = this.planes.YZ\n      }\n\n      if (axis == 'XYZ') this.activePlane = this.planes.XYZE\n\n      if (axis == 'XY') this.activePlane = this.planes.XY\n\n      if (axis == 'YZ') this.activePlane = this.planes.YZ\n\n      if (axis == 'XZ') this.activePlane = this.planes.XZ\n\n      this.hide()\n      this.show()\n    }\n\n    this.init()\n  }\n\n  THREE.TransformGizmoTranslate.prototype = Object.create(THREE.TransformGizmo.prototype)\n\n  THREE.TransformGizmoRotate = function () {\n    THREE.TransformGizmo.call(this)\n\n    this.setHandlePickerGizmos = function () {\n      this.handleGizmos = {\n        RX: [\n          [new THREE.Line(createCircleGeometry(1, 'x', 0.5), new GizmoLineMaterial({ color: 0xff0000 }))]\n        ],\n        RY: [\n          [new THREE.Line(createCircleGeometry(1, 'y', 0.5), new GizmoLineMaterial({ color: 0x00ff00 }))]\n        ],\n        RZ: [\n          [new THREE.Line(createCircleGeometry(1, 'z', 0.5), new GizmoLineMaterial({ color: 0x0000ff }))]\n        ],\n        RE: [\n          [new THREE.Line(createCircleGeometry(1.25, 'z', 1), new GizmoLineMaterial({ color: 0x00ffff }))]\n        ],\n        RXYZE: [\n          [new THREE.Line(createCircleGeometry(1, 'z', 1), new GizmoLineMaterial({ color: 0xff00ff }))]\n        ]\n      }\n\n      this.pickerGizmos = {\n        RX: [\n          [new THREE.Mesh(new THREE.TorusGeometry(1, 0.12, 4, 12, Math.PI), new GizmoMaterial({ color: 0xff0000, opacity: 0.25 })), [0, 0, 0], [0, -Math.PI / 2, -Math.PI / 2]]\n        ],\n        RY: [\n          [new THREE.Mesh(new THREE.TorusGeometry(1, 0.12, 4, 12, Math.PI), new GizmoMaterial({ color: 0x00ff00, opacity: 0.25 })), [0, 0, 0], [Math.PI / 2, 0, 0]]\n        ],\n        RZ: [\n          [new THREE.Mesh(new THREE.TorusGeometry(1, 0.12, 4, 12, Math.PI), new GizmoMaterial({ color: 0x0000ff, opacity: 0.25 })), [0, 0, 0], [0, 0, -Math.PI / 2]]\n        ],\n        RE: [\n          [new THREE.Mesh(new THREE.TorusGeometry(1.25, 0.12, 2, 24), new GizmoMaterial({ color: 0x00ffff, opacity: 0.25 }))]\n        ],\n        RXYZE: [\n          [new THREE.Mesh(new THREE.TorusGeometry(1, 0.12, 2, 24), new GizmoMaterial({ color: 0xff00ff, opacity: 0.25 }))]\n        ]\n      }\n    }\n\n    this.setActivePlane = function (axis) {\n      if (axis == 'RE') this.activePlane = this.planes.XYZE\n\n      if (axis == 'RX') this.activePlane = this.planes.YZ\n\n      if (axis == 'RY') this.activePlane = this.planes.XZ\n\n      if (axis == 'RZ') this.activePlane = this.planes.XY\n\n      this.hide()\n      this.show()\n    }\n\n    this.update = function (rotation, eye2) {\n      THREE.TransformGizmo.prototype.update.apply(this, arguments)\n\n      var tempMatrix = new THREE.Matrix4()\n      var worldRotation = new THREE.Euler(0, 0, 1)\n      var tempQuaternion = new THREE.Quaternion()\n      var unitX = new THREE.Vector3(1, 0, 0)\n      var unitY = new THREE.Vector3(0, 1, 0)\n      var unitZ = new THREE.Vector3(0, 0, 1)\n      var quaternionX = new THREE.Quaternion()\n      var quaternionY = new THREE.Quaternion()\n      var quaternionZ = new THREE.Quaternion()\n      var eye = eye2.clone()\n\n      worldRotation.copy(this.planes.XY.rotation)\n      tempQuaternion.setFromEuler(worldRotation)\n\n      tempMatrix.makeRotationFromQuaternion(tempQuaternion).getInverse(tempMatrix)\n      eye.applyMatrix4(tempMatrix)\n\n      this.traverse(function (child) {\n        tempQuaternion.setFromEuler(worldRotation)\n\n        if (child.name == 'RX') {\n          quaternionX.setFromAxisAngle(unitX, Math.atan2(-eye.y, eye.z))\n          tempQuaternion.multiplyQuaternions(tempQuaternion, quaternionX)\n          child.quaternion.copy(tempQuaternion)\n        }\n\n        if (child.name == 'RY') {\n          quaternionY.setFromAxisAngle(unitY, Math.atan2(eye.x, eye.z))\n          tempQuaternion.multiplyQuaternions(tempQuaternion, quaternionY)\n          child.quaternion.copy(tempQuaternion)\n        }\n\n        if (child.name == 'RZ') {\n          quaternionZ.setFromAxisAngle(unitZ, Math.atan2(eye.y, eye.x))\n          tempQuaternion.multiplyQuaternions(tempQuaternion, quaternionZ)\n          child.quaternion.copy(tempQuaternion)\n        }\n      })\n    }\n\n    this.init()\n  }\n\n  THREE.TransformGizmoRotate.prototype = Object.create(THREE.TransformGizmo.prototype)\n\n  THREE.TransformGizmoTranslateRotate = function () {\n    THREE.TransformGizmo.call(this)\n\n    var scope = this\n\n    this.setHandlePickerGizmos = function () {\n      var arrowGeometry = createArrowGeometry(0, 0.05, 0.2, 12, 1, false)\n      var lineGeometry = new THREE.Geometry()\n      lineGeometry.vertices.push(new THREE.Vector3(0, 0, -0.1), new THREE.Vector3(0, 0, 0.1), new THREE.Vector3(-0.1, 0, 0), new THREE.Vector3(0.1, 0, 0))\n      var theta = 0.15\n\n      this.handleGizmos = {\n        Z: [\n          [new THREE.Mesh(arrowGeometry, new GizmoMaterial({ color: 0xffffff })), [0, 0, 0.25], [Math.PI / 2, 0, 0]],\n          [new THREE.Mesh(new THREE.CylinderGeometry(0.015, 0.015, 0.6, 4, 1, false), new GizmoMaterial({ color: 0xffffff })), [0, 0, 0.5], [Math.PI / 2, 0, 0]]\n        ],\n        RX: [\n          [new THREE.Mesh(new THREE.TorusGeometry(1, 0.015, 12, 60, theta * 2 * Math.PI), new GizmoMaterial({ color: 0xff0000 })), [0, 0, 0], [theta * Math.PI, -Math.PI / 2, 0]],\n          [new THREE.Mesh(new THREE.CylinderGeometry(0.05, 0.05, 0.015, 60, 1, false), new GizmoMaterial({ color: 0xff0000 })), [0, 0, 1], [Math.PI / 2, 0, 0]]\n        ],\n        RY: [\n          [new THREE.Mesh(new THREE.TorusGeometry(1, 0.015, 12, 60, theta * 2 * Math.PI), new GizmoMaterial({ color: 0x0000ff })), [0, 0, 0], [Math.PI / 2, 0, (0.5 - theta) * Math.PI]],\n          [new THREE.Mesh(new THREE.CylinderGeometry(0.05, 0.05, 0.01, 60, 1, false), new GizmoMaterial({ color: 0x0000ff })), [0, 0, 1]]\n        ]\n      }\n\n      this.pickerGizmos = {\n        Z: [\n          [new THREE.Mesh(new THREE.CylinderGeometry(0.12, 0.12, 0.65, 4, 1, false), new GizmoMaterial({ color: 0x0000ff, opacity: 0.25 })), [0, 0, 0.5], [Math.PI / 2, 0, 0]]\n        ],\n        RX: [\n          [new THREE.Mesh(new THREE.TorusGeometry(1, 0.12, 4, 12, theta * 2 * Math.PI), new GizmoMaterial({ color: 0xff0000, opacity: 0.25 })), [0, 0, 0], [theta * Math.PI, -Math.PI / 2, 0]]\n        ],\n        RY: [\n          [new THREE.Mesh(new THREE.TorusGeometry(1, 0.12, 4, 12, theta * 2 * Math.PI), new GizmoMaterial({ color: 0x0000ff, opacity: 0.25 })), [0, 0, 0], [Math.PI / 2, 0, (0.5 - theta) * Math.PI]]\n        ]\n      }\n\n      this.subPickerGizmos = {\n        Z: [\n          [new THREE.Mesh(new THREE.CylinderGeometry(0.12, 0.12, 0.65, 4, 1, false), new GizmoMaterial({ color: 0x0000ff, opacity: 0.25 })), [0, 0, 0.5], [Math.PI / 2, 0, 0]]\n        ]\n      }\n\n      this.highlightGizmos = {\n        Z: [\n        ],\n        RX: [\n          [new THREE.Mesh(new THREE.TorusGeometry(1, 0.02, 12, 60, 2 * Math.PI), new GizmoMaterial({ color: 0xff0000, opacity: 1 })), [0, 0, 0], [0, -Math.PI / 2, -Math.PI / 2], false]\n        ],\n        RY: [\n          [new THREE.Mesh(new THREE.TorusGeometry(1, 0.02, 12, 60, 2 * Math.PI), new GizmoMaterial({ color: 0x0000ff, opacity: 1 })), [0, 0, 0], [Math.PI / 2, 0, 0], false]\n        ]\n      }\n\n      this.hemiPickerGizmos = {\n        XYZ: [\n          [new THREE.Mesh(new THREE.SphereGeometry(1.2, 8, 8, 0, Math.PI), new GizmoMaterial({ color: 0x0000ff })), null, null, false]\n        ]\n      }\n    }\n\n    this.setActivePlane = function (axis, eye) {\n      if (this.activeMode == 'translate') {\n        var tempMatrix = new THREE.Matrix4()\n        eye.applyMatrix4(tempMatrix.getInverse(tempMatrix.extractRotation(this.planes.XY.matrixWorld)))\n\n        if (axis == 'X') {\n          this.activePlane = this.planes.XY\n          if (Math.abs(eye.y) > Math.abs(eye.z)) this.activePlane = this.planes.XZ\n        }\n\n        if (axis == 'Y') {\n          this.activePlane = this.planes.XY\n          if (Math.abs(eye.x) > Math.abs(eye.z)) this.activePlane = this.planes.YZ\n        }\n\n        if (axis == 'Z') {\n          this.activePlane = this.planes.XZ\n          if (Math.abs(eye.x) > Math.abs(eye.y)) this.activePlane = this.planes.YZ\n        }\n      } else if (this.activeMode == 'rotate') {\n        if (axis == 'RX') this.activePlane = this.planes.YZ\n\n        if (axis == 'RY') this.activePlane = this.planes.XZ\n\n        if (axis == 'RZ') this.activePlane = this.planes.XY\n      }\n\n      this.hide()\n      this.show()\n    }\n\n    this.update = function (rotation, eye2) {\n      if (this.activeMode == 'translate') {\n        THREE.TransformGizmo.prototype.update.apply(this, arguments)\n      } else if (this.activeMode == 'rotate') {\n        THREE.TransformGizmo.prototype.update.apply(this, arguments)\n\n        var tempMatrix = new THREE.Matrix4()\n        var worldRotation = new THREE.Euler(0, 0, 1)\n        var tempQuaternion = new THREE.Quaternion()\n        var unitX = new THREE.Vector3(1, 0, 0)\n        var unitY = new THREE.Vector3(0, 1, 0)\n        var unitZ = new THREE.Vector3(0, 0, 1)\n        var quaternionX = new THREE.Quaternion()\n        var quaternionY = new THREE.Quaternion()\n        var quaternionZ = new THREE.Quaternion()\n        var eye = eye2.clone()\n\n        worldRotation.copy(this.planes.XY.rotation)\n        tempQuaternion.setFromEuler(worldRotation)\n\n        tempMatrix.makeRotationFromQuaternion(tempQuaternion).getInverse(tempMatrix)\n        eye.applyMatrix4(tempMatrix)\n\n        this.traverse(function (child) {\n          tempQuaternion.setFromEuler(worldRotation)\n\n          if (child.name == 'RX') {\n            quaternionX.setFromAxisAngle(unitX, Math.atan2(-eye.y, eye.z))\n            tempQuaternion.multiplyQuaternions(tempQuaternion, quaternionX)\n            child.quaternion.copy(tempQuaternion)\n          }\n\n          if (child.name == 'RY') {\n            quaternionY.setFromAxisAngle(unitY, Math.atan2(eye.x, eye.z))\n            tempQuaternion.multiplyQuaternions(tempQuaternion, quaternionY)\n            child.quaternion.copy(tempQuaternion)\n          }\n\n          if (child.name == 'RZ') {\n            quaternionZ.setFromAxisAngle(unitZ, Math.atan2(eye.y, eye.x))\n            tempQuaternion.multiplyQuaternions(tempQuaternion, quaternionZ)\n            child.quaternion.copy(tempQuaternion)\n          }\n        })\n      }\n    }\n\n    this.show = function () {\n      this.traverse(function (child) {\n        if (scope.parent == null || (scope.parent.useAllPickers || child.parent != scope.handles)) child.visible = true\n        if (child.material) child.material.opacity = child.material.oldOpacity\n        if (child.parent == scope.pickers || child.parent == scope.hemiPicker || child.parent == scope.subPickers) child.visible = false\n        if (child.parent == scope.planes || child.parent == scope.highlights) child.visible = false\n      })\n      this.activePlane.visible = false\n    }\n\n    this.highlight = function (axis) {\n      this.traverse(function (child) {\n        if (child.material && child.material.highlight) {\n          if (child.name == axis) {\n            if (child.parent == scope.highlights || child.parent == scope.handles) child.visible = true\n            child.material.highlight(true)\n          } else {\n            child.material.highlight(false)\n            child.material.opacity = 0.1\n          }\n        }\n      })\n    }\n\n    this.init()\n  }\n\n  THREE.TransformGizmoTranslateRotate.prototype = Object.create(THREE.TransformGizmo.prototype)\n\n  THREE.TransformGizmoScale = function () {\n    THREE.TransformGizmo.call(this)\n\n    this.setHandlePickerGizmos = function () {\n      var arrowGeometry = createArrowGeometry(0.125, 0.125, 0.125)\n      var lineXGeometry = createLineGeometry('X')\n      var lineYGeometry = createLineGeometry('Y')\n      var lineZGeometry = createLineGeometry('Z')\n\n      this.handleGizmos = {\n        X: [\n          [new THREE.Mesh(arrowGeometry, new GizmoMaterial({ color: 0xff0000 })), [0.5, 0, 0], [0, 0, -Math.PI / 2]],\n          [new THREE.Line(lineXGeometry, new GizmoLineMaterial({ color: 0xff0000 }))]\n        ],\n        Y: [\n          [new THREE.Mesh(arrowGeometry, new GizmoMaterial({ color: 0x00ff00 })), [0, 0.5, 0]],\n          [new THREE.Line(lineYGeometry, new GizmoLineMaterial({ color: 0x00ff00 }))]\n        ],\n        Z: [\n          [new THREE.Mesh(arrowGeometry, new GizmoMaterial({ color: 0x0000ff })), [0, 0, 0.5], [Math.PI / 2, 0, 0]],\n          [new THREE.Line(lineZGeometry, new GizmoLineMaterial({ color: 0x0000ff }))]\n        ],\n        XYZ: [\n          [new THREE.Mesh(new THREE.BoxGeometry(0.125, 0.125, 0.125), new GizmoMaterial({ color: 0xffffff, opacity: 0.25 }))]\n        ]\n      }\n\n      this.pickerGizmos = {\n        X: [\n          [new THREE.Mesh(new THREE.CylinderGeometry(0.2, 0, 1, 4, 1, false), new GizmoMaterial({ color: 0xff0000, opacity: 0.25 })), [0.6, 0, 0], [0, 0, -Math.PI / 2]]\n        ],\n        Y: [\n          [new THREE.Mesh(new THREE.CylinderGeometry(0.2, 0, 1, 4, 1, false), new GizmoMaterial({ color: 0x00ff00, opacity: 0.25 })), [0, 0.6, 0]]\n        ],\n        Z: [\n          [new THREE.Mesh(new THREE.CylinderGeometry(0.2, 0, 1, 4, 1, false), new GizmoMaterial({ color: 0x0000ff, opacity: 0.25 })), [0, 0, 0.6], [Math.PI / 2, 0, 0]]\n        ],\n        XYZ: [\n          [new THREE.Mesh(new THREE.BoxGeometry(0.4, 0.4, 0.4), new GizmoMaterial({ color: 0xffffff, opacity: 0.25 }))]\n        ]\n      }\n    }\n\n    this.setActivePlane = function (axis, eye) {\n      var tempMatrix = new THREE.Matrix4()\n      eye.applyMatrix4(tempMatrix.getInverse(tempMatrix.extractRotation(this.planes.XY.matrixWorld)))\n\n      if (axis == 'X') {\n        this.activePlane = this.planes.XY\n        if (Math.abs(eye.y) > Math.abs(eye.z)) this.activePlane = this.planes.XZ\n      }\n\n      if (axis == 'Y') {\n        this.activePlane = this.planes.XY\n        if (Math.abs(eye.x) > Math.abs(eye.z)) this.activePlane = this.planes.YZ\n      }\n\n      if (axis == 'Z') {\n        this.activePlane = this.planes.XZ\n        if (Math.abs(eye.x) > Math.abs(eye.y)) this.activePlane = this.planes.YZ\n      }\n\n      if (axis == 'XYZ') this.activePlane = this.planes.XYZE\n\n      this.hide()\n      this.show()\n    }\n\n    this.init()\n  }\n\n  THREE.TransformGizmoScale.prototype = Object.create(THREE.TransformGizmo.prototype)\n\n  THREE.TransformControls = function (camera, domElement, mode) {\n    // TODO: Make non-uniform scale and rotate play nice in hierarchies\n    // TODO: ADD RXYZ contol\n\n    THREE.Object3D.call(this)\n\n    domElement = (domElement !== undefined) ? domElement : document\n\n    this.gizmo = {}\n    switch (mode) {\n      case 'translate':\n        this.gizmo[mode] = new THREE.TransformGizmoTranslate()\n        break\n      case 'rotate':\n        this.gizmo[mode] = new THREE.TransformGizmoRotate()\n        break\n      case 'transrotate':\n        this.gizmo[mode] = new THREE.TransformGizmoTranslateRotate()\n        break\n      case 'scale':\n        this.gizmo[mode] = new THREE.TransformGizmoScale()\n        break\n    }\n\n    this.add(this.gizmo[mode])\n    this.gizmo[mode].hide()\n\n    this.object = undefined\n    this.snap = null\n    this.snapDelta = 0\n    this.space = 'world'\n    this.size = 1\n    this.axis = null\n    this.useAllPickers = true\n\n    this.unitX = new THREE.Vector3(1, 0, 0)\n    this.unitY = new THREE.Vector3(0, 1, 0)\n    this.unitZ = new THREE.Vector3(0, 0, 1)\n    this.normal = new THREE.Vector3(0, 0, 1)\n\n    if (mode === 'transrotate') {\n      var geometry = new THREE.Geometry()\n      geometry.vertices.push(new THREE.Vector3(0, 0, 0), new THREE.Vector3(0, 0, 1))\n      var material = new THREE.LineBasicMaterial({ color: 0x000000, linewidth: 2, depthTest: false })\n      this.startLine = new THREE.Line(geometry, material)\n      var geometry = new THREE.Geometry()\n      var material = new THREE.LineBasicMaterial({ color: 0xffe603, linewidth: 2, depthTest: false })\n      geometry.vertices.push(new THREE.Vector3(0, 0, 0), new THREE.Vector3(0, 0, 1))\n      this.endLine = new THREE.Line(geometry, material)\n      var geometry = new THREE.Geometry()\n      var material = new THREE.LineDashedMaterial({ color: 0x000000, linewidth: 1, depthTest: false })\n      geometry.vertices.push(new THREE.Vector3(0, -1, 0), new THREE.Vector3(0, 1, 0))\n      this.centerLine = new THREE.Line(geometry, material)\n\n      var map = THREE.ImageUtils.loadTexture(Autodesk.Viewing.Private.getResourceUrl('res/textures/centerMarker_X.png'))\n      map.magFilter = map.minFilter = THREE.NearestFilter\n      var geometry = new THREE.CircleGeometry(0.1, 32)\n      var material = new THREE.MeshBasicMaterial({ opacity: 1, side: THREE.DoubleSide, transparent: true, map: map })\n      this.centerMark = new THREE.Mesh(geometry, material)\n      this.centerMark.rotation.set(Math.PI / 2, 0, 0)\n\n      this.ticks = {}\n      var map = THREE.ImageUtils.loadTexture(Autodesk.Viewing.Private.getResourceUrl('res/textures/cardinalPoint.png'))\n      map.magFilter = map.minFilter = THREE.NearestFilter\n      var material = new THREE.MeshBasicMaterial({ depthTest: false, opacity: 1, transparent: true, side: THREE.DoubleSide, map: map })\n      var w = 0.12; var h = 0.25; var d = 1.15\n\n      this.ticks.RX = new THREE.Object3D()\n      var geometry = new THREE.PlaneBufferGeometry(w, h)\n      var mesh = new THREE.Mesh(geometry, material)\n      mesh.position.set(0, 0, -d - h / 2)\n      mesh.rotation.set(Math.PI / 2, Math.PI / 2, 0)\n      this.ticks.RX.add(mesh)\n\n      mesh = mesh.clone()\n      mesh.position.set(0, d + h / 2, 0)\n      mesh.rotation.set(0, Math.PI / 2, 0)\n      this.ticks.RX.add(mesh)\n\n      mesh = mesh.clone()\n      mesh.position.set(0, 0, d + h / 2)\n      mesh.rotation.set(0, Math.PI / 2, Math.PI / 2)\n      this.ticks.RX.add(mesh)\n\n      mesh = mesh.clone()\n      mesh.position.set(0, -d - h / 2, 0)\n      mesh.rotation.set(0, Math.PI / 2, 0)\n      this.ticks.RX.add(mesh)\n\n      this.ticks.RY = new THREE.Object3D()\n      mesh = mesh.clone()\n      mesh.position.set(0, 0, -d - h / 2)\n      mesh.rotation.set(Math.PI / 2, 0, 0)\n      this.ticks.RY.add(mesh)\n\n      mesh = mesh.clone()\n      mesh.position.set(-d - h / 2, 0, 0)\n      mesh.rotation.set(Math.PI / 2, 0, Math.PI / 2)\n      this.ticks.RY.add(mesh)\n\n      mesh = mesh.clone()\n      mesh.position.set(0, 0, d + h / 2)\n      mesh.rotation.set(Math.PI / 2, 0, 0)\n      this.ticks.RY.add(mesh)\n\n      mesh = mesh.clone()\n      mesh.position.set(d + h / 2, 0, 0)\n      mesh.rotation.set(Math.PI / 2, 0, Math.PI / 2)\n      this.ticks.RY.add(mesh)\n    }\n\n    var scope = this\n\n    var _dragging = false\n    var _mode = mode\n    var _plane = 'XY'\n\n    var changeEvent = { type: 'change' }\n    var mouseDownEvent = { type: 'mouseDown' }\n    var mouseUpEvent = { type: 'mouseUp', mode: _mode }\n    var objectChangeEvent = { type: 'objectChange' }\n\n    var ray = new THREE.Raycaster()\n    var pointerVector = new THREE.Vector3()\n    var pointerDir = new THREE.Vector3()\n\n    var point = new THREE.Vector3()\n    var offset = new THREE.Vector3()\n\n    var rotation = new THREE.Vector3()\n    var offsetRotation = new THREE.Vector3()\n    var scale = 1\n\n    var lookAtMatrix = new THREE.Matrix4()\n    var eye = new THREE.Vector3()\n\n    var tempMatrix = new THREE.Matrix4()\n    var tempVector = new THREE.Vector3()\n    var tempQuaternion = new THREE.Quaternion()\n    var projX = new THREE.Vector3()\n    var projY = new THREE.Vector3()\n    var projZ = new THREE.Vector3()\n\n    var quaternionXYZ = new THREE.Quaternion()\n    var quaternionX = new THREE.Quaternion()\n    var quaternionY = new THREE.Quaternion()\n    var quaternionZ = new THREE.Quaternion()\n    var quaternionE = new THREE.Quaternion()\n\n    var oldPosition = new THREE.Vector3()\n    var oldScale = new THREE.Vector3()\n    var oldRotationMatrix = new THREE.Matrix4()\n\n    var parentRotationMatrix = new THREE.Matrix4()\n    var parentScale = new THREE.Vector3()\n\n    var worldPosition = new THREE.Vector3()\n    var worldRotation = new THREE.Euler()\n    var worldRotationMatrix = new THREE.Matrix4()\n    var camPosition = new THREE.Vector3()\n    var camRotation = new THREE.Euler()\n\n    this.attach = function (object) {\n      scope.object = object\n\n      this.gizmo[_mode].show()\n\n      scope.update()\n\n      scope.updateUnitVectors()\n    }\n\n    this.detach = function (object) {\n      scope.object = undefined\n      this.axis = null\n\n      this.gizmo[_mode].hide()\n    }\n\n    this.setMode = function (mode) {\n      _mode = mode || _mode\n\n      if (_mode == 'scale') scope.space = 'local'\n\n      this.gizmo[_mode].show()\n\n      this.update()\n      scope.dispatchEvent(changeEvent)\n    }\n\n    this.getPicker = function () {\n      return scope.gizmo[_mode].hemiPicker.children\n    }\n\n    this.setPosition = function (position) {\n      this.object.position.copy(position)\n      this.update()\n    }\n\n    this.setNormal = function (normal) {\n      tempQuaternion.setFromUnitVectors(this.normal, normal)\n      this.unitX.applyQuaternion(tempQuaternion)\n      this.unitY.applyQuaternion(tempQuaternion)\n      this.unitZ.applyQuaternion(tempQuaternion)\n      this.normal.copy(normal)\n      if (this.object) {\n        this.object.quaternion.multiply(tempQuaternion)\n      }\n      this.update()\n    }\n\n    this.setSnap = function (snap, delta) {\n      scope.snap = snap\n      scope.snapDelta = delta\n    }\n\n    this.setSize = function (size) {\n      scope.size = size\n      this.update()\n      scope.dispatchEvent(changeEvent)\n    }\n\n    this.setSpace = function (space) {\n      scope.space = space\n      this.update()\n      scope.dispatchEvent(changeEvent)\n    }\n\n    this.update = function (highlight) {\n      if (scope.object === undefined) return\n\n      scope.object.updateMatrixWorld()\n      worldPosition.setFromMatrixPosition(scope.object.matrixWorld)\n      worldRotation.setFromRotationMatrix(tempMatrix.extractRotation(scope.object.matrixWorld))\n\n      camera.updateMatrixWorld()\n      camPosition.setFromMatrixPosition(camera.matrixWorld)\n      // camRotation.setFromRotationMatrix( tempMatrix.extractRotation( camera.matrixWorld ) );\n\n      this.position.copy(worldPosition)\n\n      this.quaternion.setFromEuler(worldRotation)\n\n      this.normal.set(0, 0, 1)\n      this.normal.applyEuler(worldRotation)\n\n      // keep same screen height (100px)\n      var dist = worldPosition.distanceTo(camPosition)\n      var height = camera.isPerspective ? 2 * Math.tan(camera.fov * Math.PI / 360) * dist : dist\n      var rect = domElement.getBoundingClientRect()\n      scale = 100 * height / rect.height\n      this.scale.set(scale, scale, scale)\n\n      // eye.copy( camPosition ).sub( worldPosition ).normalize();\n\n      // if ( scope.space == \"local\" )\n      //    this.gizmo[_mode].update( worldRotation, eye );\n      // else if ( scope.space == \"world\" )\n      //    this.gizmo[_mode].update( new THREE.Euler(), eye );\n\n      if (highlight) { this.gizmo[_mode].highlight(scope.axis) }\n    }\n\n    this.updateUnitVectors = function () {\n      this.unitX.set(1, 0, 0)\n      this.unitY.set(0, 1, 0)\n      this.unitZ.set(0, 0, 1)\n      this.unitX.applyEuler(worldRotation)\n      this.unitY.applyEuler(worldRotation)\n      this.unitZ.applyEuler(worldRotation)\n    }\n\n    this.showRotationGizmos = function (set) {\n      var handles = this.gizmo[_mode].handles.children\n      for (var i = 0; i < handles.length; i++) {\n        var child = handles[i]\n        child.visible = true\n        if (child.name.search('R') !== -1) child.visible = set\n      }\n      this.useAllPickers = set\n    }\n\n    this.highlight = function () {\n      this.gizmo[_mode].highlight(this.axis || 'Z')\n    }\n\n    this.onPointerHover = function (event) {\n      if (scope.object === undefined || _dragging === true) return false\n\n      var pointer = event.pointers ? event.pointers[0] : event\n\n      var intersect = intersectObjects(pointer, scope.useAllPickers ? scope.gizmo[_mode].pickers.children : scope.gizmo[_mode].subPickers.children)\n\n      var axis = null\n      var mode = ''\n\n      if (intersect) {\n        axis = intersect.object.name\n        mode = axis.search('R') != -1 ? 'rotate' : 'translate'\n      }\n\n      if (scope.axis !== axis) {\n        scope.axis = axis\n        scope.gizmo[_mode].activeMode = mode\n        scope.update(true)\n        scope.dispatchEvent(changeEvent)\n      }\n\n      if (scope.axis === null) {\n        scope.gizmo[_mode].show()\n      }\n\n      return !!intersect\n    }\n\n    this.onPointerDown = function (event) {\n      if (scope.object === undefined || _dragging === true) return false\n\n      var pointer = event.pointers ? event.pointers[0] : event\n\n      if (event.pointerType === 'touch') {\n        var intersect = intersectObjects(pointer, scope.useAllPickers ? scope.gizmo[_mode].pickers.children : scope.gizmo[_mode].subPickers.children)\n\n        var axis = null\n        var mode = ''\n\n        if (intersect) {\n          axis = intersect.object.name\n          mode = axis.search('R') != -1 ? 'rotate' : 'translate'\n        }\n\n        if (scope.axis !== axis) {\n          scope.axis = axis\n          scope.gizmo[_mode].activeMode = mode\n        }\n      }\n\n      var intersect = null\n\n      if (pointer.button === 0 || pointer.button === undefined) {\n        intersect = intersectObjects(pointer, scope.useAllPickers ? scope.gizmo[_mode].pickers.children : scope.gizmo[_mode].subPickers.children)\n\n        if (intersect) {\n          scope.dispatchEvent(mouseDownEvent)\n\n          scope.axis = intersect.object.name\n\n          scope.update()\n\n          eye.copy(camera.position).sub(worldPosition).normalize()\n\n          scope.gizmo[_mode].setActivePlane(scope.axis, eye)\n\n          var planeIntersect = intersectObjects(pointer, [scope.gizmo[_mode].activePlane])\n\n          if (planeIntersect) { offset.copy(planeIntersect.point) }\n\n          oldPosition.copy(scope.object.position)\n          oldScale.copy(scope.object.scale)\n\n          oldRotationMatrix.extractRotation(scope.object.matrix)\n          worldRotationMatrix.extractRotation(scope.object.matrixWorld)\n\n          if (scope.object.parent) {\n            parentRotationMatrix.extractRotation(scope.object.parent.matrixWorld)\n            parentScale.setFromMatrixScale(tempMatrix.getInverse(scope.object.parent.matrixWorld))\n          } else {\n            parentRotationMatrix.extractRotation(scope.object.matrixWorld)\n            parentScale.setFromMatrixScale(tempMatrix.getInverse(scope.object.matrixWorld))\n          }\n\n          // show rotation start line and ticks\n          if (_mode === 'transrotate' && scope.gizmo[_mode].activeMode === 'rotate') {\n            scope.startLine.geometry.vertices[0].set(0, 0, 0).applyMatrix4(scope.matrixWorld)\n            scope.startLine.geometry.vertices[1].set(0, 0, 1).applyMatrix4(scope.matrixWorld)\n            scope.startLine.geometry.verticesNeedUpdate = true\n            scope.parent.add(scope.startLine)\n\n            var pos = scope.object.geometry.getAttribute('position')\n            var pt1 = new THREE.Vector3().fromAttribute(pos, 0).applyMatrix4(scope.object.matrixWorld)\n            var pt2 = new THREE.Vector3().fromAttribute(pos, 1).applyMatrix4(scope.object.matrixWorld)\n            var pt3 = new THREE.Vector3().fromAttribute(pos, 2).applyMatrix4(scope.object.matrixWorld)\n            var pt4 = new THREE.Vector3().fromAttribute(pos, 3).applyMatrix4(scope.object.matrixWorld)\n            if (scope.axis === 'RX') {\n              pt1.lerp(pt3, 0.5)\n              pt2.lerp(pt4, 0.5)\n              var dist = pt1.distanceTo(pt2)\n              scope.centerLine.material.dashSize = dist / 15\n              scope.centerLine.material.gapSize = dist / 30\n              scope.centerLine.geometry.vertices[0].copy(pt1)\n              scope.centerLine.geometry.vertices[1].copy(pt2)\n            } else {\n              pt1.lerp(pt2, 0.5)\n              pt3.lerp(pt4, 0.5)\n              var dist = pt1.distanceTo(pt3)\n              scope.centerLine.material.dashSize = dist / 15\n              scope.centerLine.material.gapSize = dist / 30\n              scope.centerLine.geometry.vertices[0].copy(pt1)\n              scope.centerLine.geometry.vertices[1].copy(pt3)\n            }\n            scope.centerLine.geometry.computeLineDistances()\n            scope.centerLine.geometry.verticesNeedUpdate = true\n            scope.parent.add(scope.centerLine)\n\n            scope.ticks[scope.axis].position.copy(scope.position)\n            scope.ticks[scope.axis].quaternion.copy(scope.quaternion)\n            scope.ticks[scope.axis].scale.copy(scope.scale)\n            scope.parent.add(scope.ticks[scope.axis])\n          }\n        }\n      }\n\n      _dragging = true\n\n      return !!intersect\n    }\n\n    this.onPointerMove = function (event) {\n      if (scope.object === undefined || scope.axis === null || _dragging === false) return false\n\n      var pointer = event.pointers ? event.pointers[0] : event\n\n      var planeIntersect = intersectObjects(pointer, [scope.gizmo[_mode].activePlane])\n\n      if (planeIntersect) { point.copy(planeIntersect.point) }\n\n      var mode = scope.gizmo[_mode].activeMode\n      if (mode == 'translate') {\n        point.sub(offset)\n        point.multiply(parentScale)\n\n        if (scope.space == 'local') {\n          point.applyMatrix4(tempMatrix.getInverse(worldRotationMatrix))\n\n          projX.copy(this.unitX)\n          projY.copy(this.unitY)\n          projZ.copy(this.unitZ)\n          tempVector.set(0, 0, 0)\n          if (scope.axis.search('X') != -1) {\n            projX.multiplyScalar(point.dot(this.unitX))\n            tempVector.add(projX)\n          }\n          if (scope.axis.search('Y') != -1) {\n            projY.multiplyScalar(point.dot(this.unitY))\n            tempVector.add(projY)\n          }\n          if (scope.axis.search('Z') != -1) {\n            projZ.multiplyScalar(point.dot(this.unitZ))\n            tempVector.add(projZ)\n          }\n          point.copy(tempVector)\n\n          point.applyMatrix4(oldRotationMatrix)\n\n          scope.object.position.copy(oldPosition)\n          scope.object.position.add(point)\n        }\n\n        if (scope.space == 'world' || scope.axis.search('XYZ') != -1) {\n          projX.copy(this.unitX)\n          projY.copy(this.unitY)\n          projZ.copy(this.unitZ)\n          tempVector.set(0, 0, 0)\n          if (scope.axis.search('X') != -1) {\n            projX.multiplyScalar(point.dot(this.unitX))\n            tempVector.add(projX)\n          }\n          if (scope.axis.search('Y') != -1) {\n            projY.multiplyScalar(point.dot(this.unitY))\n            tempVector.add(projY)\n          }\n          if (scope.axis.search('Z') != -1) {\n            projZ.multiplyScalar(point.dot(this.unitZ))\n            tempVector.add(projZ)\n          }\n          point.copy(tempVector)\n\n          point.applyMatrix4(tempMatrix.getInverse(parentRotationMatrix))\n\n          scope.object.position.copy(oldPosition)\n          scope.object.position.add(point)\n        }\n      } else if (mode == 'scale') {\n        point.sub(offset)\n        point.multiply(parentScale)\n\n        if (scope.space == 'local') {\n          if (scope.axis == 'XYZ') {\n            scale = 1 + ((point.y) / 50)\n\n            scope.object.scale.x = oldScale.x * scale\n            scope.object.scale.y = oldScale.y * scale\n            scope.object.scale.z = oldScale.z * scale\n          } else {\n            point.applyMatrix4(tempMatrix.getInverse(worldRotationMatrix))\n\n            if (scope.axis == 'X') scope.object.scale.x = oldScale.x * (1 + point.x / 50)\n            if (scope.axis == 'Y') scope.object.scale.y = oldScale.y * (1 + point.y / 50)\n            if (scope.axis == 'Z') scope.object.scale.z = oldScale.z * (1 + point.z / 50)\n          }\n        }\n      } else if (mode == 'rotate') {\n        point.sub(worldPosition)\n        point.multiply(parentScale)\n        tempVector.copy(offset).sub(worldPosition)\n        tempVector.multiply(parentScale)\n\n        if (scope.axis == 'RE') {\n          point.applyMatrix4(tempMatrix.getInverse(lookAtMatrix))\n          tempVector.applyMatrix4(tempMatrix.getInverse(lookAtMatrix))\n\n          rotation.set(Math.atan2(point.z, point.y), Math.atan2(point.x, point.z), Math.atan2(point.y, point.x))\n          offsetRotation.set(Math.atan2(tempVector.z, tempVector.y), Math.atan2(tempVector.x, tempVector.z), Math.atan2(tempVector.y, tempVector.x))\n\n          tempQuaternion.setFromRotationMatrix(tempMatrix.getInverse(parentRotationMatrix))\n\n          var rotz = rotation.z - offsetRotation.z\n          if (scope.snap !== null) {\n            var rotsnap = Math.round(rotz / scope.snap) * scope.snap\n            if (Math.abs(rotsnap - rotz) < scope.snapDelta) {\n              rotz = rotsnap\n            }\n          }\n          quaternionE.setFromAxisAngle(eye, rotz)\n          quaternionXYZ.setFromRotationMatrix(worldRotationMatrix)\n\n          tempQuaternion.multiplyQuaternions(tempQuaternion, quaternionE)\n          tempQuaternion.multiplyQuaternions(tempQuaternion, quaternionXYZ)\n\n          scope.object.quaternion.copy(tempQuaternion)\n        } else if (scope.axis == 'RXYZE') {\n          var tempAxis = point.clone().cross(tempVector).normalize() // rotation axis\n\n          tempQuaternion.setFromRotationMatrix(tempMatrix.getInverse(parentRotationMatrix))\n\n          var rot = -point.clone().angleTo(tempVector)\n          if (scope.snap !== null) {\n            var rotsnap = Math.round(rot / scope.snap) * scope.snap\n            if (Math.abs(rotsnap - rot) < scope.snapDelta) {\n              rot = rotsnap\n            }\n          }\n          quaternionX.setFromAxisAngle(tempAxis, rot)\n          quaternionXYZ.setFromRotationMatrix(worldRotationMatrix)\n\n          tempQuaternion.multiplyQuaternions(tempQuaternion, quaternionX)\n          tempQuaternion.multiplyQuaternions(tempQuaternion, quaternionXYZ)\n\n          scope.object.quaternion.copy(tempQuaternion)\n        } else if (scope.space == 'local') {\n          point.applyMatrix4(tempMatrix.getInverse(worldRotationMatrix))\n\n          tempVector.applyMatrix4(tempMatrix.getInverse(worldRotationMatrix))\n\n          var projx = point.dot(this.unitX); var projy = point.dot(this.unitY); var projz = point.dot(this.unitZ)\n          var tempx = tempVector.dot(this.unitX); var tempy = tempVector.dot(this.unitY); var tempz = tempVector.dot(this.unitZ)\n          rotation.set(Math.atan2(projz, projy), Math.atan2(projx, projz), Math.atan2(projy, projx))\n          offsetRotation.set(Math.atan2(tempz, tempy), Math.atan2(tempx, tempz), Math.atan2(tempy, tempx))\n\n          var rotx = rotation.x - offsetRotation.x\n          var roty = rotation.y - offsetRotation.y\n          var rotz = rotation.z - offsetRotation.z\n          if (scope.snap !== null) {\n            if (scope.axis.search('X') != -1) {\n              var rotsnap = Math.round(rotx / scope.snap) * scope.snap\n              if (Math.abs(rotsnap - rotx) < scope.snapDelta) {\n                rotx = rotsnap\n              }\n            }\n            if (scope.axis.search('Y') != -1) {\n              var rotsnap = Math.round(roty / scope.snap) * scope.snap\n              if (Math.abs(rotsnap - roty) < scope.snapDelta) {\n                roty = rotsnap\n              }\n            }\n            if (scope.axis.search('Z') != -1) {\n              var rotsnap = Math.round(rotz / scope.snap) * scope.snap\n              if (Math.abs(rotsnap - rotz) < scope.snapDelta) {\n                rotz = rotsnap\n              }\n            }\n          }\n          quaternionX.setFromAxisAngle(this.unitX, rotx)\n          quaternionY.setFromAxisAngle(this.unitY, roty)\n          quaternionZ.setFromAxisAngle(this.unitZ, rotz)\n          quaternionXYZ.setFromRotationMatrix(oldRotationMatrix)\n\n          if (scope.axis == 'RX') quaternionXYZ.multiplyQuaternions(quaternionXYZ, quaternionX)\n          if (scope.axis == 'RY') quaternionXYZ.multiplyQuaternions(quaternionXYZ, quaternionY)\n          if (scope.axis == 'RZ') quaternionXYZ.multiplyQuaternions(quaternionXYZ, quaternionZ)\n\n          scope.object.quaternion.copy(quaternionXYZ)\n        } else if (scope.space == 'world') {\n          var projx = point.dot(this.unitX); var projy = point.dot(this.unitY); var projz = point.dot(this.unitZ)\n          var tempx = tempVector.dot(this.unitX); var tempy = tempVector.dot(this.unitY); var tempz = tempVector.dot(this.unitZ)\n          rotation.set(Math.atan2(projz, projy), Math.atan2(projx, projz), Math.atan2(projy, projx))\n          offsetRotation.set(Math.atan2(tempz, tempy), Math.atan2(tempx, tempz), Math.atan2(tempy, tempx))\n\n          tempQuaternion.setFromRotationMatrix(tempMatrix.getInverse(parentRotationMatrix))\n\n          var rotx = rotation.x - offsetRotation.x\n          var roty = rotation.y - offsetRotation.y\n          var rotz = rotation.z - offsetRotation.z\n          if (scope.snap !== null) {\n            if (scope.axis.search('X') != -1) {\n              var rotsnap = Math.round(rotx / scope.snap) * scope.snap\n              if (Math.abs(rotsnap - rotx) < scope.snapDelta) {\n                rotx = rotsnap\n              }\n            }\n            if (scope.axis.search('Y') != -1) {\n              var rotsnap = Math.round(roty / scope.snap) * scope.snap\n              if (Math.abs(rotsnap - roty) < scope.snapDelta) {\n                roty = rotsnap\n              }\n            }\n            if (scope.axis.search('Z') != -1) {\n              var rotsnap = Math.round(rotz / scope.snap) * scope.snap\n              if (Math.abs(rotsnap - rotz) < scope.snapDelta) {\n                rotz = rotsnap\n              }\n            }\n          }\n          quaternionX.setFromAxisAngle(this.unitX, rotx)\n          quaternionY.setFromAxisAngle(this.unitY, roty)\n          quaternionZ.setFromAxisAngle(this.unitZ, rotz)\n          quaternionXYZ.setFromRotationMatrix(worldRotationMatrix)\n\n          if (scope.axis == 'RX') tempQuaternion.multiplyQuaternions(tempQuaternion, quaternionX)\n          if (scope.axis == 'RY') tempQuaternion.multiplyQuaternions(tempQuaternion, quaternionY)\n          if (scope.axis == 'RZ') tempQuaternion.multiplyQuaternions(tempQuaternion, quaternionZ)\n\n          tempQuaternion.multiplyQuaternions(tempQuaternion, quaternionXYZ)\n\n          scope.object.quaternion.copy(tempQuaternion)\n        }\n\n        // show rotation end line\n        if (_mode === 'transrotate') {\n          scope.add(scope.endLine)\n          scope.add(scope.centerMark)\n        }\n      }\n\n      // update matrix\n      scope.object.matrixAutoUpdate = true\n\n      scope.update(true)\n      scope.dispatchEvent(changeEvent)\n      scope.dispatchEvent(objectChangeEvent)\n\n      return !!planeIntersect\n    }\n\n    this.onPointerUp = function (event) {\n      if (_dragging && (scope.axis !== null)) {\n        mouseUpEvent.mode = _mode\n        scope.dispatchEvent(mouseUpEvent)\n      }\n      _dragging = false\n\n      this.gizmo[_mode].show()\n\n      this.updateUnitVectors()\n\n      // remove rotation start/end lines\n      if (_mode === 'transrotate' && this.gizmo[_mode].activeMode === 'rotate') {\n        this.remove(this.endLine)\n        this.remove(this.centerMark)\n        this.parent.remove(this.centerLine)\n        this.parent.remove(this.startLine)\n        this.parent.remove(this.ticks[this.axis])\n      }\n\n      return false\n    }\n\n    function intersectObjects (pointer, objects) {\n      var rect = domElement.getBoundingClientRect()\n      var x = ((pointer.clientX - rect.left) / rect.width) * 2 - 1\n      var y = -((pointer.clientY - rect.top) / rect.height) * 2 + 1\n\n      if (camera.isPerspective) {\n        pointerVector.set(x, y, 0.5)\n        pointerVector.unproject(camera)\n        ray.set(camera.position, pointerVector.sub(camera.position).normalize())\n      } else {\n        pointerVector.set(x, y, -1)\n        pointerVector.unproject(camera)\n        pointerDir.set(0, 0, -1)\n        ray.set(pointerVector, pointerDir.transformDirection(camera.matrixWorld))\n      }\n\n      var intersections = ray.intersectObjects(objects, true)\n      return intersections[0] ? intersections[0] : false\n    }\n  }\n\n  THREE.TransformControls.prototype = Object.create(THREE.Object3D.prototype)\n})()\n","\nimport GUIObjectAdapter from './utils/GUIObjectAdapter'\nimport ToolPanelBase from './utils/ToolPanelBase'\nimport './Viewing.Extension.Particle.css'\nimport dat from 'dat-gui'\n\nexport default class ParticlePanel extends ToolPanelBase {\n  /// //////////////////////////////////////////////////////////\n  //\n  //\n  /// //////////////////////////////////////////////////////////\n  constructor (extension, viewer, btnElement) {\n    super(viewer.container, 'Particle Controls', {\n      buttonElement: btnElement,\n      closable: false\n    })\n\n    $(this.container).addClass('particle')\n\n    this.particleSystem = extension.particleSystem\n\n    var gui = new dat.GUI({\n      autoPlace: false\n    })\n\n    var guiContainer = document.getElementById(\n      this.container.id + '-gui')\n\n    guiContainer.appendChild(\n      gui.domElement)\n\n    var folder = gui.addFolder('Particle System Settings')\n\n    this.maxParticleCtrl = folder.add(\n      extension,\n      'maxParticles', 0, 1000000).name(\n      'Max Particles').step(1)\n\n    this.maxParticleCtrl.onFinishChange((value) => {\n      this.emit('maxParticles.changed', value)\n    })\n\n    this.toolCtrl = folder.add(\n      extension,\n      'tool', ['Mesh', 'Point Cloud']).name(\n      'Tool')\n\n    this.toolCtrl.onFinishChange((value) => {\n      this.emit('tool.changed', value)\n    })\n\n    folder.open()\n\n    setTimeout(() => {\n      gui.domElement.style.width = '100%'\n    }, 0)\n  }\n\n  /// //////////////////////////////////////////////////////////\n  //\n  //\n  /// //////////////////////////////////////////////////////////\n  htmlContent (id) {\n    return `\n       <div class=\"container\">\n            <div id=\"${id}-gui\">\n            </div>\n        </div>\n      `\n  }\n\n  /// //////////////////////////////////////////////////////////\n  //\n  //\n  /// //////////////////////////////////////////////////////////\n  loadObjectGUI (obj) {\n    $('#' + this.container.id + '-obj-gui').remove()\n\n    if (!obj || !obj.getSelectable()) {\n      return\n    }\n\n    var gui = new dat.GUI({\n      autoPlace: false\n    })\n\n    $('#' + this.container.id + '-gui').append(\n      `<div id=\"${this.container.id}-obj-gui\"></div>`\n    )\n\n    var guiContainer = document.getElementById(\n      this.container.id + '-obj-gui')\n\n    guiContainer.appendChild(\n      gui.domElement)\n\n    switch (obj.getType()) {\n      case 0:\n\n        this.selectedObjectGUI = new GUIObjectAdapter(\n          this.particleSystem.getEmitter(obj.getId()), {\n            emissionRate: {\n              getter: 'getEmissionRate',\n              setter: 'setEmissionRate'\n            },\n            spread: {\n              getter: 'getSpread',\n              setter: 'setSpread'\n            },\n            velocity: {\n              getter: 'getVelocity',\n              setter: 'setVelocity'\n            },\n            charge: {\n              getter: 'getCharge',\n              setter: 'setCharge'\n            }\n          })\n\n        var emitterFolder = gui.addFolder(\n          'Emitter Settings')\n\n        emitterFolder.add(\n          this.selectedObjectGUI,\n          'emissionRate', 10, 10000).name('Emission Rate')\n          .onChange(() => {\n            this.selectedObjectGUI.update()\n          })\n\n        emitterFolder.add(\n          this.selectedObjectGUI,\n          'spread', 0.0, 6 * Math.PI / 180).name('Spread')\n          .onChange(() => {\n            this.selectedObjectGUI.update()\n          })\n\n        emitterFolder.add(\n          this.selectedObjectGUI,\n          'velocity', 0.1, 10).name('Particles Velocity')\n          .onChange(() => {\n            this.selectedObjectGUI.update()\n          })\n\n        var chargeCtrl = emitterFolder.add(\n          this.selectedObjectGUI,\n          'charge', -10, 10).name('Particles Charge')\n\n        chargeCtrl.onChange((value) => {\n          this.selectedObjectGUI.update()\n\n          this.emit('objectModified', {\n            property: 'charge',\n            value: value,\n            object: obj\n          })\n        })\n\n        emitterFolder.open()\n        break\n\n      case 1:\n\n        this.selectedObjectGUI = new GUIObjectAdapter(\n          this.particleSystem.getMagneticField(obj.getId()), {\n            force: {\n              getter: 'getForce',\n              setter: 'setForce'\n            }\n          })\n\n        var fieldFolder = gui.addFolder('Field Settings')\n\n        var forceCtrl = fieldFolder.add(\n          this.selectedObjectGUI,\n          'force', -100, 100).name('Force')\n\n        forceCtrl.onChange((value) => {\n          this.selectedObjectGUI.update()\n\n          this.emit('objectModified', {\n            property: 'force',\n            value: value,\n            object: obj\n          })\n        })\n\n        fieldFolder.open()\n        break\n\n      default:\n        break\n    }\n\n    window.setTimeout(() => {\n      gui.domElement.style.width = '100%'\n    }, 0)\n\n    this.setVisible(true)\n  }\n\n  /// //////////////////////////////////////////////////////////\n  //\n  //\n  /// //////////////////////////////////////////////////////////\n  loadToolGUI (tool) {\n    $('#' + this.container.id + '-tool-gui').remove()\n\n    var gui = new dat.GUI({\n      autoPlace: false\n    })\n\n    $('#' + this.container.id + '-gui').append(\n      `<div id=\"${this.container.id}-tool-gui\"></div>`\n    )\n\n    var guiContainer = document.getElementById(\n      this.container.id + '-tool-gui')\n\n    guiContainer.appendChild(\n      gui.domElement)\n\n    switch (tool.getName()) {\n      case 'Viewing.Particle.Tool.Mesh':\n\n        var meshFolder = gui.addFolder(\n          'Mesh Tool Settings')\n\n        this.shadersCtrl = meshFolder.add(\n          tool,\n          'shaders', ['ON', 'OFF']).name(\n          'Shaders')\n\n        this.shadersCtrl.onFinishChange((value) => {\n          this.emit('shaders.changed', value)\n        })\n\n        break\n\n      default:\n        break\n    }\n\n    window.setTimeout(() => {\n      gui.domElement.style.width = '100%'\n    }, 0)\n\n    this.setVisible(true)\n  }\n\n  /// //////////////////////////////////////////////////////////\n  //\n  //\n  /// //////////////////////////////////////////////////////////\n  setSelected (obj) {\n    this.loadObjectGUI(obj)\n  }\n}\n","\nexport default class GUIObjectAdapter {\n  constructor (obj, mapping) {\n    this.mapping = mapping\n\n    this.object = obj\n\n    for (const key in this.mapping) {\n      const getter = this.mapping[key].getter\n\n      this[key] = this.object[getter]()\n    }\n  }\n\n  update () {\n    for (const key in this.mapping) {\n      if (this.mapping[key].setter) {\n        const setter = this.mapping[key].setter\n\n        this.object[setter](this[key])\n      }\n    }\n  }\n}\n","/// //////////////////////////////////////////////////////////////\n//\n//\n/// //////////////////////////////////////////////////////////////\nimport './ToolPanelBase.css'\n\nfunction getDefaultOptions () {\n  return {\n    shadow: true,\n    movable: true,\n    closable: true\n  }\n}\n\nexport default class ToolPanelBase extends\n  Autodesk.Viewing.UI.DockingPanel {\n  /// ////////////////////////////////////////////////////////////////\n  //\n  //\n  /// ////////////////////////////////////////////////////////////////\n  static guid (format = 'xxxxxxxxxx') {\n    var d = new Date().getTime()\n\n    var guid = format.replace(\n      /[xy]/g,\n      function (c) {\n        var r = (d + Math.random() * 16) % 16 | 0\n        d = Math.floor(d / 16)\n        return (c == 'x' ? r : (r & 0x7 | 0x8)).toString(16)\n      })\n\n    return guid\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  //\n  //\n  /// ////////////////////////////////////////////////////////////////\n  constructor (container, title, options = {}) {\n    super(container,\n      ToolPanelBase.guid(),\n      title,\n      Object.assign(getDefaultOptions(), options))\n\n    this._dialogResult = 'CANCEL'\n\n    this._events = {}\n\n    this._isVisible = false\n    this._isMinimized = false\n\n    this._btnElement = options.buttonElement\n  }\n\n  /// //////////////////////////////////////////////////////////\n  //\n  //\n  /// //////////////////////////////////////////////////////////\n  htmlContent (id) {\n    return '<div></div>'\n  }\n\n  /// //////////////////////////////////////////////////////////\n  //\n  //\n  /// //////////////////////////////////////////////////////////\n  unload () {\n    this.setVisible(false)\n\n    $(this.container).remove()\n  }\n\n  /// //////////////////////////////////////////////////////////\n  //\n  //\n  /// //////////////////////////////////////////////////////////\n  isVisible () {\n    return this._isVisible\n  }\n\n  /// //////////////////////////////////////////////////////////\n  // setVisible override\n  //\n  /// //////////////////////////////////////////////////////////\n  setVisible (show = false) {\n    if (show !== this._isVisible) {\n      if (typeof this._events !== 'undefined') {\n        this.emit((show ? 'open' : 'close'), {\n          result: this._dialogResult\n        })\n      }\n    }\n\n    this._isVisible = show\n\n    if (this._btnElement) {\n      if (show) { this._btnElement.classList.add('active') } else { this._btnElement.classList.remove('active') }\n    }\n\n    super.setVisible(show)\n  }\n\n  /// //////////////////////////////////////////////////////////\n  // Toggles panel visibility\n  //\n  /// //////////////////////////////////////////////////////////\n  toggleVisibility () {\n    this.setVisible(!this._isVisible)\n  }\n\n  /// //////////////////////////////////////////////////////////\n  // initialize override\n  //\n  /// //////////////////////////////////////////////////////////\n  initialize () {\n    this.title = this.createTitleBar(\n      this.titleLabel || this.container.id)\n\n    $(this.container).append(this.title)\n\n    this.setTitle(\n      this.titleLabel || this.container.id,\n      this.options)\n\n    if (this.options.movable) {\n      this.initializeMoveHandlers(this.title)\n    }\n\n    if (this.options.closable) {\n      this.closer = this.createCloseButton()\n      $(this.title).append(this.closer)\n    }\n\n    var $content = $(this.htmlContent(\n      this.container.id))\n\n    this.content = $content[0]\n\n    $(this.container).append($content)\n\n    this.container.classList.add('toolPanelBase')\n  }\n\n  /// //////////////////////////////////////////////////////////\n  // createTitleBar override\n  //\n  /// //////////////////////////////////////////////////////////\n  createTitleBar (title) {\n    var titleBar = document.createElement('div')\n\n    titleBar.className = 'dockingPanelTitle'\n\n    this.titleTextId = ToolPanelBase.guid()\n\n    this.titleImgId = ToolPanelBase.guid()\n\n    var html = `\n      <img id=\"${this.titleImgId}\"></img>\n      <div id=\"${this.titleTextId}\" class=\"dockingPanelTitleText\">\n        ${title}\n      </div>\n    `\n\n    $(titleBar).append(html)\n\n    this.addEventListener(titleBar, 'click', (event) => {\n      if (!this.movedSinceLastClick) {\n        this.onTitleClick(event)\n      }\n\n      this.movedSinceLastClick = false\n    })\n\n    this.addEventListener(titleBar, 'dblclick', (event) => {\n      this.onTitleDoubleClick(event)\n    })\n\n    return titleBar\n  }\n\n  /// //////////////////////////////////////////////////////////\n  // setTitle override\n  //\n  /// //////////////////////////////////////////////////////////\n  setTitle (text, options) {\n    if (options && options.localizeTitle) {\n      $(`#${this.titleTextId}`).attr('data-i18n', text)\n\n      text = Autodesk.Viewing.i18n.translate(text)\n    } else {\n      $(`#${this.titleTextId}`).removeAttr('data-i18n')\n    }\n\n    $(`#${this.titleTextId}`).text(text)\n  }\n\n  /// //////////////////////////////////////////////////////////\n  // onTitleDoubleClick override\n  //\n  /// //////////////////////////////////////////////////////////\n  onTitleDoubleClick (event) {\n    this._isMinimized = !this._isMinimized\n\n    if (this._isMinimized) {\n      this._height = $(this.container).css('height')\n\n      $(this.container).css({\n        height: '32px',\n        'min-height': '32px'\n      })\n    } else {\n      $(this.container).css({\n        height: this._height,\n        'min-height': '100px'\n      })\n    }\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  //\n  //\n  /// ////////////////////////////////////////////////////////////////\n  on (event, fct) {\n    this._events[event] = this._events[event]\t|| []\n    this._events[event].push(fct)\n    return fct\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  //\n  //\n  /// ////////////////////////////////////////////////////////////////\n  off (event, fct) {\n    if (event in this._events === false) { return }\n\n    this._events[event].splice(\n      this._events[event].indexOf(fct), 1)\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  //\n  //\n  /// ////////////////////////////////////////////////////////////////\n  emit (event /* , args... */) {\n    if (this._events[event] === undefined) { return }\n\n    var handlers = this._events[event].slice()\n\n    for (var i = 0; i < handlers.length; ++i) {\n      var result = handlers[i].apply(this,\n        Array.prototype.slice.call(arguments, 1))\n\n      if (result !== undefined) { return result }\n    }\n\n    return undefined\n  }\n}\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../../node_modules/css-loader/dist/cjs.js??ref--5-1!../../../../../../../../node_modules/postcss-loader/src/index.js??ref--5-2!./ToolPanelBase.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// add the styles to the DOM\nvar update = require(\"!../../../../../../../../node_modules/style-loader/addStyles.js\")(content, {});\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../../../../../node_modules/css-loader/dist/cjs.js??ref--5-1!../../../../../../../../node_modules/postcss-loader/src/index.js??ref--5-2!./ToolPanelBase.css\", function() {\n\t\t\tvar newContent = require(\"!!../../../../../../../../node_modules/css-loader/dist/cjs.js??ref--5-1!../../../../../../../../node_modules/postcss-loader/src/index.js??ref--5-2!./ToolPanelBase.css\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"\\n\\n.dockingPanel .dockingPanelTitle img, .dockingPanel .dockingPanelTitle img:before {\\n    content: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAACXBIWXMAAAsTAAALEwEAmpwYAAAgAElEQVR4nO19ebxdRZXut1bV3vuce29ykxDCoEjje4oNNmqLgIDGMAREEoGQBJkEZWhRnia2KI2aTrd20wgq4oD4AGknSATCjAyCgKCor/XZKioiMwRChpt7z7CHWu+PqtrDuecmd4zvvWb9fsnZQ+WcqjV8a6ghwMv0Mr1ML9PL9F+VaJv90g0bdqs/sOw8aa17l0oHdwRFSOfsg3ivD0LCmUBzHUAKgIz8HZ2vRDrele6JgbhtoIIfIY4vxHt3u3XyBjN5tG0EsOrn/X33nXuNjv98WNJoQzIGTAaVbEK68zy0Dr4CwgGQDFrGdZIBACnx111XBCD5K/te7HfVeoGhTYMAL8JJu94xhaMcF20TAcx6339/H2t9eWwCxBkhTVIABIZBrfEUWm/6OOI3nwcMPY+C0WWGosTwzudls+gQjP/smwkMrL8Vwotw6m6tqRrneEhP9Q9sf9YefZwFx6IWAZubIJOCJIUxQAJCUJ+N8PE1SHY/ERLNBlobADgryAUhgFBxbUrXcNdeDsZUOyACNAYApechjfcDcO9Uj3ksNOUCANffQIyDKDNQDCRJBkUEQQYSQUoR6s2nETx1B+LXngZg03ANFsDh0PBrMcPxv9OCkgSo99WRJMfjv5oAaoqOJs1RFhuEgUYax0hNBkUAgQAwMiHUnrge8a6LAI6AtAGACiWvMLeESZ1+wDftFCAAimPAyCK5cu2nceoOz0/RcMdMUyqA1yx7wysSwVJySKECBVOPELfaSLMMRgAjKVKqI1z3KwQv/ATJTocA8VCOLJZK2mwEFYHkTbo5ZvtBAhASkNazJNtwigHOn6Ihj5mmVABMwbEB8yttQEIQAD21EExAux0jyzJkRiAcwrTWI3p8NZIdDgZIA5IOd7TDtF26Wgm5e/ICgIAygGo1SNJabG78+ZewcO/GFA591DRlAnjlsv3qBHOCjhSydpojCoFQj0KIyRCbDJkYQAQp9yB6/n7ojb9GOv11QOtFANwdYtCF8eJCOrEMBwB24SjBvYubIBW9PnhOFibA1VM19rHQlAmgP5QjiPF6YwyUIhCJVVixQuiJIqRJAsWELEtBQQ/QfA71p9Zg856fKkU9jjy8SCnycUTuHQEgERCJg53Sv4UASQLunRFK3DoaF//henz4te2pGv9oaUoEMHfFXD3Qbh7Dka7HzdRqPlMexhsBVKicJTQBQyAGOJqG8IU70Hj1acjUdCDZYJOpYc7WM7gIPznX9LJ1WIF4AZAAaGwGq/DIaar9xs3AT6di/GOhKRFAI2m8PtDqMEkNAiYYAxgIDArFFiHU6xGSJAYBSDIDQzXw5kdRX/8QBnc4CpCN1UimC7ZDHNSggCBvDR6qqCQkZAk46usxaB2L/18FoJQ6RoVqu7SVgggQBRhDMCTIAJAL3TlQCEMNkQzGCFiFQEroe/pqDM0+HKIiIG0BoELjYRnKVOC7x38rH7Fa79qRAEQAlaInSdoQkZN7vvzTixof2vcvGpJOugAOOf+Q/vbg5veSMQCTDTUBEAlYCAybyNoQVHKHzES2HU9HffDXqG/6GRrT9wVLC4DYSKZDCBVtz30ACl9QdtiuDQAgy0A6mCNxz4kALpxsHoyFJl0AWWtooQ54F7E5FthhfuZ0lGEFIgAMEUQrxAQIAyZJkekaJF6LmetuRGP6AQUzUWg7gArjgSrjUfpEqU0eMJkMVOsBkvg4XPTgV/DR/ZuTzYfR0uQKYAWYIO/VNU1pKwNKQmBjcd94rST3PNRIAg2YDIYBhkGmpqFv40OoDf0Wce2voJL1hTM2BuTDGylghqVUAxKHO/7atRUfBQhg4hZEBXuEmPbOGLhuUvkwBppUARwU7jNXg/aGMWAGSChXWMs/ByOG8qSWRFCvhTBZBiJCmmUQqkE1/owZm36EtfU9QPJSXvMhADDI4ahsBShfu+hHOt7ld2kK6plep8ENC7FixRqsXNlRxds2NHkCWLGCQ7lzUdin+9tDCZg7wnZjkZwAEFs2GAHEEERrtJTlMQhWEFLHzJduxoaZR8HwNOh0AAK2ddKSo82pE2ZGYnw5pG0NAayOCqa/+wsJVv5q0ngxBpo0ARymbnmNDoOjJTFgtlGLgcCQHS97BjPAxuYETPY9s0JPFKFhmmBS1klndUQDv0HfpgexceYCkGy2YSSArsW5HF2s1IWoS12oyAkAAdIYVOvtZxk6BsD/2wIIQnVYWNM7J80Miq12s1AOGQbiwlEHRwL48FLE1ojEZEizDEmSwagAMIT+dTdgQ9/hEApA0q7W4XJ+SuVB/qwzgcstoSS0OIZk5lRc/IeL8OHXDkwWP0ZLkyKAEz93aO8ghs4QIyAuYm/jHKQop/WQnPlC1iLY1YiCQKNWCxG3YxiTgQzBUB09g/8L0aaHkc3Y24WkVNV2R9IBQei0lg4YEm8JWQqC2iWKNx/fBi6dDH6MhSZFAEO8eb4i9ToBwEQQl3oqP1ABjLJ4D7LMkvyZDUFhgHoU2ckaMUjSFIb7ECZPY8aGm/Hc9LdCO4vy0YyAQJ6xeZ5VEoTL+Cr4D0BcUiZCADIg6oW0Bk7AxX+4clvXhyZFAFrx6TpSKmlmTsPJz1lBXBFOCQoIInJFueK9UTYsrTkoMlkGY1IY3Y8dkh9jU/M/kUavhjYbfezjtHq45leelSMhJyDplEjSBrHeO2xvOjwGbpgMnoyWJiyAY7+w/1uZaB+IhReIT/0dzIAc3DircP4BBOeoKS+ieaFFtRBxEttQnvrQmzz1B9188ret3r85Sscb/BejxPUqJFVgv/AFlbip7BvSGOjpr2FwwwKsuOcWrJyXTpQvo6UJC0AzHRn2BtslzcQyF0XoSX7qVgDjqqHCAuVqQWKcFbCFJwIAEjApBIGy9xoIpP2dgfoxq3Syfh5I9RcT70ViVcV3qWh7R2G76h+MbUutBoyhd4U9/bvFwB8nypfR0oQEcMLF+7ySNBbBCMhlnkoEQm7hQikSVM4ijBDEOWqjJI+CxIepsNlyPYoQc4w4SdqxnnYXnsWjsvPm29HXsxSNgeG4PiLMDM8J8k8p5gwoTaCi+o6m3VgI4KKJ8GUsNCEBKB2+I6ip3eN2ZmEHcPE3oBwg+D/GMV2RWzniJuWNQ3SBswSxkZHWCqIUkji5k+fM+CXOmZZm//rgtaZpjgHrACbdCr4DHTcF00uPqWQNlKVgkVOw4p7LsXLexonwZrQ0bgGsWDFXP470bIHFfAXLQGPgCm7Fmi/2TGar5Uo53niHTDZPyK1BgDBSiIeMUVrdfP85v7Pzt6bxA5NFP+Oob39JEoDERlaVyAfDIcZl4n5q0jfzP1YU+VIQaM+ari9oAd8aL2/GQuMWwFO7yNvY8JsI4kJPF/+zi3pQLGAwQmA/EcNieeJgil0bEuesXTsOGGFLP2okuzn/0fMOGcj+7eFriVr7gxhiMhQOoBz5eHjxDrjU8dLUJVB+J4DJIGGN0Nx8PCDfrtrK1NAEICg7PaoHQdzKbN0HXqsp77cLimyylWsnFTNYDo7ECSJXXGc8Yahv+sGnfvFM5We5tUpS+iR0NBNSDlacBblPz9hKsS6fKUNFKEX0JJAshXCwn1750NvTFfjR+PkzOhqXAE775gF7suG5RGKZ7zHd1XoENuIxEDC5dWzGfnp48krLbLXUsAtdBWDFSOJ0IwJ9ZedvZy/e/KzafskqsD6TELvvMa7YV4UZX7QrIKf80j6QUgglAkgSA1HfDGpsWoQVK+6f6irpuASgoY6N+vTOraEUTASoIpnywbwtF5MtN/jwE84iSqsJxUGP9RHi4AfIUtx60/If/2bYj19wgTGfPepbBHo/QBomK80RO3KMzyOcMsNz6xDfNBdWTkkbRLwolIO/HGPlH8bDo9HSmAWw/DtzZzcTc6QYKc15kHPEkkcyOZp4eHJzACQdbZxG2g+yFpRlqVZ01Uh9SGeH/xFsSG/h2rR3S3OwY2asgi35RcFzKTG90sgPBpK2gaBnZ2kNLcQUT1mOWQAxsgNVxH+bJbbqKXA47rhJkNy5GpTgyUUiplQmLsOTC4oQ1BTaDXnQNOsjr1g4c+8Gf+ahNUjiIwmkYLKu2G5vnZMB8hrUsIZeMHlfBMhSCMxJWHHPpVg5b3CsfBotjUkAi1ctVmivPSUIFSdZlkMqO29rmUmF8wUKeALy6UmfK9iStYUei90EyQQEXr36E3dt2lJf2jq4vtZqLaN6z15oN0bWdgB5GaLb/ACcYNxt3iRLIUJ7qozengFTtrtmTALYIXn+zQp0qJ+X7UzxLTOLUFz8LBi5tTtO+X0tyFdLRazTDiJG3Eof1QY3brUzn9h7E/3TT9cgTfaya19MwUTnWLvCjORiyUvS5eQ4b2tSIKwr02ycApHbQFMTko5JAErTiUHAPWlcFYDAMh5Sqv+4mD6flnTw5PMFD112itL9WyIQyQ///SMPPjma/kioLpek9UHS0XaQzD4TuOzYJx7IvXO5jA0R+Hn8Ydbhn5oMIHMQzr1rbwA/GwuvRkujFsBHr3nbbkbocMVARsjnfG1Sg2KSxW/x8o7V88FpumcIASBVrBdlRcjitEVZ8LXR9qn1ib2frH3mwRuF1anejxTaXpiAj3x82SKftkTRtHyRW1LcBmrTtkNzcDH+0gIA+F1hjV+TJSafxSr/yQVR8BjO/1ZuCK4W5K2CLCN0wJDU/PDwOXN+PWL404Uky74nlJ0MIlVW6QJmSnAjJRZXFL7sA6TyHGkKQBbivNsvwWcPf2oMXRsVjUoAH1/15n5DWKwCQpoAnnHktNv48nzO2GpCJP7GQ47q8BHOapjxjSVLVmdjGUDbBD8Nk/bdqPXOR2swZ7C41QBeQexjb5YFRJVD5uqN+4dJCwhquyPJ5gO4fCx9Gw2NSgDG9B6gazggi00xoeIcJ7yDhctmUeA+lcZrHGwZFM/h7oNIodlIHqZMPTDmEazcb8B8+r41lMaHCohgvDP2eI8qxOQO170vIVa1TckzGwPE9H68957v4Kp5k7rLcjQCIFI4WYVKmZaNt1XJwXphAHAFN8kdsC/GEVzRjYr6kEMgMOySFSZz7dfPfGDdeAaRRsF1qtX6MKLe3aU9VH1ZYmbXaKf8otKo/AMpwHgLtm+/A8Dt4+njSLRVAZx33bxXp2IOzcu6jjyqUInR4t74FWs+58rHa4qv8ALSEaPdTJ8IlFo97lGc99a15rz7bqMs293Gurn3gbcCyf9CB8yUvVjpfcUKMiCoabTTk7GtBQBt3hMqmmUyyZ1vqWv5JIt3vlKCJysEB08AoIptvN6SmAia5K5LTnrgzxMZiGh8jeLm6dBBLzJT5AIjJF/D8wOpflbaOIfF+kAsv/11+Pzhj0ykr2XaogCWXbPfLBgsDuqMdjOzAvAKBuRmUAlHXRsy/oQBD0+WIcT5NCyYCWk7axpjJmE9zt2PCh28BqxOkDTpou1SvS5fDhNMl/ukBdT6dkFz4DgA/zjx/lqiLb0875a5p4aaL81SCU2WB3D2szThnj8rWbMffw5PHQMTAVTIiBvmjmeD+45YvQRjin660rn3HgqlfgARyk3NRwOd0U2OOu5drj3S8aUlQQQ1UNz83xLxfPzrIWsn3F9swQJW3DO3ZobMUUFNh8lAWqlaAshPE8iTMP+8LNIu8GSnEK0lKEVQWq6YFOYDQCv8BcLmT1Hr2w9tvwu1rCEd93mlX4oDQTqtww9LBBS3wEF9L4oH5ybAqsno8sgQ1MQbFauDk6ad8QJKe6Sl5LKocMjGxfoC54BLQssVzK1+CCKFuG1+aTTum4yBAAC+sP96fOyuNTDZvjYW6MJ8TyOUravP7OyaT+4ZAjIZJOPTsOKe6yZj/dCIAhCRpWGP7o2bqV1yImJXNPi6iikmOvyEiq1+onp8QykzzgWnAB0ASWzWfHHR/c9NdBAVUtFqxK0PIKztirhZFUCeGXZ7WDyya1uLLVHsMVUAogwkZp4eaP9tCjw80e52FcCK2+b+lRgcb1K/tqFY7p2XevKJlgJ1PNRSKSGDlFbCubEGkULcSJ+p8eSYcYXOf9tjOOfuW2DMWQWme4fkGw23hGLHpRuPKcZaEViWgoK6VsnQ2Slw0kS7290CBMeGkZpjMsmDebLizzU73yzXOQNW8ll+xozLfGA/Syb3feaY+3830QF0pcx8E6b9XijVWznyoCu+C1gKGC1PZfo25f3IBLF7koXmhh+85bWbv/KuCU1ZDhPAxbceHm2kxruDkNBqGIflfh2/FMW1ErZ4YZgSo8vwxMijURAxklaaBcRfnUjHt0gXPfALLD/whwiiBciSYa/L+42txgvK1f7ckkuMZxS77ylpg8LeXaQ5tBjAZyfS1WEC2Kzi+YrVm7PE5JBhewXnC7xF+jlhqsCTL7yNBE86JJiMHtTJnAnj58i00gB3fwtGFhSp+nCY6artOSS58glKZ03AC88ARiCEBX1n3Pj1wcsWjquEAnQIYMU9c3XWTo/pmxbVG5uSXNErvos8KhWpvo1waNgAhk3Qu79E5NKVS1bH4+30qChp3wsyDyOs70Nxo9BebBlmurZByWrcNSVNMKt9jTL7ArhlvN2sCEAZ3jOIsDBupMNSNL/rxU+8lNjvOm9HIuQ3UTjTdg0NbN0nbqa/zyKavNBzJLrkiBfx0duvU8bsQ2JXoeYLtnKNcqUSsQxnKqDTNhGQi6U94+0mQQBiQDoAcfoBLF51O1YvGVcuUxEAZ3JkUNezWoNpZz5VJGLeIirwRAVcleCpvJGCCdAhI47lxguOuPfp8XR2zMTJddweOovCnlchaRXBQykwYilpe8l3Fc65YyljmUwGGHPQ9tv3/M2LwC/H08VcAOff+eb+VMxpaWwKDXFUrmDCd9S9KGfznfCUd5oIOmAkQ8k6zjD+qudY6XML/kgfuf0+ACeWjy0oQ0yO7e51BWby51Xm+7ZsUlBQq1PSPgPAWePpYi6AlPqOVkyvEmMKDc87VfphlLSfiueVsopXfPJ7uASsBKZN9//zwh/9fDwdHS9lkKt0e3ApURjA2JV8ZXzPYUas1XqLGKaFjuyufNfWwB3DI/N3OuPGVz132cJRLSYokwYAkRX82bvuPSXo0dx2+J+bomdm/leh/fmjTniC9wEAiKAUIWlLSiL/s+uoppCy/s336Q29Dyqt5to9BdXd9YySNZhy16RiFR77fQTlt1xJ0gKCnv+WpEPHAvj8WPtHAPCpWw49oB4lN+qQZyVx57mbXS5lxCbD2osAQaiQNLOfmB6Zt3Lej7b5wak9H7rtFA6iK5HF8GVczuN7dIcY99yXWKoncJUX/Aoo7AWaQw8GEi54+vLD14+lbxoA2jD7zuzjWUnDDDe8Ttx3z8p9rjjsEjzZ/QJ2sa3E8u9/CeYDgCTBnSLN33NY252Sdo7xRb2koLz+UxqvX/ZeaQfkFsFxA6SD/SVp7ocxrqLTABBxOj2KNOJGCUZkBEG4Hyaq3HaHJ3Kr3ZrpnyKV/WAsHZtMan79kGemnXXTNYrUp23HfJpeMLKIdro73wKOisyZ8msBa4YQ3gPIbeVYamukAeA/n5394uwZ60RroThh+8U0XEHyyw4HvSWnrTUjbpnrz53/wGOj7dRUEIOuR2voTArCHSSNq/hewnZ00fbC+n35ohCW/xpjEogxC3Z8/9Wve/5yjLrGpQHg1p+87vY9d/rJk6/eubXr8+u4qNugpOmlHyuF/x0dLCBIYLG/OZi+xMLbLvQcgTZ99chfzjjrhnsJ0VJ/ymKeeInkJXegjPWoHo/mLV+qMZKI2FO4glo/Z3wygHNH26/8t/76n07/0tIDnzx71+kbsKkRInPTWN0cb3k18TDygiIgCBntRmvVuYc9vHS0HZpK6l9068Fqe3Ob0iqgLOvqfH0GDyBPxPw14AOL7lEIBRFM0vxtwvVD1n3jnaOa58jzgN89vOeFXxzoXXrQHi/M2euVz2N6lIBY8g5Yz+/S8lwAZDuTK0+ReDEDqt2MB6n3Wqwx016lvzf6ZZD9ALa4OH3sNH07CgfXxk8P3Kr+TIZfK1LN9r2yFcdfVrPf3PJHYD4gMGkMomCPIGsfCeAbo+lXteJzxrmfRC3655nRAGb0AlEkCCOAlAIpBisFYgWlGcwMoxhCDFEMKAYx2eVvTFCKYYyka7HzT1IVNmrUVgYMVgQDgiLYiWACFBjC1a6Y6m2F1GhGlvPFMEBa1YPpakZy3fpLg6GsUb+QonbOVbtozDlTz5iS9W+N8WXd46AHWdy4MyFa9NIVR23eWvcqWjlrxuA3m1l84kDWs/vm9QIOAlCooQINpTQoUGCtoLWGUgwJNIxSMEqBNYMU203ATPZTKV2r04F1nQJcgyJ2S9DttlU/18CuhlEeIo0gAIH9+i3Ip/gOrUFhgPSlDQOS4l+EcHX7cRK9ffw/mINXSRIX8wFmOK53z29GgF8nIJM0AeJ3aJO+BcAPt9bHigDWX3DJ073Ll19Wi9ILlE5VoDJwoMBa20+lQFpBaQWlFIgYohQypQCyVgFSLoRiMBjSImRK2UdEMGznK8UV8IxjPKFw/gAq152UwS2DHJEI3FND1mgmGGx8WyS98I/vWPRb/807nH7DaqV6PypJu1i/Cr8wYnSaXryvwhSMAQW1ACY9CWMVAABwGF6VNOOTqR69wRgDEoFxEYARgDNB5ra2KLcamkSKQzogsFvmBRnb7UowgKjCoeXOzkUhhgBdLm1shfx2127VGgoCQGtIkvwcWfL5Px68+HsdLYRozY1obn4/q2CGZEnVseYprv9y+3z4cqGivXS2zxKIwZGzT7npNeu+uWCLB3901aNo+fIPKOavaq0QKAZpBQ4Cq/VKgQMF5X2CUjBaQZS1BlbsIIhB7ODI+QZrBVxgiEs2LAwBIC4YSlsWBqFqBaQUKAphGq1NEPkam/Ylv59//LPd//UK3um0N93MQc87JSmdYl9meHFZei/dmhYX5ficNSRpf2bttxZ/agvDGAFKzzijp9bTc3dQr+0XABZ2ggCsywKwzGalIFpZh+wF4IRADpqIAVEF/osTBmD3BhhX11ZElTMmRhKCV1Lt3lMtAtIMkqV3KKZ/fOQdxzy0pUEDwI7vv+EYJqwGMcP4uZRRwsxIjM/fCyioQ+LGr6bN6H37o5ccMeJZdN1Dw8sua5hlyy7IkuT7KtCsjLEwlAmIDUTY3tvjr1BsCDMQMMgIxC2XIHJnknkYEoGf2/Qb+gj2+LAt4X6ZcotXChwGkHb8mEnkQqRPX/HIER8e1ZFjfc88fsvQK3Z5hDnYw0haxTMv4dEy3sNQGafSGKSC3YfWDSwA8J2tjWU4nX12VGO+Npw27V3apOAgACsbBXGg3TXnsGQUwygF0i4kVQxidmGpC1GJrRBcNOQhiMidnOUcs6/WE0YIR4ms1rfaqVJ0ZRpnn3ts/rFjPmRpp/ddfzYF9S9JUjq5uMz0bmFQF23Pu9XRnsNeSGPzdb2znz/+0Uu6K8bIydEll7Rl+fKLs2brYFULa8gMoNiGZ2KsxrpEjPwfuBOqXCVPfJoP5AmbL3yJK5eSn2B2e8WoNOGcK2KpWxSGgFYwjeYvQObf/jT32O+PdwspG317lrSeY9Y7iVu+UlXyTm67yy7Tk1Rqn9eUkjZEqUPXv7j9GzHCUflbzE7bn//8nWrZsusN0XtYBMZkUEyQzKZCRhmwsSpMys1+icMaIxC3vE+MATvhefZ79rocCAy7+9IPoMIIAsAMjiJIHL9gmo0rCPoLjx22+IUt9X9r9MyuR/5pxydW34xw5umSJp2JQOW+6E+V+fkkfkd7u2k9BevatEDSpRhBAFtF3Z5lH3oDU/DjsKenl8mGeezzAK3AAUM7GBKXlInikjP2WTJbrFEW+Jlc1uyioQKGACYuVhE6uMnabQHRTZKk//L4YYsn7T9emHPKNYcy11YTUb9kyRYhBijDjHTcl1Y+oihjEGtIGr9Amt/y3LeWDJuyHJXb612+/NKgr+dMZQxYWwHkf0oRUVkApG35wloHQ1jZvcWuVGEPeWK3Q5LcckXriO1/9GazaQoDmHb7sSzLzn98o1yFJUsmfT3RnJNW/1DVeudJbH1BN22vrJxzhaOyaPIIdBg82bWYGZKPvfjtpcMO/hhVgYyIvmTa8btVFO0oYmx5xVi4McLOBxiQuxbYSIlctmVjoyIasgGSzT3FhUK+3g4hCBM4qsG025I2WpeKUhc/Pv+Y34+mr+MhJv6mxK25UglJ3dhdt4oVHsiZ37FRaHjUBABiwDoExa0l2y1c8/WXbqzWh0YZ+IF6ly1bGU2f9ikWY/MCpUCuROGTMvYwpG2BzhfxchgitnuEXTJGTABcnuDqQxJFtjxg0odSIxf9+ZBjr0O1TDTpNOuEW6drbvySdbCbZMkwmHHHGFWLc0AeYJRJOi0FgNsYHUOy45//3nHXltuPVgCoLV++SxQEdwb12u4Ek4eipBRUoMHKhqSiFES7kNSFo2AFKCqyYAdNTICwrRNBM1RPHWmz9SwRfSXdPPDVJ44+dZucXAgAO5y4+uMc9Z0vsT2Zxmu+/8ghBuhSlxiB8SWj4agXaXvzVWunDZyOy85MirZjoP5zzvmICvUXlMsBoDUUK3CoQUy5MzaBLU+QUjbeVwqkHLSwspkw20SMWQFhCKQJROQmYlr5p8OW/GIs/ZoM2uHk1Xsy9D0EbC/GbnzpPKus8zCozv/qjDpCbYBKVqCRETYYMQe9+N0l+Sq6MZ2Wwhs3Ximz+k+RIHiDMQC7UFOMsZXR0voacu/AAImBEZXvJ4PzIxQGYK1h4uRxmOzTTTNw7XMLz/yL/BeDa5vyyI5hfD3X+s8w7c1uR/9wiAFK2u4Z3SkEeDkURUqRFBz0zFTJ4LtRWsY4JgsAgOl///fHBz21bzMzkcuMlVYgFw0ppQDFMFrlMOTDUGKC+MmdnjpMmjbIyPwjHi8AAAH9SURBVBXM8sVHj3jPn8bal8mmOSdcu5BIVhFxBFPd/tUVYoAKzPgc3uWfwxwXc4Asaz9dU9P3evK7R24AxnFkWUB0k0mSO3la33xJU8C4BMsIDAmY3eR1BoANRAB2Z9gIMVhrUKBhGs07UshXnjrqpK0fzrSNiGjobjHBzzjsPVBMOqz0AwyHGSryehgUmy19/ljWcEEGZv2KWAaXAPg6MA4LAID+j33sKF2PVnEYBExknXHAuQWwnQ1D5srUFGhwPbL/OMseMYq/FNToO48ecdI2/x8rtkY7HHfNB0nrL9sDwM0whwoUFrAlbR+JsRTUYdqDD75dgrevXr0kG5cAIEKzPnnud9W06cdRmkL5OQPFUFrl0ZGEAdBTt+UJyG+E6bt1HV/5yKK/m9ydkZNIs4++didVT39OHOwMkwxjfHnuxXRwfVTTpKwB0CCb9Lhnrl56y/gEAGDWinNeSZm+Wk+ffgCTWIxXCipQ0K5MnKWpmCi8y0BuJcY1T570fy/jy7Tj8Vefz+G0j0tiV1LmSSKownjPvLExUUDRdGSN9d9fe81xi8d9dPH6lRc8Pfsf/mGxabc/CGABK9oegUZquEFKPwHgHqPoAdXCfzxx5t9N8iKTqSVO+GrB4EKYbDaAtJz1VqYsS4/GRK0NLMj+eoLdfJleppfpZZoo/R/hzTwX+JPbMQAAAABJRU5ErkJggg==');\\n}\\n\\n.toolPanelBase .dockingPanelClose {\\n    position: absolute;\\n    top: -3px;\\n}\\n\\n.toolPanelBase .dockingPanelTitle {\\n    padding: 4px 10px 4px 10px;\\n    text-transform: none;\\n}\\n\\n.dockingPanel .dockingPanelTitle .dockingPanelTitleText {\\n    margin-top: 4px;\\n    text-transform: none;\\n}\\n\\n.dockingPanel .dockingPanelTitle img, .dockingPanel .dockingPanelTitle img:before {\\n    float: left;\\n    width: 24px;\\n    height: 24px;\\n    margin-right: 10px;\\n}\\n\\n\", \"\"]);\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js??ref--5-1!../../../../../../../node_modules/postcss-loader/src/index.js??ref--5-2!./Viewing.Extension.Particle.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// add the styles to the DOM\nvar update = require(\"!../../../../../../../node_modules/style-loader/addStyles.js\")(content, {});\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js??ref--5-1!../../../../../../../node_modules/postcss-loader/src/index.js??ref--5-2!./Viewing.Extension.Particle.css\", function() {\n\t\t\tvar newContent = require(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js??ref--5-1!../../../../../../../node_modules/postcss-loader/src/index.js??ref--5-2!./Viewing.Extension.Particle.css\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \".particle{\\n    top: 10px;\\n    right: 10px;\\n    width: 265px;\\n    height: 320px;\\n    resize: auto;\\n}\\n\\n.particle .container {\\n    width: 100%;\\n    padding: 0;\\n}\\n\\n.particle .btn {\\n    height: 6px;\\n    line-height: 0;\\n    vertical-align: top;\\n}\\n\\n.particle .btn-span {\\n    margin-right: 0px;\\n    line-height: 0.3;\\n    top: 1px;\\n}\\n\\n.particle .dg.main {\\n    width: 100%\\n}\\n\\n.particle .dg.main.taller-than-window .close-button {\\n    border-top: 1px solid #ddd;\\n}\\n\\n.particle .dg.main .close-button {\\n    background-color: #ccc;\\n    display: none;\\n}\\n\\n.particle .dg.main .close-button:hover {\\n    background-color: #ddd;\\n}\\n\\n.particle .dg {\\n    color: #555;\\n    text-shadow: none !important;\\n}\\n\\n.particle .dg.main::-webkit-scrollbar {\\n    background: #fafafa;\\n}\\n\\n.particle .dg.main::-webkit-scrollbar-thumb {\\n    background: #bbb;\\n}\\n\\n.particle .dg li:not(.folder) {\\n    background: #fafafa;\\n    border-bottom: 1px solid #ddd;\\n}\\n\\n.particle .dg li.save-row .button {\\n    text-shadow: none !important;\\n}\\n\\n.particle .dg li.title {\\n    background: #e8e8e8 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;\\n}\\n\\n.particle .dg .cr.function:hover, .dg .cr.boolean:hover {\\n    background: #fff;\\n}\\n\\n.particle .dg .c input[type=text] {\\n    background: #e9e9e9;\\n    border: 0;\\n    margin-top: 0px;\\n    padding: 0px;\\n    float: right;\\n}\\n\\n.particle .dg .c input[type=text]:hover {\\n    background: #eee;\\n}\\n\\n.particle .dg .c input[type=text]:focus {\\n    background: #eee;\\n    color: #555;\\n}\\n\\n.particle .dg .c .slider {\\n    background: #e9e9e9;\\n    height: 28px;\\n    margin-top: 0px;\\n}\\n\\n.particle .dg .c .slider:hover {\\n    background: #eee;\\n}\\n\\n.particle .dg .c {\\n  background: #e9e9e9;\\n}\\n\", \"\"]);\n","/*!\n * FPSMeter 0.3.1 - 9th May 2013\n * https://github.com/Darsain/fpsmeter\n *\n * Licensed under the MIT license.\n * http://opensource.org/licenses/MIT\n */\n;(function (w, undefined) {\n  'use strict'\n\n  /**\n\t * Create a new element.\n\t *\n\t * @param  {String} name Element type name.\n\t *\n\t * @return {Element}\n\t */\n  function newEl (name) {\n    return document.createElement(name)\n  }\n\n  /**\n\t * Apply theme CSS properties to element.\n\t *\n\t * @param  {Element} element DOM element.\n\t * @param  {Object}  theme   Theme object.\n\t *\n\t * @return {Element}\n\t */\n  function applyTheme (element, theme) {\n    for (var name in theme) {\n      try {\n        element.style[name] = theme[name]\n      } catch (e) {}\n    }\n    return element\n  }\n\n  /**\n\t * Return type of the value.\n\t *\n\t * @param  {Mixed} value\n\t *\n\t * @return {String}\n\t */\n  function type (value) {\n    if (value == null) {\n      return String(value)\n    }\n\n    if (typeof value === 'object' || typeof value === 'function') {\n      return Object.prototype.toString.call(value).match(/\\s([a-z]+)/i)[1].toLowerCase() || 'object'\n    }\n\n    return typeof value\n  }\n\n  /**\n\t * Check whether the value is in an array.\n\t *\n\t * @param  {Mixed} value\n\t * @param  {Array} array\n\t *\n\t * @return {Integer} Array index or -1 when not found.\n\t */\n  function inArray (value, array) {\n    if (type(array) !== 'array') {\n      return -1\n    }\n    if (array.indexOf) {\n      return array.indexOf(value)\n    }\n    for (var i = 0, l = array.length; i < l; i++) {\n      if (array[i] === value) {\n        return i\n      }\n    }\n    return -1\n  }\n\n  /**\n\t * Poor man's deep object extend.\n\t *\n\t * Example:\n\t *   extend({}, defaults, options);\n\t *\n\t * @return {Void}\n\t */\n  function extend () {\n    var args = arguments\n    for (var key in args[1]) {\n      if (args[1].hasOwnProperty(key)) {\n        switch (type(args[1][key])) {\n          case 'object':\n            args[0][key] = extend({}, args[0][key], args[1][key])\n            break\n\n          case 'array':\n            args[0][key] = args[1][key].slice(0)\n            break\n\n          default:\n            args[0][key] = args[1][key]\n        }\n      }\n    }\n    return args.length > 2\n      ? extend.apply(null, [args[0]].concat(Array.prototype.slice.call(args, 2)))\n      : args[0]\n  }\n\n  /**\n\t * Convert HSL color to HEX string.\n\t *\n\t * @param  {Array} hsl Array with [hue, saturation, lightness].\n\t *\n\t * @return {Array} Array with [red, green, blue].\n\t */\n  function hslToHex (h, s, l) {\n    var r, g, b\n    var v, min, sv, sextant, fract, vsf\n\n    if (l <= 0.5) {\n      v = l * (1 + s)\n    } else {\n      v = l + s - l * s\n    }\n\n    if (v === 0) {\n      return '#000'\n    } else {\n      min = 2 * l - v\n      sv = (v - min) / v\n      h = 6 * h\n      sextant = Math.floor(h)\n      fract = h - sextant\n      vsf = v * sv * fract\n      if (sextant === 0 || sextant === 6) {\n        r = v\n        g = min + vsf\n        b = min\n      } else if (sextant === 1) {\n        r = v - vsf\n        g = v\n        b = min\n      } else if (sextant === 2) {\n        r = min\n        g = v\n        b = min + vsf\n      } else if (sextant === 3) {\n        r = min\n        g = v - vsf\n        b = v\n      } else if (sextant === 4) {\n        r = min + vsf\n        g = min\n        b = v\n      } else {\n        r = v\n        g = min\n        b = v - vsf\n      }\n      return '#' + componentToHex(r) + componentToHex(g) + componentToHex(b)\n    }\n  }\n\n  /**\n\t * Helper function for hslToHex.\n\t */\n  function componentToHex (c) {\n    c = Math.round(c * 255).toString(16)\n    return c.length === 1 ? '0' + c : c\n  }\n\n  /**\n\t * Manage element event listeners.\n\t *\n\t * @param  {Node}     element\n\t * @param  {Event}    eventName\n\t * @param  {Function} handler\n\t * @param  {Bool}     remove\n\t *\n\t * @return {Void}\n\t */\n  function listener (element, eventName, handler, remove) {\n    if (element.addEventListener) {\n      element[remove ? 'removeEventListener' : 'addEventListener'](eventName, handler, false)\n    } else if (element.attachEvent) {\n      element[remove ? 'detachEvent' : 'attachEvent']('on' + eventName, handler)\n    }\n  }\n\n  // Preferred timing funtion\n  var getTime;\n  (function () {\n    var perf = w.performance\n    if (perf && (perf.now || perf.webkitNow)) {\n      var perfNow = perf.now ? 'now' : 'webkitNow'\n      getTime = perf[perfNow].bind(perf)\n    } else {\n      getTime = function () {\n        return +new Date()\n      }\n    }\n  }())\n\n  // Local WindowAnimationTiming interface polyfill\n  var cAF = w.cancelAnimationFrame || w.cancelRequestAnimationFrame\n  var rAF = w.requestAnimationFrame;\n  (function () {\n    var vendors = ['moz', 'webkit', 'o']\n    var lastTime = 0\n\n    // For a more accurate WindowAnimationTiming interface implementation, ditch the native\n    // requestAnimationFrame when cancelAnimationFrame is not present (older versions of Firefox)\n    for (var i = 0, l = vendors.length; i < l && !cAF; ++i) {\n      cAF = w[vendors[i] + 'CancelAnimationFrame'] || w[vendors[i] + 'CancelRequestAnimationFrame']\n      rAF = cAF && w[vendors[i] + 'RequestAnimationFrame']\n    }\n\n    if (!cAF) {\n      rAF = function (callback) {\n        var currTime = getTime()\n        var timeToCall = Math.max(0, 16 - (currTime - lastTime))\n        lastTime = currTime + timeToCall\n        return w.setTimeout(function () { callback(currTime + timeToCall) }, timeToCall)\n      }\n\n      cAF = function (id) {\n        clearTimeout(id)\n      }\n    }\n  }())\n\n  // Property name for assigning element text content\n  var textProp = type(document.createElement('div').textContent) === 'string' ? 'textContent' : 'innerText'\n\n  /**\n\t * FPSMeter class.\n\t *\n\t * @param {Element} anchor  Element to append the meter to. Default is document.body.\n\t * @param {Object}  options Object with options.\n\t */\n  function FPSMeter (anchor, options) {\n    // Optional arguments\n    if (type(anchor) === 'object' && anchor.nodeType === undefined) {\n      options = anchor\n      anchor = document.body\n    }\n    if (!anchor) {\n      anchor = document.body\n    }\n\n    // Private properties\n    var self = this\n    var o = extend({}, FPSMeter.defaults, options || {})\n\n    var el = {}\n    var cols = []\n    var theme, heatmaps\n    var heatDepth = 100\n    var heating = []\n\n    var thisFrameTime = 0\n    var frameTime = o.threshold\n    var frameStart = 0\n    var lastLoop = getTime() - frameTime\n    var time\n\n    var fpsHistory = []\n    var durationHistory = []\n\n    var frameID, renderID\n    var showFps = o.show === 'fps'\n    var graphHeight, count, i, j\n\n    // Exposed properties\n    self.options = o\n    self.fps = 0\n    self.duration = 0\n    self.isPaused = 0\n\n    /**\n\t\t * Tick start for measuring the actual rendering duration.\n\t\t *\n\t\t * @return {Void}\n\t\t */\n    self.tickStart = function () {\n      frameStart = getTime()\n    }\n\n    /**\n\t\t * FPS tick.\n\t\t *\n\t\t * @return {Void}\n\t\t */\n    self.tick = function () {\n      time = getTime()\n      thisFrameTime = time - lastLoop\n      frameTime += (thisFrameTime - frameTime) / o.smoothing\n      self.fps = 1000 / frameTime\n      self.duration = frameStart < lastLoop ? frameTime : time - frameStart\n      lastLoop = time\n    }\n\n    /**\n\t\t * Pause display rendering.\n\t\t *\n\t\t * @return {Object} FPSMeter instance.\n\t\t */\n    self.pause = function () {\n      if (frameID) {\n        self.isPaused = 1\n        clearTimeout(frameID)\n        cAF(frameID)\n        cAF(renderID)\n        frameID = renderID = 0\n      }\n      return self\n    }\n\n    /**\n\t\t * Resume display rendering.\n\t\t *\n\t\t * @return {Object} FPSMeter instance.\n\t\t */\n    self.resume = function () {\n      if (!frameID) {\n        self.isPaused = 0\n        requestRender()\n      }\n      return self\n    }\n\n    /**\n\t\t * Update options.\n\t\t *\n\t\t * @param {String} name  Option name.\n\t\t * @param {Mixed}  value New value.\n\t\t *\n\t\t * @return {Object} FPSMeter instance.\n\t\t */\n    self.set = function (name, value) {\n      o[name] = value\n      showFps = o.show === 'fps'\n\n      // Rebuild or reposition elements when specific option has been updated\n      if (inArray(name, rebuilders) !== -1) {\n        createMeter()\n      }\n      if (inArray(name, repositioners) !== -1) {\n        positionMeter()\n      }\n      return self\n    }\n\n    /**\n\t\t * Change meter into rendering duration mode.\n\t\t *\n\t\t * @return {Object} FPSMeter instance.\n\t\t */\n    self.showDuration = function () {\n      self.set('show', 'ms')\n      return self\n    }\n\n    /**\n\t\t * Change meter into FPS mode.\n\t\t *\n\t\t * @return {Object} FPSMeter instance.\n\t\t */\n    self.showFps = function () {\n      self.set('show', 'fps')\n      return self\n    }\n\n    /**\n\t\t * Toggles between show: 'fps' and show: 'duration'.\n\t\t *\n\t\t * @return {Object} FPSMeter instance.\n\t\t */\n    self.toggle = function () {\n      self.set('show', showFps ? 'ms' : 'fps')\n      return self\n    }\n\n    /**\n\t\t * Hide the FPSMeter. Also pauses the rendering.\n\t\t *\n\t\t * @return {Object} FPSMeter instance.\n\t\t */\n    self.hide = function () {\n      self.pause()\n      el.container.style.display = 'none'\n      return self\n    }\n\n    /**\n\t\t * Show the FPSMeter. Also resumes the rendering.\n\t\t *\n\t\t * @return {Object} FPSMeter instance.\n\t\t */\n    self.show = function () {\n      self.resume()\n      el.container.style.display = 'block'\n      return self\n    }\n\n    /**\n\t\t * Check the current FPS and save it in history.\n\t\t *\n\t\t * @return {Void}\n\t\t */\n    function historyTick () {\n      for (i = o.history; i--;) {\n        fpsHistory[i] = i === 0 ? self.fps : fpsHistory[i - 1]\n        durationHistory[i] = i === 0 ? self.duration : durationHistory[i - 1]\n      }\n    }\n\n    /**\n\t\t * Returns heat hex color based on values passed.\n\t\t *\n\t\t * @param  {Integer} heatmap\n\t\t * @param  {Integer} value\n\t\t * @param  {Integer} min\n\t\t * @param  {Integer} max\n\t\t *\n\t\t * @return {Integer}\n\t\t */\n    function getHeat (heatmap, value, min, max) {\n      return heatmaps[0 | heatmap][Math.round(Math.min((value - min) / (max - min) * heatDepth, heatDepth))]\n    }\n\n    /**\n\t\t * Update counter number and legend.\n\t\t *\n\t\t * @return {Void}\n\t\t */\n    function updateCounter () {\n      // Update legend only when changed\n      if (el.legend.fps !== showFps) {\n        el.legend.fps = showFps\n        el.legend[textProp] = showFps ? o.legend[0] : o.legend[1] // ADN modif\n      }\n      // Update counter with a nicely formated & readable number\n      count = showFps ? self.fps : self.duration\n      el.count[textProp] = count.toFixed(count > 99 ? 0 : o.decimals)\n    }\n\n    /**\n\t\t * Render current FPS state.\n\t\t *\n\t\t * @return {Void}\n\t\t */\n    function render () {\n      time = getTime()\n      // If renderer stopped reporting, do a simulated drop to 0 fps\n      if (lastLoop < time - o.threshold) {\n        self.fps -= self.fps / Math.max(1, o.smoothing * 60 / o.interval)\n        self.duration = 1000 / self.fps\n      }\n\n      historyTick()\n      updateCounter()\n\n      // Apply heat to elements\n      if (o.heat) {\n        if (heating.length) {\n          for (i = heating.length; i--;) {\n            heating[i].el.style[theme[heating[i].name].heatOn] = showFps\n              ? getHeat(theme[heating[i].name].heatmap, self.fps, 0, o.maxFps)\n              : getHeat(theme[heating[i].name].heatmap, self.duration, o.threshold, 0)\n          }\n        }\n\n        if (el.graph && theme.column.heatOn) {\n          for (i = cols.length; i--;) {\n            cols[i].style[theme.column.heatOn] = showFps\n              ? getHeat(theme.column.heatmap, fpsHistory[i], 0, o.maxFps)\n              : getHeat(theme.column.heatmap, durationHistory[i], o.threshold, 0)\n          }\n        }\n      }\n\n      // Update graph columns height\n      if (el.graph) {\n        for (j = 0; j < o.history; j++) {\n          cols[j].style.height = (showFps\n            ? (fpsHistory[j] ? Math.round(graphHeight / o.maxFps * Math.min(fpsHistory[j], o.maxFps)) : 0)\n            : (durationHistory[j] ? Math.round(graphHeight / o.threshold * Math.min(durationHistory[j], o.threshold)) : 0)\n          ) + 'px'\n        }\n      }\n    }\n\n    /**\n\t\t * Request rendering loop.\n\t\t *\n\t\t * @return {Int} Animation frame index.\n\t\t */\n    function requestRender () {\n      if (o.interval < 20) {\n        frameID = rAF(requestRender)\n        render()\n      } else {\n        frameID = setTimeout(requestRender, o.interval)\n        renderID = rAF(render)\n      }\n    }\n\n    /**\n\t\t * Meter events handler.\n\t\t *\n\t\t * @return {Void}\n\t\t */\n    function eventHandler (event) {\n      event = event || window.event\n      if (event.preventDefault) {\n        event.preventDefault()\n        event.stopPropagation()\n      } else {\n        event.returnValue = false\n        event.cancelBubble = true\n      }\n      self.toggle()\n    }\n\n    /**\n\t\t * Destroys the current FPSMeter instance.\n\t\t *\n\t\t * @return {Void}\n\t\t */\n    self.destroy = function () {\n      // Stop rendering\n      self.pause()\n      // Remove elements\n      removeMeter()\n      // Stop listening\n      self.tick = self.tickStart = function () {}\n    }\n\n    /**\n\t\t * Remove meter element.\n\t\t *\n\t\t * @return {Void}\n\t\t */\n    function removeMeter () {\n      // Unbind listeners\n      if (o.toggleOn) {\n        listener(el.container, o.toggleOn, eventHandler, 1)\n      }\n      // Detach element\n      anchor.removeChild(el.container)\n    }\n\n    /**\n\t\t * Sets the theme, and generates heatmaps when needed.\n\t\t */\n    function setTheme () {\n      theme = FPSMeter.theme[o.theme]\n\n      // Generate heatmaps\n      heatmaps = theme.compiledHeatmaps || []\n      if (!heatmaps.length && theme.heatmaps.length) {\n        for (j = 0; j < theme.heatmaps.length; j++) {\n          heatmaps[j] = []\n          for (i = 0; i <= heatDepth; i++) {\n            heatmaps[j][i] = hslToHex(0.33 / heatDepth * i, theme.heatmaps[j].saturation, theme.heatmaps[j].lightness)\n          }\n        }\n        theme.compiledHeatmaps = heatmaps\n      }\n    }\n\n    /**\n\t\t * Creates and attaches the meter element.\n\t\t *\n\t\t * @return {Void}\n\t\t */\n    function createMeter () {\n      // Remove old meter if present\n      if (el.container) {\n        removeMeter()\n      }\n\n      // Set theme\n      setTheme()\n\n      // Create elements\n      el.container = applyTheme(newEl('div'), theme.container)\n      el.count = el.container.appendChild(applyTheme(newEl('div'), theme.count))\n      el.legend = el.container.appendChild(applyTheme(newEl('div'), theme.legend))\n      el.graph = o.graph ? el.container.appendChild(applyTheme(newEl('div'), theme.graph)) : 0\n\n      // Add elements to heating array\n      heating.length = 0\n      for (var key in el) {\n        if (el[key] && theme[key].heatOn) {\n          heating.push({\n            name: key,\n            el: el[key]\n          })\n        }\n      }\n\n      // Graph\n      cols.length = 0\n      if (el.graph) {\n        // Create graph\n        el.graph.style.width = (o.history * theme.column.width + (o.history - 1) * theme.column.spacing) + 'px'\n\n        // Add columns\n        for (i = 0; i < o.history; i++) {\n          cols[i] = el.graph.appendChild(applyTheme(newEl('div'), theme.column))\n          cols[i].style.position = 'absolute'\n          cols[i].style.bottom = 0\n          cols[i].style.right = (i * theme.column.width + i * theme.column.spacing) + 'px'\n          cols[i].style.width = theme.column.width + 'px'\n          cols[i].style.height = '0px'\n        }\n      }\n\n      // Set the initial state\n      positionMeter()\n      updateCounter()\n\n      // Append container to anchor\n      anchor.appendChild(el.container)\n\n      // Retrieve graph height after it was appended to DOM\n      if (el.graph) {\n        graphHeight = el.graph.clientHeight\n      }\n\n      // Add event listeners\n      if (o.toggleOn) {\n        if (o.toggleOn === 'click') {\n          el.container.style.cursor = 'pointer'\n        }\n        listener(el.container, o.toggleOn, eventHandler)\n      }\n    }\n\n    /**\n\t\t * Positions the meter based on options.\n\t\t *\n\t\t * @return {Void}\n\t\t */\n    function positionMeter () {\n      applyTheme(el.container, o)\n    }\n\n    /**\n\t\t * Construct.\n\t\t */\n    (function () {\n      // Create meter element\n      createMeter()\n      // Start rendering\n      requestRender()\n    }())\n  }\n\n  // Expose the extend function\n  FPSMeter.extend = extend\n\n  // Expose the FPSMeter class\n  window.FPSMeter = FPSMeter\n\n  // Default options\n  FPSMeter.defaults = {\n    interval: 100, // Update interval in milliseconds.\n    smoothing: 10, // Spike smoothing strength. 1 means no smoothing.\n    show: 'fps', // Whether to show 'fps', or 'ms' = frame duration in milliseconds.\n    toggleOn: 'click', // Toggle between show 'fps' and 'ms' on this event.\n    decimals: 1, // Number of decimals in FPS number. 1 = 59.9, 2 = 59.94, ...\n    maxFps: 60, // Max expected FPS value.\n    threshold: 100, // Minimal tick reporting interval in milliseconds.\n\n    // Meter position\n    position: 'absolute', // Meter position.\n    zIndex: 10, // Meter Z index.\n    left: '5px', // Meter left offset.\n    top: '5px', // Meter top offset.\n    right: 'auto', // Meter right offset.\n    bottom: 'auto', // Meter bottom offset.\n    margin: '0 0 0 0', // Meter margin. Helps with centering the counter when left: 50%;\n\n    // Theme\n    theme: 'dark', // Meter theme. Build in: 'dark', 'light', 'transparent', 'colorful'.\n    heat: 0, // Allow themes to use coloring by FPS heat. 0 FPS = red, maxFps = green.\n\n    // Graph\n    graph: 0, // Whether to show history graph.\n    history: 20, // How many history states to show in a graph.\n    legend: ['FPS', 'ms']\n  }\n\n  // Option names that trigger FPSMeter rebuild or reposition when modified\n  var rebuilders = [\n    'toggleOn',\n    'theme',\n    'heat',\n    'graph',\n    'history'\n  ]\n  var repositioners = [\n    'position',\n    'zIndex',\n    'left',\n    'top',\n    'right',\n    'bottom',\n    'margin'\n  ]\n}(window))\n;(function (w, FPSMeter, undefined) {\n  'use strict'\n\n  // Themes object\n  FPSMeter.theme = {}\n\n  // Base theme with layout, no colors\n  var base = FPSMeter.theme.base = {\n    heatmaps: [],\n    container: {\n      // Settings\n      heatOn: null,\n      heatmap: null,\n\n      // Styles\n      padding: '5px',\n      minWidth: '95px',\n      height: '30px',\n      lineHeight: '30px',\n      textAlign: 'right',\n      textShadow: 'none'\n    },\n    count: {\n      // Settings\n      heatOn: null,\n      heatmap: null,\n\n      // Styles\n      position: 'absolute',\n      top: 0,\n      right: 0,\n      padding: '5px 10px',\n      height: '30px',\n      fontSize: '24px',\n      fontFamily: 'Consolas, Andale Mono, monospace',\n      zIndex: 2\n    },\n    legend: {\n      // Settings\n      heatOn: null,\n      heatmap: null,\n\n      // Styles\n      position: 'absolute',\n      top: 0,\n      left: 0,\n      padding: '5px 10px',\n      height: '30px',\n      fontSize: '12px',\n      lineHeight: '32px',\n      fontFamily: 'sans-serif',\n      textAlign: 'left',\n      zIndex: 2\n    },\n    graph: {\n      // Settings\n      heatOn: null,\n      heatmap: null,\n\n      // Styles\n      position: 'relative',\n      boxSizing: 'padding-box',\n      MozBoxSizing: 'padding-box',\n      height: '100%',\n      zIndex: 1\n    },\n    column: {\n      // Settings\n      width: 4,\n      spacing: 1,\n      heatOn: null,\n      heatmap: null\n    }\n  }\n\n  // Dark theme\n  FPSMeter.theme.dark = FPSMeter.extend({}, base, {\n    heatmaps: [{\n      saturation: 0.8,\n      lightness: 0.8\n    }],\n    container: {\n      background: 'rgba(60, 60, 60, 0.5)',\n      color: '#fff',\n      border: '1px solid #1a1a1a',\n      textShadow: '1px 1px 0 #222'\n    },\n    count: {\n      heatOn: 'color'\n    },\n    column: {\n      background: '#3f3f3f'\n    }\n  })\n\n  // Light theme\n  FPSMeter.theme.light = FPSMeter.extend({}, base, {\n    heatmaps: [{\n      saturation: 0.5,\n      lightness: 0.5\n    }],\n    container: {\n      color: '#666',\n      background: '#fff',\n      textShadow: '1px 1px 0 rgba(255,255,255,.5), -1px -1px 0 rgba(255,255,255,.5)',\n      boxShadow: '0 0 0 1px rgba(0,0,0,.1)'\n    },\n    count: {\n      heatOn: 'color'\n    },\n    column: {\n      background: '#eaeaea'\n    }\n  })\n\n  // Colorful theme\n  FPSMeter.theme.colorful = FPSMeter.extend({}, base, {\n    heatmaps: [{\n      saturation: 0.5,\n      lightness: 0.6\n    }],\n    container: {\n      heatOn: 'backgroundColor',\n      background: '#888',\n      color: '#fff',\n      textShadow: '1px 1px 0 rgba(0,0,0,.2)',\n      boxShadow: '0 0 0 1px rgba(0,0,0,.1)'\n    },\n    column: {\n      background: '#777',\n      backgroundColor: 'rgba(0,0,0,.2)'\n    }\n  })\n\n  // Transparent theme\n  FPSMeter.theme.transparent = FPSMeter.extend({}, base, {\n    heatmaps: [{\n      saturation: 0.8,\n      lightness: 0.5\n    }],\n    container: {\n      background: 'rgba(60, 60, 60, 0.5)',\n      color: '#fff',\n      border: '1px solid #1a1a1a',\n      textShadow: '1px 1px 0 #222'\n    },\n    count: {\n      padding: '0 5px',\n      height: '40px',\n      lineHeight: '40px'\n    },\n    // legend: {\n    //\tpadding: '0 5px',\n    //\theight: '40px',\n    //\tlineHeight: '42px'\n    // },\n    // graph: {\n    //\theight: '40px'\n    // },\n    column: {\n      width: 5,\n      background: '#999',\n      heatOn: 'backgroundColor',\n      opacity: 0.5\n    }\n  })\n}(window, FPSMeter))\n","import MultiModelExtensionBase from './Viewer.MultiModelExtensionBase'\n\nexport default MultiModelExtensionBase\n","import EventsEmitter from 'EventsEmitter'\n\nexport default class MultiModelExtensionBase extends\n  EventsEmitter.Composer(Autodesk.Viewing.Extension) {\n  /// //////////////////////////////////////////////////////\n  // Class constructor\n  //\n  /// //////////////////////////////////////////////////////\n  constructor (viewer, options = {}, defaultOptions = {}) {\n    super(viewer)\n    // bindings\n    Object.assign(this, options.serviceContext)\n\n    this.onModelCompletedLoad = this.onModelCompletedLoad.bind(this)\n    this.onObjectTreeCreated = this.onObjectTreeCreated.bind(this)\n    this.onModelRootLoaded = this.onModelRootLoaded.bind(this)\n    this.onExtensionLoaded = this.onExtensionLoaded.bind(this)\n    this.onModelActivated = this.onModelActivated.bind(this)\n    this.onGeometryLoaded = this.onGeometryLoaded.bind(this)\n    this.onToolbarCreated = this.onToolbarCreated.bind(this)\n    this.onModelBeginLoad = this.onModelBeginLoad.bind(this)\n    this.onModelUnloaded = this.onModelUnloaded.bind(this)\n    this.onSelection = this.onSelection.bind(this)\n\n    this.__onModelRootLoaded = this.__onModelRootLoaded.bind(this)\n    this.__onModelActivated = this.__onModelActivated.bind(this)\n    this.__onModelUnloaded = this.__onModelUnloaded.bind(this)\n    this.__onModelLoaded = this.__onModelLoaded.bind(this)\n\n    this.defaultOptions = defaultOptions\n\n    this.options = Object.assign({},\n      defaultOptions,\n      options)\n\n    this.viewer = viewer\n\n    // read the modelQueue to detect currently loaded models\n    // when the extension gets loaded\n    const models = viewer.impl.modelQueue().getModels()\n\n    this.models = models.map((model) => {\n      model.guid = model.guid || this.guid()\n\n      return model\n    })\n\n    this.initializeEvents()\n  }\n\n  /// //////////////////////////////////////////////////////\n  // Extension Id\n  //\n  /// //////////////////////////////////////////////////////\n  static get ExtensionId () {\n    return 'Viewing.Extension.MultiModelExtensionBase'\n  }\n\n  /// //////////////////////////////////////////////////////\n  // Load callback\n  //\n  /// //////////////////////////////////////////////////////\n  load () {\n    return true\n  }\n\n  /// //////////////////////////////////////////////////////\n  // Unload callback\n  //\n  /// //////////////////////////////////////////////////////\n  unload () {\n    this.viewerEvents.forEach((event) => {\n      this.viewer.removeEventListener(\n        event.id, this[event.handler])\n    })\n\n    if (this.eventSink) {\n      this.eventSink.off('model.activated',\n        this.__onModelActivated)\n\n      this.eventSink.off('model.unloaded',\n        this.__onModelUnloaded)\n\n      this.eventSink.off('model.loaded',\n        this.__onModelLoaded)\n    }\n\n    this.off()\n\n    return true\n  }\n\n  /// //////////////////////////////////////////////////////\n  // Reload callback, in case the extension is re-loaded\n  // more than once\n  //\n  /// //////////////////////////////////////////////////////\n  reload (options = {}) {\n    this.options = Object.assign({},\n      this.defaultOptions,\n      this.options,\n      options)\n\n    return true\n  }\n\n  /// //////////////////////////////////////////////////////\n  // Invoked when extension gets loaded\n  //\n  /// //////////////////////////////////////////////////////\n  onExtensionLoaded (event) {\n\n    // console.log('MultiModelExtensionBase.onExtensionLoaded')\n  }\n\n  /// //////////////////////////////////////////////////////\n  // Invoked when the model starts to load\n  // The geometry and instanceTree may not be available\n  // at this time\n  //\n  /// //////////////////////////////////////////////////////\n  onModelBeginLoad (event) {\n\n    // console.log('MultiModelExtensionBase.onModelBeginLoad')\n  }\n\n  /// //////////////////////////////////////////////////////\n  // Triggered by ModelLoader extension when a model is\n  // selected in a multi-model environment\n  //\n  /// //////////////////////////////////////////////////////\n  onModelActivated (event) {\n\n    // console.log('MultiModelExtensionBase.onModelActivated')\n  }\n\n  /// //////////////////////////////////////////////////////\n  // Invoked when model root node has been loaded\n  // Extensions that do require access to full\n  // model geometry or component tree may use that\n  // event to know a new model has been loaded\n  //\n  /// //////////////////////////////////////////////////////\n  __onModelRootLoaded (event) {\n    this.viewerEvent([\n\n      Autodesk.Viewing.OBJECT_TREE_CREATED_EVENT,\n      Autodesk.Viewing.GEOMETRY_LOADED_EVENT\n\n    ]).then((args) => {\n      this.onModelCompletedLoad(args[0])\n    })\n  }\n\n  onModelRootLoaded (event) {\n\n    // console.log('MultiModelExtensionBase.onModelRootLoaded')\n  }\n\n  /// //////////////////////////////////////////////////////\n  // Invoked when object tree is fully loaded.\n  // Extensions that are interested in using the\n  // instanceTree need to use that event to make sure\n  // it is available\n  //\n  /// /////////////////////////////////////////////////////\n  onObjectTreeCreated (event) {\n\n    // console.log('MultiModelExtensionBase.onObjectTreeCreated')\n  }\n\n  /// //////////////////////////////////////////////////////\n  // Invoked when geometry is fully loaded\n  //\n  /// //////////////////////////////////////////////////////\n  onGeometryLoaded (event) {\n\n    // console.log('MultiModelExtensionBase.onGeometryLoaded')\n  }\n\n  /// //////////////////////////////////////////////////////\n  // Invoked after onObjectTreeCreated and onGeometryLoaded\n  // have both been fired\n  //\n  /// //////////////////////////////////////////////////////\n  onModelCompletedLoad (event) {\n\n    // console.log('MultiModelExtensionBase.onModelCompletedLoad')\n  }\n\n  /// //////////////////////////////////////////////////////\n  // Invoked once the viewer toolbar has been created\n  //\n  /// //////////////////////////////////////////////////////\n  onToolbarCreated (event) {\n\n    // console.log('MultiModelExtensionBase.onToolbarCreated')\n  }\n\n  /// //////////////////////////////////////////////////////\n  // Triggered by ModelLoader extension when a model has\n  // been unloaded as per user request\n  //\n  /// //////////////////////////////////////////////////////\n  onModelUnloaded (event) {\n\n    // console.log('MultiModelExtensionBase.onModelUnloaded')\n  }\n\n  /// //////////////////////////////////////////////////////\n  // Invoked when a model is being selected\n  //\n  /// //////////////////////////////////////////////////////\n  onSelection (event) {\n\n    // console.log('MultiModelExtensionBase.onSelection')\n  }\n\n  /// //////////////////////////////////////////////////////\n  // Sink Events\n  //\n  /// //////////////////////////////////////////////////////\n  __onModelLoaded (event) {\n    this.models = [...this.models, event.model]\n\n    this.onModelBeginLoad(event)\n  }\n\n  __onModelActivated (event) {\n    this.onModelActivated(event)\n  }\n\n  __onModelUnloaded (event) {\n    this.models = this.models.filter((model) => {\n      return model.guid !== event.model.guid\n    })\n\n    this.onModelUnloaded(event)\n  }\n\n  /// //////////////////////////////////////////////////////\n  // Initialize all events for the extension\n  // Each event will invoke a predefined handler\n  // implemented or not by the derived extension\n  //\n  /// //////////////////////////////////////////////////////\n  initializeEvents () {\n    if (this.options.eventSink) {\n      // event object passed in options\n      this.eventSink = this.options.eventSink\n\n      this.eventSink.on('model.loaded',\n        this.__onModelLoaded)\n\n      this.eventSink.on('model.activated',\n        this.__onModelActivated)\n\n      this.eventSink.on('model.unloaded',\n        this.__onModelUnloaded)\n    }\n\n    this.viewerEvents = [\n      {\n        id: Autodesk.Viewing.EXTENSION_LOADED_EVENT,\n        handler: 'onExtensionLoaded'\n      },\n      {\n        id: Autodesk.Viewing.OBJECT_TREE_CREATED_EVENT,\n        handler: 'onObjectTreeCreated'\n      },\n      {\n        id: Autodesk.Viewing.MODEL_ROOT_LOADED_EVENT,\n        handler: '__onModelRootLoaded'\n      },\n      {\n        id: Autodesk.Viewing.MODEL_ROOT_LOADED_EVENT,\n        handler: 'onModelRootLoaded'\n      },\n      {\n        id: Autodesk.Viewing.GEOMETRY_LOADED_EVENT,\n        handler: 'onGeometryLoaded'\n      },\n      {\n        id: Autodesk.Viewing.TOOLBAR_CREATED_EVENT,\n        handler: 'onToolbarCreated'\n      },\n      {\n        id: Autodesk.Viewing.AGGREGATE_SELECTION_CHANGED_EVENT,\n        handler: 'onSelection'\n      }\n    ]\n\n    this.viewerEvents.forEach((event) => {\n      this.viewerEvent(event.id, this[event.handler])\n    })\n  }\n\n  /// //////////////////////////////////////////////////////\n  // Async viewer event\n  //\n  /// //////////////////////////////////////////////////////\n  viewerEvent (eventId, handler) {\n    if (handler) {\n      this.viewer.addEventListener(eventId, handler)\n      return\n    }\n\n    const eventIdArray = Array.isArray(eventId)\n      ? eventId : [eventId]\n\n    const eventTasks = eventIdArray.map((id) => {\n      return new Promise((resolve) => {\n        const __handler = (args) => {\n          this.viewer.removeEventListener(id, __handler)\n          resolve(args)\n        }\n        this.viewer.addEventListener(id, __handler)\n      })\n    })\n\n    return Promise.all(eventTasks)\n  }\n}\n","import ViewerExtensionBase from './Viewer.ExtensionBase'\n\nexport default ViewerExtensionBase\n","import EventsEmitter from 'EventsEmitter'\n\nexport default class ExtensionBase extends\n  EventsEmitter.Composer(Autodesk.Viewing.Extension) {\n  /// //////////////////////////////////////////////////////\n  // Class constructor\n  //\n  /// //////////////////////////////////////////////////////\n  constructor (viewer, options = {}) {\n    super(viewer, options)\n\n    this._viewer = viewer\n    this.viewer = viewer\n\n    this._options = options\n    this.options = options\n    Object.assign(this, options.serviceContext)\n  }\n\n  /// //////////////////////////////////////////////////////\n  // Extension Id\n  //\n  /// //////////////////////////////////////////////////////\n  static get ExtensionId () {\n    return 'Viewing.Extension.Base'\n  }\n\n  /// ////////////////////////////////////////////////////////\n  //\n  //\n  /// ////////////////////////////////////////////////////////\n  static guid (format = 'xxxxxxxxxx') {\n    var d = new Date().getTime()\n\n    var guid = format.replace(\n      /[xy]/g,\n      function (c) {\n        var r = (d + Math.random() * 16) % 16 | 0\n        d = Math.floor(d / 16)\n        return (c == 'x' ? r : (r & 0x7 | 0x8)).toString(16)\n      })\n\n    return guid\n  }\n\n  /// //////////////////////////////////////////////////////\n  // Load callback\n  //\n  /// //////////////////////////////////////////////////////\n  load () {\n    return true\n  }\n\n  /// //////////////////////////////////////////////////////\n  // Unload callback\n  //\n  /// //////////////////////////////////////////////////////\n  unload () {\n    return true\n  }\n\n  /// //////////////////////////////////////////////////////\n  // Reload callback\n  //\n  /// //////////////////////////////////////////////////////\n  reload (options) {\n    return true\n  }\n\n  /// //////////////////////////////////////////////////////\n  // Async viewer event\n  //\n  /// //////////////////////////////////////////////////////\n  viewerEvent (eventId) {\n    const eventIdArray = Array.isArray(eventId)\n      ? eventId : [eventId]\n\n    const eventTasks = eventIdArray.map((id) => {\n      return new Promise((resolve) => {\n        const handler = (args) => {\n          this.viewer.removeEventListener(\n            id, handler)\n          resolve(args)\n        }\n        this.viewer.addEventListener(\n          id, handler)\n      })\n    })\n\n    return Promise.all(eventTasks)\n  }\n}\n","\nexport default class Vector {\n  constructor (x = 0, y = 0, z = 0) {\n    this._x = x\n    this._y = y\n    this._z = z\n  }\n\n  getX () { return this._x }\n  getY () { return this._y }\n  getZ () { return this._z }\n\n  magnitude () {\n    return Math.sqrt(\n      this._x * this._x +\n      this._y * this._y +\n      this._z * this._z)\n  }\n\n  asUnitVector () {\n    var m = this.magnitude()\n\n    return new Vector(\n      this._x / m,\n      this._y / m,\n      this._z / m)\n  }\n\n  scaled (scaleFactor) {\n    var m = this.magnitude()\n\n    return new Vector(\n      this._x * scaleFactor / m,\n      this._y * scaleFactor / m,\n      this._z * scaleFactor / m)\n  }\n\n  multiply (scaleFactor) {\n    this._x *= scaleFactor\n    this._y *= scaleFactor\n    this._z *= scaleFactor\n\n    return this\n  }\n\n  add (vector) {\n    this._x += vector._x\n    this._y += vector._y\n    this._z += vector._z\n\n    return this\n  }\n\n  vectorTo (vector) {\n    return new Vector(\n      vector._x - this._x,\n      vector._y - this._y,\n      vector._z - this._z\n    )\n  }\n\n  withinSphere (center, radius) {\n    var magnitudeSqr =\n      (this._x - center._x) * (this._x - center._x) +\n      (this._y - center._y) * (this._y - center._y) +\n      (this._z - center._z) * (this._z - center._z)\n\n    return magnitudeSqr < radius * radius\n  }\n\n  withinBox (center, size) {\n    // TODO\n\n    return true\n  }\n\n  copy () {\n    return new Vector(this._x, this._y, this._z)\n  }\n\n  static fromArray (data) {\n    return new Vector(data[0], data[1], data[2])\n  }\n}\n","import Vector from './Vector'\n\nexport default class BaseObject {\n  constructor (id, type) {\n    this._offset = new Vector()\n    this._position = new Vector()\n    this._selectable = true\n    this._transformable = true\n    this._type = type\n    this._id = id\n  }\n\n  setPosition (x, y, z) {\n    this._position = new Vector(\n      x + this._offset._x,\n      y + this._offset._y,\n      z + this._offset._z)\n  }\n\n  getPosition () {\n    return this._position\n  }\n\n  setOffset (x, y, z) {\n    this._offset = new Vector(x, y, z)\n  }\n\n  getOffset () {\n    return this._offset\n  }\n\n  setTransformable (transformable) {\n    this._transformable = transformable\n  }\n\n  getTransformable () {\n    return this._transformable\n  }\n\n  setSelectable (selectable) {\n    this._selectable = selectable\n  }\n\n  getSelectable () {\n    return this._selectable\n  }\n\n  getType () {\n    return this._type\n  }\n\n  getId () {\n    return this._id\n  }\n}\n","import BaseObject from './BaseObject'\nimport Vector from './Vector'\n\nexport default class ParticleEmitter extends BaseObject {\n  constructor (id) {\n    super(id, 0)\n\n    this._spread = 2 * Math.PI / 180\n    this._emissionRate = 500\n    this._velocity = 10\n    this._charge = 1\n  }\n\n  emitNumber (dt) {\n    return Math.floor(this._emissionRate * dt)\n  }\n\n  emitParticle (particle) {\n    var angle1 = this._spread * (2 * Math.random() - 1)\n    var angle2 = this._spread * (2 * Math.random() - 1)\n\n    particle._velocity._x = this._velocity *\n      Math.cos(angle1) * Math.cos(angle2)\n\n    particle._velocity._y = this._velocity *\n      Math.sin(angle1) * Math.cos(angle2)\n\n    particle._velocity._z = this._velocity *\n      Math.sin(angle2)\n\n    particle._position._x = this._position._x\n    particle._position._y = this._position._y\n    particle._position._z = this._position._z\n\n    particle._charge = this._charge\n  }\n\n  setEmissionRate (emissionRate) {\n    this._emissionRate = emissionRate\n  }\n\n  getEmissionRate () {\n    return this._emissionRate\n  }\n\n  setVelocity (velocity) {\n    this._velocity = velocity\n  }\n\n  getVelocity () {\n    return this._velocity\n  }\n\n  setSpread (spread) {\n    this._spread = spread\n  }\n\n  getSpread () {\n    return this._spread\n  }\n\n  setCharge (charge) {\n    this._charge = charge\n  }\n\n  getCharge () {\n    return this._charge\n  }\n}\n","\nimport Field from './Field'\n\nexport default class MagneticField extends Field {\n  constructor (id) {\n    super(id, 1)\n\n    this._force = 0\n  }\n\n  applyForce (particle) {\n    const particlePos = particle._position\n\n    const fieldPos = this._position\n\n    const dX = fieldPos._x - particlePos._x\n    const dY = fieldPos._y - particlePos._y\n    const dZ = fieldPos._z - particlePos._z\n\n    const force = particle._charge * this._force / Math.pow((\n      dX * dX +\n      dY * dY +\n      dZ * dZ), 1.5)\n\n    if (Math.abs(force) > 0.001) {\n      const particleAcc = particle._acceleration\n\n      particleAcc._x += dX * force\n      particleAcc._y += dY * force\n      particleAcc._z += dZ * force\n    }\n  }\n\n  setForce (force) {\n    this._force = force\n  }\n\n  getForce () {\n    return this._force\n  }\n}\n","import BaseObject from './BaseObject'\nimport Vector from './Vector'\n\nexport default class Field extends BaseObject {\n  constructor (id, type) {\n    super(id, type)\n  }\n\n  computeAcceleration (particle) {\n    return new Vector()\n  }\n}\n","\nexport default class EventsEmitter {\n  /// ////////////////////////////////////////////////////////////////\n  //\n  //\n  /// ////////////////////////////////////////////////////////////////\n  constructor () {\n    this._events = {}\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  //\n  //\n  /// ////////////////////////////////////////////////////////////////\n  on (event, fct) {\n    this._events[event] = this._events[event]\t|| []\n    this._events[event].push(fct)\n\n    return this\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  //\n  //\n  /// ////////////////////////////////////////////////////////////////\n  off (event, fct) {\n    if (event == undefined) {\n      this._events = {}\n      return\n    }\n\n    if (event in this._events === false) { return }\n\n    if (fct) {\n      this._events[event].splice(\n        this._events[event].indexOf(fct), 1)\n    } else {\n      this._events[event] = []\n    }\n\n    return this\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  //\n  //\n  /// ////////////////////////////////////////////////////////////////\n  emit (event /* , args... */) {\n    if (this._events[event] === undefined) { return }\n\n    var tmpArray = this._events[event].slice()\n\n    for (var i = 0; i < tmpArray.length; ++i) {\n      var result\t= tmpArray[i].apply(this,\n        Array.prototype.slice.call(arguments, 1))\n\n      if (result !== undefined) { return result }\n    }\n\n    return undefined\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  //\n  //\n  /// ////////////////////////////////////////////////////////////////\n  guid (format = 'xxxxxxxxxxxx') {\n    var d = new Date().getTime()\n\n    var guid = format.replace(\n      /[xy]/g,\n      function (c) {\n        var r = (d + Math.random() * 16) % 16 | 0\n        d = Math.floor(d / 16)\n        return (c == 'x' ? r : (r & 0x7 | 0x8)).toString(16)\n      })\n\n    return guid\n  }\n}\n","import Vector from './Vector'\n\nexport default class Particle {\n  constructor (dof) {\n    this._velocity = new Vector()\n    this._position = new Vector()\n    this._acceleration = new Vector()\n    this._recycled = false\n    this._radius = 0.03\n    this._dof = dof\n    this._lifeTime = 30\n    this._charge = 1\n    this.ptr = 1 // compat with wasm\n  }\n\n  reset () {\n    this._recycled = false\n    this._lifeTime = 30\n  }\n\n  submitToFields (fields) {\n    this._acceleration._x = 0\n    this._acceleration._y = 0\n    this._acceleration._z = 0\n\n    fields.forEach((field) => {\n      field.applyForce(this)\n    })\n  }\n\n  step (dt) {\n    this._lifeTime -= dt\n\n    this._velocity._x += this._acceleration._x * dt\n    this._velocity._y += this._acceleration._y * dt\n    this._velocity._z += this._acceleration._z * dt\n\n    this._position._x += this._velocity._x * this._dof._x * dt\n    this._position._y += this._velocity._y * this._dof._y * dt\n    this._position._z += this._velocity._z * this._dof._z * dt\n  }\n\n  getRecycled () {\n    return this._recycled\n  }\n\n  getLifeTime () {\n    return this._lifeTime\n  }\n\n  setLifeTime (lifeTime) {\n    this._lifeTime = lifeTime\n  }\n\n  getAcceleration () {\n    return this._acceleration\n  }\n\n  getPosition () {\n    return this._position\n  }\n\n  getCharge () {\n    return this._charge\n  }\n\n  getRadius () {\n    return this._radius\n  }\n}\n","import ParticleEmitter from './ParticleEmitter'\nimport MagneticField from './MagneticField'\nimport EventsEmitter from './EventsEmitter'\nimport Particle from './Particle'\nimport Vector from './Vector'\n\nexport default class ParticleSystem extends EventsEmitter {\n  /// ////////////////////////////////////////////////////////////////\n  //\n  //\n  /// ////////////////////////////////////////////////////////////////\n  constructor (maxParticles) {\n    super()\n\n    this._maxParticles = maxParticles\n    this._dof = new Vector(1, 1, 1)\n    this._emittedParticles = 0\n    this._particleIdx = 0\n    this._recycleBin = []\n    this._particles = []\n    this._emitters = []\n    this._fields = []\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  //\n  //\n  /// ////////////////////////////////////////////////////////////////\n  setMaxParticles (maxParticles) {\n    this._maxParticles = maxParticles\n  }\n\n  getMaxParticles () {\n    return this._maxParticles\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  // Returns object by id\n  //\n  /// ////////////////////////////////////////////////////////////////\n  getObjectById (id) {\n    for (var emitter of this._emitters) {\n      if (emitter.getId() === id) {\n        return emitter\n      }\n    }\n\n    for (var field of this._fields) {\n      if (field.getId() === id) {\n        return field\n      }\n    }\n\n    return null\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  // Returns emitter by id\n  //\n  /// ////////////////////////////////////////////////////////////////\n  getEmitter (id) {\n    for (var emitter of this._emitters) {\n      if (emitter.getId() === id) {\n        return emitter\n      }\n    }\n\n    return null\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  // Returns magnetic field by id\n  //\n  /// ////////////////////////////////////////////////////////////////\n  getMagneticField (id) {\n    for (var field of this._fields) {\n      if (field.getId() === id) {\n        return field\n      }\n    }\n\n    return null\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  //\n  //\n  /// ////////////////////////////////////////////////////////////////\n  setDof (x, y, z) {\n    this._dof = new Vector(x, y, z)\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  // clean up all objects\n  //\n  /// ////////////////////////////////////////////////////////////////\n  destroy () {\n    this._recycleBin = []\n\n    this._particles = []\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  // Adds emitter object\n  //\n  /// ////////////////////////////////////////////////////////////////\n  addEmitter (id) {\n    var emitter = new ParticleEmitter(id)\n\n    this._emitters.push(emitter)\n\n    return emitter\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  // Adds magnetic field object\n  //\n  /// ////////////////////////////////////////////////////////////////\n  addMagneticField (id) {\n    var field = new MagneticField(id)\n\n    this._fields.push(field)\n\n    return field\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  // updates simulation\n  //\n  /// ////////////////////////////////////////////////////////////////\n  step (dt) {\n    this.addNewParticles(dt)\n    this.filterParticles(dt)\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  // add new particles step\n  //\n  /// ////////////////////////////////////////////////////////////////\n  addNewParticles (dt) {\n    this._emitters.forEach((emitter) => {\n      for (var i = 0; i < emitter.emitNumber(dt); ++i) {\n        var particle = this.popRecycle()\n\n        if (particle) {\n          emitter.emitParticle(particle)\n        }\n      }\n    })\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  // push a particle to recycle bin\n  //\n  /// ////////////////////////////////////////////////////////////////\n  pushRecycle (particle) {\n    --this._emittedParticles\n\n    particle._recycled = true\n\n    this._recycleBin.push(particle)\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  // pop a particle from recycle bin\n  //\n  /// ////////////////////////////////////////////////////////////////\n  popRecycle () {\n    if (this._emittedParticles > this._maxParticles - 1) {\n      return null\n    }\n\n    ++this._emittedParticles\n\n    var particle = this._recycleBin.pop()\n\n    if (particle) {\n      particle.reset()\n\n      return particle\n    }\n\n    particle = new Particle(this._dof)\n\n    this._particles.push(particle)\n\n    return particle\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  // filter particles using lifeTime\n  //\n  /// ////////////////////////////////////////////////////////////////\n  filterParticle (particle) {\n    if (particle._recycled) {\n      return true\n    }\n\n    if (particle._lifeTime < 0) {\n      this.pushRecycle(particle)\n\n      return true\n    }\n\n    return false\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  // filter particles step\n  //\n  /// ////////////////////////////////////////////////////////////////\n  filterParticles (dt) {\n    this._particles.forEach((particle) => {\n      if (!this.filterParticle(particle)) {\n        particle.submitToFields(this._fields)\n\n        particle.step(dt)\n      }\n    })\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  // initialize particle index\n  //\n  /// ////////////////////////////////////////////////////////////////\n  initParticleLoop () {\n    this._particleIdx = 0\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  // initialize particule index\n  //\n  /// ////////////////////////////////////////////////////////////////\n  nextParticle () {\n    if (this._particleIdx < this._particles.length) {\n      return this._particles[this._particleIdx++]\n    }\n\n    return { ptr: 0 } // compatibility with asm.js/wasm\n  }\n}\n","import ParticleSystem from './ParticleSystem'\nimport Vector from './Vector'\n\nexport default {\n  Instance: ParticleSystem,\n  Vector\n}\n"],"sourceRoot":""}