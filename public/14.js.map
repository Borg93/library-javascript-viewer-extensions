{"version":3,"sources":["webpack:///./node_modules/lodash/_baseForOwn.js","webpack:///./node_modules/d3pie/d3pie/d3pie.js"],"names":["baseFor","__webpack_require__","keys","module","exports","object","iteratee","__WEBPACK_AMD_DEFINE_FACTORY__","__WEBPACK_AMD_DEFINE_ARRAY__","__WEBPACK_AMD_DEFINE_RESULT__","undefined","_uniqueIDCounter","defaultSettings","header","title","text","color","fontSize","font","subtitle","location","titleSubtitlePadding","footer","size","canvasHeight","canvasWidth","pieInnerRadius","pieOuterRadius","data","sortOrder","ignoreSmallSegments","enabled","valueType","value","smallSegmentGrouping","label","content","labels","outer","format","hideWhenLessThanPercentage","pieDistance","inner","mainLabel","percentage","decimalPlaces","lines","style","truncation","truncateLength","formatter","effects","load","effect","speed","pullOutSegmentOnClick","highlightSegmentOnMouseover","highlightLuminosity","tooltips","type","string","placeholderParser","styles","fadeInSpeed","backgroundColor","backgroundOpacity","borderRadius","padding","misc","colors","background","segments","segmentStroke","gradient","canvasPadding","top","right","bottom","left","pieCenterOffset","x","y","cssPrefix","callbacks","onload","onMouseoverSegment","onMouseoutSegment","onClickSegment","validate","initialCheck","pie","element","options","window","d3","hasOwnProperty","console","error","HTMLElement","SVGElement","test","helpers","isArray","length","i","isNaN","log","push","addSVGSpace","svg","select","append","attr","whenIdExists","id","callback","inc","interval","setInterval","document","getElementById","clearInterval","whenElementsExist","els","allExist","shuffleArray","array","tmpVal","randomIndex","currentIndex","Math","floor","random","processObj","obj","is","split","slice","getDimensions","el","w","h","dimensions","getBBox","width","height","rectIntersect","r1","r2","returnVal","getColorShade","hex","lum","String","replace","newHex","c","parseInt","substr","round","min","max","toString","initSegmentColors","finalColors","applySmallSegmentGrouping","totalSize","math","getTotalPieSize","newData","groupedData","totalGroupedData","dataPercent","isGrouped","showPoint","isFunction","functionToCheck","call","o","Object","prototype","extend","name","src","copy","copyIsArray","clone","target","arguments","deep","hasOwn","class2type","[object Boolean]","[object Number]","[object String]","[object Function]","[object Array]","[object Date]","[object RegExp]","[object Object]","jQuery","Array","isWindow","isNumeric","parseFloat","isFinite","isPlainObject","nodeType","constructor","e","key","this","toRadians","degrees","PI","toDegrees","radians","computePieRadius","textComponents","headerHeight","exists","innerRadius","percent","outerRadius","smallestDimension","pieDistanceSpace","sortPieData","sort","a","b","toLowerCase","getPieTranslateCenter","pieCenter","calculatePieCenter","hasTopTitle","hasTopSubtitle","headerOffset","footerOffset","rotate","xm","ym","cos","sin","xr","yr","translate","d","rads","pointIsInArc","pt","ptData","d3Arc","theta1","startAngle","theta2","endAngle","dist","angle","atan2","add","section","sectionDisplayType","include","getIncludes","settings","outerLabel","insert","labelGroup","selectAll","enter","formatterContext","str","index","part","substring","getPercentage","positionLabelElements","labelGroups","each","node","dims","computeLabelLinePositions","lineCoordGroups","computeLinePosition","x2","y2","x3","y3","getSegmentAngle","midpoint","originCoords","heightOffset","outerLabelGroupData","quarter","startOfLabelX","startOfLabel","addLabelLines","lineGroups","lineGroup","lineFunction","line","interpolate","segmentPercentage","isHidden","positionLabelGroups","pieCenterCopy","newCoords","xOffset","yOffset","fadeInLabelsAndLines","loadSpeed","setTimeout","labelFadeInTime","transition","duration","val","addMainLabel","addValue","addPercentage","computeOuterLabelCoords","getIdealOuterLabelPositions","resolveOuterLabelCollisions","checkConflict","currIndex","direction","curr","currIndexHemisphere","hs","nextIndex","currLabelGroup","examinedLabelGroup","info","labelHeights","center","lineLength","heightChange","adjustLabelPos","lastCorrectlyPositionedLabel","xDiff","yDiff","newXPos","newYPos","abs","sqrt","labelGroupNode","labelGroupDims","originalX","originalY","hemisphere","create","loadEffects","pieChartElement","arc","g","ease","attrTween","t","addGradients","grads","addSegmentEventHandlers","on","segment","currentEl","isExpanded","onSegmentEvent","closeSegment","openSegment","segColor","tt","showTooltip","moveTooltip","hideTooltip","func","expanded","isOpeningSegment","centroid","pullOutSize","currentlyOpenSegment","getCentroid","bbox","opts","fullValue","compounded","currValue","currAngle","relativeAmount","toFixed","offscreenCoord","addTitle","class","positionTitle","headerLocation","totalTitleHeight","addSubtitle","positionSubtitle","getHeaderHeight","addFooter","positionFooter","footerLocation","footerWidth","footerPlusPadding","addTooltips","rx","ry","opacity","caption","replacePlaceholders","currentTooltip","mouseCoords","mouse","parentNode","replacements","match","placeholder","d3pie","_init","recreate","redraw","innerHTML","destroy","getOpenSegment","updateProp","propKey","oldVal","html","oldValue","self","reqEls","d1","d2","apply"],"mappings":"8EAAA,IAAAA,EAAcC,EAAQ,KACtBC,EAAWD,EAAQ,KAcnBE,EAAAC,QAJA,SAAAC,EAAAC,GACA,OAAAD,GAAAL,EAAAK,EAAAC,EAAAJ,yBCZA,IAAAK,EAAAC,EAAAC;;;;;;;GAYID,EAAO,QAAWE,KAAAD,EAAA,mBAATF,EASZ,WAED,IAIAI,EAAA,EAWAC,EAAA,CACAC,OAAA,CACAC,MAAA,CACAC,KAAA,GACAC,MAAA,UACAC,SAAA,GACAC,KAAA,SAEAC,SAAA,CACAJ,KAAA,GACAC,MAAA,UACAC,SAAA,GACAC,KAAA,SAEAE,SAAA,aACAC,qBAAA,GAEAC,OAAA,CACAP,KAAA,GACAC,MAAA,UACAC,SAAA,GACAC,KAAA,QACAE,SAAA,QAEAG,KAAA,CACAC,aAAA,IACAC,YAAA,IACAC,eAAA,KACAC,eAAA,MAEAC,KAAA,CACAC,UAAA,OACAC,oBAAA,CACAC,SAAA,EACAC,UAAA,aACAC,MAAA,MAEAC,qBAAA,CACAH,SAAA,EACAE,MAAA,EACAD,UAAA,aACAG,MAAA,QACAnB,MAAA,WAEAoB,QAAA,IAEAC,OAAA,CACAC,MAAA,CACAC,OAAA,QACAC,2BAAA,KACAC,YAAA,IAEAC,MAAA,CACAH,OAAA,aACAC,2BAAA,MAEAG,UAAA,CACA3B,MAAA,UACAE,KAAA,QACAD,SAAA,IAEA2B,WAAA,CACA5B,MAAA,UACAE,KAAA,QACAD,SAAA,GACA4B,cAAA,GAEAZ,MAAA,CACAjB,MAAA,UACAE,KAAA,QACAD,SAAA,IAEA6B,MAAA,CACAf,SAAA,EACAgB,MAAA,SACA/B,MAAA,WAEAgC,WAAA,CACAjB,SAAA,EACAkB,eAAA,IAEAC,UAAA,MAEAC,QAAA,CACAC,KAAA,CACAC,OAAA,UACAC,MAAA,KAEAC,sBAAA,CACAF,OAAA,SACAC,MAAA,IACA/B,KAAA,IAEAiC,6BAAA,EACAC,qBAAA,IAEAC,SAAA,CACA3B,SAAA,EACA4B,KAAA,cACAC,OAAA,GACAC,kBAAA,KACAC,OAAA,CACAC,YAAA,IACAC,gBAAA,UACAC,kBAAA,GACAjD,MAAA,UACAkD,aAAA,EACAhD,KAAA,QACAD,SAAA,GACAkD,QAAA,IAGAC,KAAA,CACAC,OAAA,CACAC,WAAA,KACAC,SAAA,CACA,oGACA,oGACA,oGACA,oGACA,qGAEAC,cAAA,WAEAC,SAAA,CACA1C,SAAA,EACAa,WAAA,GACA5B,MAAA,WAEA0D,cAAA,CACAC,IAAA,EACAC,MAAA,EACAC,OAAA,EACAC,KAAA,GAEAC,gBAAA,CACAC,EAAA,EACAC,EAAA,GAEAC,UAAA,MAEAC,UAAA,CACAC,OAAA,KACAC,mBAAA,KACAC,kBAAA,KACAC,eAAA,OAKAC,EAAA,CAGAC,aAAA,SAAAC,GACA,IAAAR,EAAAQ,EAAAR,UACAS,EAAAD,EAAAC,QACAC,EAAAF,EAAAE,QAGA,IAAAC,OAAAC,KAAAD,OAAAC,GAAAC,eAAA,WAEA,OADAC,QAAAC,MAAA,qCACA,EAIA,KAAAN,aAAAO,aAAAP,aAAAQ,YAEA,OADAH,QAAAC,MAAA,kGACA,EAIA,8BAAAG,KAAAlB,GAEA,OADAc,QAAAC,MAAA,gDACA,EAIA,IAAAI,EAAAC,QAAAV,EAAAhE,KAAAQ,SAEA,OADA4D,QAAAC,MAAA,0EACA,EAEA,OAAAL,EAAAhE,KAAAQ,QAAAmE,OAEA,OADAP,QAAAC,MAAA,mCACA,EAKA,IADA,IAAArE,EAAA,GACA4E,EAAA,EAAeA,EAAAZ,EAAAhE,KAAAQ,QAAAmE,OAA+BC,IAC9C,iBAAAZ,EAAAhE,KAAAQ,QAAAoE,GAAAvE,OAAAwE,MAAAb,EAAAhE,KAAAQ,QAAAoE,GAAAvE,OACA+D,QAAAU,IAAA,cAAAd,EAAAhE,KAAAQ,QAAAoE,IAGAZ,EAAAhE,KAAAQ,QAAAoE,GAAAvE,OAAA,EACA+D,QAAAU,IAAA,2CAAAd,EAAAhE,KAAAQ,QAAAoE,IAGA5E,EAAA+E,KAAAf,EAAAhE,KAAAQ,QAAAoE,IAOA,OALAd,EAAAE,QAAAhE,KAAAQ,QAAAR,GAKA,IAKAyE,EAAA,CAGAO,YAAA,SAAAlB,GACA,IAAAC,EAAAD,EAAAC,QACAlE,EAAAiE,EAAAE,QAAArE,KAAAE,YACAD,EAAAkE,EAAAE,QAAArE,KAAAC,aACAwC,EAAA0B,EAAAE,QAAAxB,KAAAC,OAAAC,WAEAuC,EAAAf,GAAAgB,OAAAnB,GAAAoB,OAAA,WACAC,KAAA,QAAAvF,GACAuF,KAAA,SAAAxF,GAMA,MAJA,gBAAAwC,GACA6C,EAAA9D,MAAA,8BAA6C,OAAAiB,IAG7C6C,GAGAI,aAAA,SAAAC,EAAAC,GACA,IAAAC,EAAA,EAGAC,EAAAC,YAAA,WACAC,SAAAC,eAAAN,KACAO,cAAAJ,GACAF,KAEAC,EAPA,KAQAK,cAAAJ,GAEAD,KACG,IAGHM,kBAAA,SAAAC,EAAAR,GACA,IAAAC,EAAA,EAGAC,EAAAC,YAAA,WAEA,IADA,IAAAM,GAAA,EACApB,EAAA,EAAgBA,EAAAmB,EAAApB,OAAcC,IAC9B,IAAAe,SAAAC,eAAAG,EAAAnB,IAAA,CACAoB,GAAA,EACA,MAGAA,IACAH,cAAAJ,GACAF,KAEAC,EAdA,KAeAK,cAAAJ,GAEAD,KACG,IAGHS,aAAA,SAAAC,GAGA,IAFA,IAAAC,EAAAC,EAAAC,EAAAH,EAAAvB,OAEA,IAAA0B,GACAD,EAAAE,KAAAC,MAAAD,KAAAE,SAAAH,GAIAF,EAAAD,EAHAG,GAAA,GAIAH,EAAAG,GAAAH,EAAAE,GACAF,EAAAE,GAAAD,EAEA,OAAAD,GAGAO,WAAA,SAAAC,EAAAC,EAAAtG,GACA,uBAAAsG,EACAlC,EAAAgC,WAAAC,EAAAC,EAAAC,MAAA,KAAAvG,GACG,IAAAsG,EAAAhC,aAAA7F,IAAAuB,GACHqG,EAAAC,EAAA,IAAAtG,EACAqG,EAAAC,EAAA,KACG,IAAAA,EAAAhC,OACH+B,EAEAjC,EAAAgC,WAAAC,EAAAC,EAAA,IAAAA,EAAAE,MAAA,GAAAxG,IAIAyG,cAAA,SAAAxB,GACA,IAAAyB,EAAApB,SAAAC,eAAAN,GACA0B,EAAA,EAAAC,EAAA,EACA,GAAAF,EAAA,CACA,IAAAG,EAAAH,EAAAI,UACAH,EAAAE,EAAAE,MACAH,EAAAC,EAAAG,YAEAjD,QAAAU,IAAA,0BAAAQ,EAAA,eAEA,OAAU0B,IAAAC,MASVK,cAAA,SAAAC,EAAAC,GACA,IAAAC,EAEAD,EAAApE,EAAAmE,EAAAnE,EAAAmE,EAAAP,GAGAQ,EAAApE,EAAAoE,EAAAR,EAAAO,EAAAnE,GAGAoE,EAAAnE,EAAAmE,EAAAP,EAAAM,EAAAlE,GAGAmE,EAAAnE,EAAAkE,EAAAlE,EAAAkE,EAAAN,EAGA,OAAAQ,GASAC,cAAA,SAAAC,EAAAC,IAGAD,EAAAE,OAAAF,GAAAG,QAAA,mBACAnD,OAAA,IACAgD,IAAA,GAAAA,EAAA,GAAAA,EAAA,GAAAA,EAAA,GAAAA,EAAA,GAAAA,EAAA,IAEAC,KAAA,EAIA,IADA,IAAAG,EAAA,IACAnD,EAAA,EAAeA,EAAA,EAAKA,IAAA,CACpB,IAAAoD,EAAAC,SAAAN,EAAAO,OAAA,EAAAtD,EAAA,OACAoD,EAAA1B,KAAA6B,MAAA7B,KAAA8B,IAAA9B,KAAA+B,IAAA,EAAAL,IAAAJ,GAAA,MAAAU,SAAA,IACAP,IAAA,KAAAC,GAAAE,OAAAF,EAAArD,QAGA,OAAAoD,GAaAQ,kBAAA,SAAAzE,GAOA,IANA,IAAA9D,EAAA8D,EAAAE,QAAAhE,KAAAQ,QACAiC,EAAAqB,EAAAE,QAAAxB,KAAAC,OAAAE,SAIA6F,EAAA,GACA5D,EAAA,EAAeA,EAAA5E,EAAA2E,OAAeC,IAC9B5E,EAAA4E,GAAAT,eAAA,SACAqE,EAAAzD,KAAA/E,EAAA4E,GAAAxF,OAEAoJ,EAAAzD,KAAAtC,EAAAmC,IAIA,OAAA4D,GAGAC,0BAAA,SAAAzI,EAAAM,GACA,IAAAoI,EACA,eAAApI,EAAAF,YACAsI,EAAAC,EAAAC,gBAAA5I,IAOA,IAHA,IAAA6I,EAAA,GACAC,EAAA,GACAC,EAAA,EACAnE,EAAA,EAAeA,EAAA5E,EAAA2E,OAAeC,IAC9B,kBAAAtE,EAAAF,UAAA,CACA,IAAA4I,EAAAhJ,EAAA4E,GAAAvE,MAAAqI,EAAA,IACA,GAAAM,GAAA1I,EAAAD,MAAA,CACAyI,EAAA/D,KAAA/E,EAAA4E,IACAmE,GAAA/I,EAAA4E,GAAAvE,MACA,SAEAL,EAAA4E,GAAAqE,WAAA,EACAJ,EAAA9D,KAAA/E,EAAA4E,QACI,CACJ,GAAA5E,EAAA4E,GAAAvE,OAAAC,EAAAD,MAAA,CACAyI,EAAA/D,KAAA/E,EAAA4E,IACAmE,GAAA/I,EAAA4E,GAAAvE,MACA,SAEAL,EAAA4E,GAAAqE,WAAA,EACAJ,EAAA9D,KAAA/E,EAAA4E,IAeA,OAVAkE,EAAAnE,QACAkE,EAAA9D,KAAA,CACA3F,MAAAkB,EAAAlB,MACAmB,MAAAD,EAAAC,MACAF,MAAA0I,EACAE,WAAA,EACAH,gBAIAD,GAIAK,UAAA,SAAAjE,EAAA7B,EAAAC,GACA4B,EAAAE,OAAA,UAAAC,KAAA,KAAAhC,GAAAgC,KAAA,KAAA/B,GAAA+B,KAAA,OAAAjE,MAAA,iBAGAgI,WAAA,SAAAC,GAEA,OAAAA,GAAA,sBADA,GACAd,SAAAe,KAAAD,IAGA1E,QAAA,SAAA4E,GACA,yBAAAC,OAAAC,UAAAlB,SAAAe,KAAAC,KAMAG,EAAA,WACA,IAAAzF,EAAA0F,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,UAAA,OACApF,EAAA,EACAD,EAAAqF,UAAArF,OACAsF,GAAA,EACA3B,EAAAiB,OAAAC,UAAAlB,SACA4B,EAAAX,OAAAC,UAAArF,eACAgG,EAAA,CACAC,mBAAA,UACAC,kBAAA,SACAC,kBAAA,SACAC,oBAAA,WACAC,iBAAA,QACAC,gBAAA,OACAC,kBAAA,SACAC,kBAAA,UAGAC,EAAA,CACAzB,WAAA,SAAAzC,GACA,mBAAAkE,EAAA7I,KAAA2E,IAEAhC,QAAAmG,MAAAnG,SACA,SAAAgC,GACA,gBAAAkE,EAAA7I,KAAA2E,IAEAoE,SAAA,SAAApE,GACA,cAAAA,SAAAzC,QAEA8G,UAAA,SAAArE,GACA,OAAA7B,MAAAmG,WAAAtE,KAAAuE,SAAAvE,IAEA3E,KAAA,SAAA2E,GACA,cAAAA,EAAAmB,OAAAnB,GAAAyD,EAAA7B,EAAAe,KAAA3C,KAAA,UAEAwE,cAAA,SAAAxE,GACA,IAAAA,GAAA,WAAAkE,EAAA7I,KAAA2E,MAAAyE,SACA,SAEA,IACA,GAAAzE,EAAA0E,cAAAlB,EAAAb,KAAA3C,EAAA,iBAAAwD,EAAAb,KAAA3C,EAAA0E,YAAA5B,UAAA,iBACA,SAEK,MAAA6B,GACL,SAEA,IAAAC,EACA,IAAAA,KAAA5E,GACA,YAAA5H,IAAAwM,GAAApB,EAAAb,KAAA3C,EAAA4E,KAeA,IAZA,kBAAAvB,IACAE,EAAAF,EACAA,EAAAC,UAAA,OACApF,EAAA,GAEA,iBAAAmF,GAAAa,EAAAzB,WAAAY,KACAA,EAAA,IAEApF,IAAAC,IACAmF,EAAAwB,OACA3G,GAEQA,EAAAD,EAAYC,IACpB,WAAAZ,EAAAgG,UAAApF,IACA,IAAA8E,KAAA1F,EACA2F,EAAAI,EAAAL,GACAE,EAAA5F,EAAA0F,GACAK,IAAAH,IAGAK,GAAAL,IAAAgB,EAAAM,cAAAtB,KAAAC,EAAAe,EAAAlG,QAAAkF,MACAC,GACAA,GAAA,EACAC,EAAAH,GAAAiB,EAAAlG,QAAAiF,KAAA,IAEAG,EAAAH,GAAAiB,EAAAM,cAAAvB,KAAA,GAGAI,EAAAL,GAAAD,EAAAQ,EAAAH,EAAAF,SACK9K,IAAA8K,IACLG,EAAAL,GAAAE,IAKA,OAAAG,GAGApB,EAAA,CAEA6C,UAAA,SAAAC,GACA,OAAAA,GAAAnF,KAAAoF,GAAA,MAGAC,UAAA,SAAAC,GACA,OAAAA,GAAA,IAAAtF,KAAAoF,KAGAG,iBAAA,SAAA/H,GACA,IAAAnE,EAAAmE,EAAAE,QAAArE,KACAmD,EAAAgB,EAAAE,QAAAxB,KAAAM,cAQAkE,EAAArH,EAAAE,YAAAiD,EAAAI,KAAAJ,EAAAE,MACAiE,EAAAtH,EAAAC,aAAAkD,EAAAC,IAAAD,EAAAG,OAGA,eAAAa,EAAAE,QAAA/E,OAAAO,WACAyH,GAAAnD,EAAAgI,eAAAC,cAGAjI,EAAAgI,eAAApM,OAAAsM,SACA/E,GAAAnD,EAAAgI,eAAApM,OAAAuH,GAMA,IACAgF,EAAAC,EADAC,GAAAnF,GAFAC,IAAA,IAAAA,GAEAD,EAAAC,GAAA,EAIA,UAAAtH,EAAAI,eACA,OAAAyE,KAAA7E,EAAAI,gBAAA,CAGAmM,GADAA,GADAA,EAAAjE,SAAAtI,EAAAI,eAAA+H,QAAA,gBACA,MAAAoE,GACA,IAAAA,EAEA,IAAAE,EAAApF,EAAAC,EAAAD,EAAAC,EAGA,YAAAnD,EAAAE,QAAAvD,OAAAC,MAAAC,OAAA,CACA,IAAA0L,EAAA,EAAApE,SAAAnE,EAAAE,QAAAvD,OAAAC,MAAAG,YAAA,IACAuL,EAAAC,EAAA,IACAD,GAAAC,GAIAF,EAAA7F,KAAAC,MAAA6F,EAAA,IAAAF,GAAA,OAEAC,EAAAlE,SAAAtI,EAAAI,eAAA,IAKA,IAAAyE,KAAA7E,EAAAG,iBAGAoM,GADAA,GADAA,EAAAjE,SAAAtI,EAAAG,eAAAgI,QAAA,gBACA,MAAAoE,GACA,IAAAA,EACAD,EAAA3F,KAAAC,MAAA4F,EAAA,IAAAD,IAEAD,EAAAhE,SAAAtI,EAAAG,eAAA,IAGAgE,EAAAmI,cACAnI,EAAAqI,eAGAvD,gBAAA,SAAA5I,GAEA,IADA,IAAA0I,EAAA,EACA9D,EAAA,EAAeA,EAAA5E,EAAA2E,OAAeC,IAC9B8D,GAAA1I,EAAA4E,GAAAvE,MAEA,OAAAqI,GAGA4D,YAAA,SAAAxI,GACA,IAAA9D,EAAA8D,EAAAE,QAAAhE,KAAAQ,QACAP,EAAA6D,EAAAE,QAAAhE,KAAAC,UAEA,OAAAA,GACA,WAEA,MACA,aACAD,EAAAyE,EAAAwB,aAAAjG,GACA,MACA,gBACAA,EAAAuM,KAAA,SAAAC,EAAAC,GAA8B,OAAAD,EAAAnM,MAAAoM,EAAApM,OAAA,MAC9B,MACA,iBACAL,EAAAuM,KAAA,SAAAC,EAAAC,GAA8B,OAAAD,EAAAnM,MAAAoM,EAAApM,MAAA,OAC9B,MACA,gBACAL,EAAAuM,KAAA,SAAAC,EAAAC,GAA8B,OAAAD,EAAAjM,MAAAmM,cAAAD,EAAAlM,MAAAmM,cAAA,OAC9B,MACA,iBACA1M,EAAAuM,KAAA,SAAAC,EAAAC,GAA8B,OAAAD,EAAAjM,MAAAmM,cAAAD,EAAAlM,MAAAmM,cAAA,OAI9B,OAAA1M,GAMA2M,sBAAA,SAAAC,GACA,mBAAAA,EAAAxJ,EAAA,IAAAwJ,EAAAvJ,EAAA,KAQAwJ,mBAAA,SAAA/I,GACA,IAAAX,EAAAW,EAAAE,QAAAxB,KAAAW,gBACA2J,EAAAhJ,EAAAgI,eAAA5M,MAAA8M,QAAA,eAAAlI,EAAAE,QAAA/E,OAAAO,SACAuN,EAAAjJ,EAAAgI,eAAAvM,SAAAyM,QAAA,eAAAlI,EAAAE,QAAA/E,OAAAO,SAEAwN,EAAAlJ,EAAAE,QAAAxB,KAAAM,cAAAC,IACA+J,GAAAC,EACAC,GAAAlJ,EAAAgI,eAAA5M,MAAA+H,EAAAnD,EAAAE,QAAA/E,OAAAQ,qBAAAqE,EAAAgI,eAAAvM,SAAA0H,EACG6F,EACHE,GAAAlJ,EAAAgI,eAAA5M,MAAA+H,EACG8F,IACHC,GAAAlJ,EAAAgI,eAAAvM,SAAA0H,GAGA,IAAAgG,EAAA,EACAnJ,EAAAgI,eAAApM,OAAAsM,SACAiB,EAAAnJ,EAAAgI,eAAApM,OAAAuH,EAAAnD,EAAAE,QAAAxB,KAAAM,cAAAG,QAGA,IAAAG,GAAAU,EAAAE,QAAArE,KAAAE,YAAAiE,EAAAE,QAAAxB,KAAAM,cAAAI,KAAAY,EAAAE,QAAAxB,KAAAM,cAAAE,OAAA,EAAAc,EAAAE,QAAAxB,KAAAM,cAAAI,KACAG,GAAAS,EAAAE,QAAArE,KAAAC,aAAAqN,EAAAD,GAAA,EAAAA,EAEA5J,GAAAD,EAAAC,EACAC,GAAAF,EAAAE,EAEAS,EAAA8I,UAAA,CAAmBxJ,IAAAC,MAanB6J,OAAA,SAAA9J,EAAAC,EAAA8J,EAAAC,EAAAZ,GAEAA,IAAAlG,KAAAoF,GAAA,IAEA,IAAA2B,EAAA/G,KAAA+G,IACAC,EAAAhH,KAAAgH,IAEAC,GAAAnK,EAAA+J,GAAAE,EAAAb,IAAAnJ,EAAA+J,GAAAE,EAAAd,GAAAW,EACAK,GAAApK,EAAA+J,GAAAG,EAAAd,IAAAnJ,EAAA+J,GAAAC,EAAAb,GAAAY,EAEA,OAAUhK,EAAAmK,EAAAlK,EAAAmK,IAUVC,UAAA,SAAArK,EAAAC,EAAAqK,EAAAlB,GACA,IAAAmB,EAAAhF,EAAA6C,UAAAgB,GACA,OACApJ,IAAAsK,EAAApH,KAAAgH,IAAAK,GACAtK,IAAAqK,EAAApH,KAAA+G,IAAAM,KAKAC,aAAA,SAAAC,EAAAC,EAAAC,GAGA,IAAAxG,EAAAwG,EAAA9B,aAAA8B,CAAAD,GACAtG,EAAAuG,EAAA5B,aAAA4B,CAAAD,GACAE,EAAAD,EAAAE,YAAAF,CAAAD,GACAI,EAAAH,EAAAI,UAAAJ,CAAAD,GAEAM,EAAAP,EAAAzK,EAAAyK,EAAAzK,EAAAyK,EAAAxK,EAAAwK,EAAAxK,EACAgL,EAAA/H,KAAAgI,MAAAT,EAAAzK,GAAAyK,EAAAxK,GAIA,OAFAgL,IAAA,EAAAA,EAAA,EAAA/H,KAAAoF,GAAA2C,EAEA9G,KAAA6G,MAAA5G,KACAwG,GAAAK,MAAAH,IAKAzN,EAAA,CASA8N,IAAA,SAAAzK,EAAA0K,EAAAC,GACA,IAAAC,EAAAjO,EAAAkO,YAAAF,GACAG,EAAA9K,EAAAE,QAAAvD,OAGAoO,EAAA/K,EAAAmB,IAAA6J,OAAA,QAAAhL,EAAAR,UAAA,UAAAkL,GACApJ,KAAA,QAAAtB,EAAAR,UAAA,UAAAkL,GAEAO,EAAAF,EAAAG,UAAA,IAAAlL,EAAAR,UAAA,cAAAkL,GACAxO,KAAA8D,EAAAE,QAAAhE,KAAAQ,SACAyO,QACA9J,OAAA,KACAC,KAAA,cAAAsI,EAAA9I,GAA+B,OAAAd,EAAAR,UAAA,aAAAsB,EAAA,IAAA4J,IAC/BpJ,KAAA,sBAAAsI,EAAA9I,GAAuC,OAAAA,IACvCQ,KAAA,QAAAtB,EAAAR,UAAA,cAAAkL,GACArN,MAAA,aAEA+N,EAAA,CAA4BV,UAAAC,sBAG5BC,EAAA3N,WACAgO,EAAA5J,OAAA,QACAC,KAAA,cAAAsI,EAAA9I,GAAgC,OAAAd,EAAAR,UAAA,mBAAAsB,EAAA,IAAA4J,IAChCpJ,KAAA,QAAAtB,EAAAR,UAAA,oBAAAkL,GACArP,KAAA,SAAAuO,EAAA9I,GACA,IAAAuK,EAAAzB,EAAAnN,MAaA,OATAqO,EAAAtN,WACA4N,EAAAE,MAAAxK,EACAsK,EAAAG,KAAA,YACAH,EAAA7O,MAAAqN,EAAArN,MACA6O,EAAA3O,MAAA4O,EACAA,EAAAP,EAAAtN,UAAA4N,IACWN,EAAAxN,WAAAjB,SAAAuN,EAAAnN,MAAAoE,OAAAiK,EAAAxN,WAAAC,iBACX8N,EAAAzB,EAAAnN,MAAA+O,UAAA,EAAAV,EAAAxN,WAAAC,gBAAA,OAEA8N,IAEAhO,MAAA,YAAAyN,EAAA7N,UAAA1B,SAAA,MACA8B,MAAA,cAAAyN,EAAA7N,UAAAzB,MACA6B,MAAA,OAAAyN,EAAA7N,UAAA3B,OAIAsP,EAAA1N,YACA+N,EAAA5J,OAAA,QACAC,KAAA,cAAAsI,EAAA9I,GAAgC,OAAAd,EAAAR,UAAA,oBAAAsB,EAAA,IAAA4J,IAChCpJ,KAAA,QAAAtB,EAAAR,UAAA,qBAAAkL,GACArP,KAAA,SAAAuO,EAAA9I,GACA,IAAA5D,EAAA2B,EAAA4M,cAAAzL,EAAAc,EAAAd,EAAAE,QAAAvD,OAAAO,WAAAC,eAUA,OATA2N,EAAAtN,WACA4N,EAAAE,MAAAxK,EACAsK,EAAAG,KAAA,aACAH,EAAA7O,MAAAqN,EAAArN,MACA6O,EAAA3O,MAAAS,EACAA,EAAA4N,EAAAtN,UAAA4N,IAEAlO,GAAA,IAEAA,IAEAG,MAAA,YAAAyN,EAAA5N,WAAA3B,SAAA,MACA8B,MAAA,cAAAyN,EAAA5N,WAAA1B,MACA6B,MAAA,OAAAyN,EAAA5N,WAAA5B,OAIAsP,EAAArO,OACA0O,EAAA5J,OAAA,QACAC,KAAA,cAAAsI,EAAA9I,GAAgC,OAAAd,EAAAR,UAAA,eAAAsB,EAAA,IAAA4J,IAChCpJ,KAAA,QAAAtB,EAAAR,UAAA,gBAAAkL,GACArP,KAAA,SAAAuO,EAAA9I,GAKA,OAJAsK,EAAAE,MAAAxK,EACAsK,EAAAG,KAAA,QACAH,EAAA7O,MAAAqN,EAAArN,MACA6O,EAAA3O,MAAAmN,EAAArN,MACAuO,EAAAtN,UAAAsN,EAAAtN,UAAA4N,EAAAxB,EAAArN,OAAAqN,EAAArN,QAEAc,MAAA,YAAAyN,EAAAvO,MAAAhB,SAAA,MACA8B,MAAA,cAAAyN,EAAAvO,MAAAf,MACA6B,MAAA,OAAAyN,EAAAvO,MAAAjB,QAOAoQ,sBAAA,SAAA1L,EAAA0K,EAAAC,GACAhO,EAAA,cAAA+N,GAAA,GAGA,IAAAiB,EAAAvL,GAAA8K,UAAA,IAAAlL,EAAAR,UAAA,cAAAkL,GACAiB,EAAAC,KAAA,SAAAhC,EAAA9I,GACA,IAAA7D,EAAAmD,GAAAgB,OAAAqG,MAAAyD,UAAA,IAAAlL,EAAAR,UAAA,oBAAAkL,GACAxN,EAAAkD,GAAAgB,OAAAqG,MAAAyD,UAAA,IAAAlL,EAAAR,UAAA,qBAAAkL,GACAnO,EAAA6D,GAAAgB,OAAAqG,MAAAyD,UAAA,IAAAlL,EAAAR,UAAA,gBAAAkL,GAEA/N,EAAA,cAAA+N,GAAAzJ,KAAA,CACAhE,UAAA,OAAAA,EAAA4O,OAAA5O,EAAA4O,OAAAxI,UAAA,KACAnG,WAAA,OAAAA,EAAA2O,OAAA3O,EAAA2O,OAAAxI,UAAA,KACA9G,MAAA,OAAAA,EAAAsP,OAAAtP,EAAAsP,OAAAxI,UAAA,SAIA,IACAyI,EAAAnP,EAAA,cAAA+N,GACA,OAAAC,GACA,mBACAvK,GAAA8K,UAAA,IAAAlL,EAAAR,UAAA,gBAAAkL,GACApJ,KAAA,cAAAsI,EAAA9I,GAAiC,OAAAgL,EAAAhL,GAAA7D,UAAAqG,MALjC,IAMA,MACA,mBACAlD,GAAA8K,UAAA,IAAAlL,EAAAR,UAAA,gBAAAkL,GACApJ,KAAA,cAAAsI,EAAA9I,GAAiC,OAAAgL,EAAAhL,GAAA7D,UAAAsG,SACjC,MACA,wBACAnD,GAAA8K,UAAA,IAAAlL,EAAAR,UAAA,qBAAAkL,GACApJ,KAAA,cAAAsI,EAAA9I,GAAiC,OAAAgL,EAAAhL,GAAA7D,UAAAqG,MAbjC,IAcA,MACA,wBACAlD,GAAA8K,UAAA,IAAAlL,EAAAR,UAAA,qBAAAkL,GACApJ,KAAA,cAAAsI,EAAA9I,GAAiC,OAAAgL,EAAAhL,GAAA7D,UAAAqG,MAAA,EAAAwI,EAAAhL,GAAA5D,WAAAoG,MAAA,IACjChC,KAAA,cAAAsI,EAAA9I,GAAiC,OAAAgL,EAAAhL,GAAA7D,UAAAsG,WAKjCwI,0BAAA,SAAA/L,GACAA,EAAAgM,gBAAA,GACA5L,GAAA8K,UAAA,IAAAlL,EAAAR,UAAA,oBACAoM,KAAA,SAAAhC,EAAA9I,GAAyB,OAAAnE,EAAAsP,oBAAAjM,EAAAc,MAGzBmL,oBAAA,SAAAjM,EAAAc,GACA,IAOAoL,EAAAC,EAAAC,EAAAC,EAPA9B,EAAA1L,EAAAyN,gBAAAxL,EAAAd,EAAAE,QAAAhE,KAAAQ,QAAAsD,EAAA4E,UAAA,CAAoF2H,UAAA,IACpFC,EAAA3H,EAAAuE,OAAApJ,EAAA8I,UAAAxJ,EAAAU,EAAA8I,UAAAvJ,EAAAS,EAAAqI,YAAArI,EAAA8I,UAAAxJ,EAAAU,EAAA8I,UAAAvJ,EAAAgL,GACAkC,EAAAzM,EAAA0M,oBAAA5L,GAAAqC,EAAA,EAGAwJ,EAAAnK,KAAAC,MAAA8H,EAAA,IASA,OAJA,IAAAoC,GAAA,MAAApC,IACAoC,EAAA,GAGAA,GACA,OACAT,EAAAlM,EAAA0M,oBAAA5L,GAAAxB,EAbA,GAaAU,EAAA0M,oBAAA5L,GAAAxB,EAbA,EAaAkN,EAAAlN,GAAA,EACA6M,EAAAnM,EAAA0M,oBAAA5L,GAAAvB,GAAAiN,EAAAjN,EAAAS,EAAA0M,oBAAA5L,GAAAvB,GAXA,EAYA6M,EAAApM,EAAA0M,oBAAA5L,GAAAxB,EAfA,EAgBA+M,EAAArM,EAAA0M,oBAAA5L,GAAAvB,EAAAkN,EACA,MACA,OACAP,EAAAM,EAAAlN,GAAAU,EAAA0M,oBAAA5L,GAAAxB,EAAAkN,EAAAlN,GAhBA,EAiBA6M,EAAAK,EAAAjN,GAAAS,EAAA0M,oBAAA5L,GAAAvB,EAAAiN,EAAAjN,GAjBA,EAkBA6M,EAAApM,EAAA0M,oBAAA5L,GAAAxB,EArBA,EAsBA+M,EAAArM,EAAA0M,oBAAA5L,GAAAvB,EAAAkN,EACA,MACA,OACA,IAAAG,EAAA5M,EAAA0M,oBAAA5L,GAAAxB,EAAAU,EAAA0M,oBAAA5L,GAAAoC,EAzBA,EA0BAgJ,EAAAM,EAAAlN,GAAAkN,EAAAlN,EAAAsN,GAvBA,EAwBAT,EAAAK,EAAAjN,GAAAS,EAAA0M,oBAAA5L,GAAAvB,EAAAiN,EAAAjN,GAxBA,EAyBA6M,EAAApM,EAAA0M,oBAAA5L,GAAAxB,EAAAU,EAAA0M,oBAAA5L,GAAAoC,EA5BA,EA6BAmJ,EAAArM,EAAA0M,oBAAA5L,GAAAvB,EAAAkN,EACA,MACA,OACA,IAAAI,EAAA7M,EAAA0M,oBAAA5L,GAAAxB,EAAAU,EAAA0M,oBAAA5L,GAAAoC,EAhCA,EAiCAgJ,EAAAW,GAAAL,EAAAlN,EAAAuN,GA9BA,EA+BAV,EAAAnM,EAAA0M,oBAAA5L,GAAAvB,GAAAiN,EAAAjN,EAAAS,EAAA0M,oBAAA5L,GAAAvB,GA/BA,EAgCA6M,EAAApM,EAAA0M,oBAAA5L,GAAAxB,EAAAU,EAAA0M,oBAAA5L,GAAAoC,EAnCA,EAoCAmJ,EAAArM,EAAA0M,oBAAA5L,GAAAvB,EAAAkN,EASA,aAAAzM,EAAAE,QAAAvD,OAAAS,MAAAC,MACA2C,EAAAgM,gBAAAlL,GAAA,CACA,CAAKxB,EAAAkN,EAAAlN,EAAAC,EAAAiN,EAAAjN,GACL,CAAKD,EAAA8M,EAAA7M,EAAA8M,IAGLrM,EAAAgM,gBAAAlL,GAAA,CACA,CAAKxB,EAAAkN,EAAAlN,EAAAC,EAAAiN,EAAAjN,GACL,CAAKD,EAAA4M,EAAA3M,EAAA4M,GACL,CAAK7M,EAAA8M,EAAA7M,EAAA8M,KAKLS,cAAA,SAAA9M,GACA,IAAA+M,EAAA/M,EAAAmB,IAAA6J,OAAA,QAAAhL,EAAAR,UAAA,YACA8B,KAAA,QAAAtB,EAAAR,UAAA,cACAnC,MAAA,aAEA2P,EAAAD,EAAA7B,UAAA,IAAAlL,EAAAR,UAAA,aACAtD,KAAA8D,EAAAgM,iBACAb,QACA9J,OAAA,KACAC,KAAA,QAAAtB,EAAAR,UAAA,aAEAyN,EAAA7M,GAAAe,IAAA+L,OACAC,YAAA,SACA7N,EAAA,SAAAsK,GAAmB,OAAAA,EAAAtK,IACnBC,EAAA,SAAAqK,GAAmB,OAAAA,EAAArK,IAEnByN,EAAA3L,OAAA,QACAC,KAAA,IAAA2L,GACA3L,KAAA,kBAAAsI,EAAA9I,GACA,kBAAAd,EAAAE,QAAAvD,OAAAS,MAAA9B,MAAA0E,EAAAE,QAAAvB,OAAAmC,GAAAd,EAAAE,QAAAvD,OAAAS,MAAA9B,QAEAgG,KAAA,kBACAA,KAAA,eACAjE,MAAA,mBAAAuM,EAAA9I,GACA,IAAA5D,EAAA8C,EAAAE,QAAAvD,OAAAC,MAAAE,2BACAsQ,EAAAvO,EAAA4M,cAAAzL,EAAAc,EAAAd,EAAAE,QAAAvD,OAAAO,WAAAC,eACAkQ,EAAA,OAAAnQ,GAAAkQ,EAAAlQ,GAAA,KAAA8C,EAAAE,QAAAhE,KAAAQ,QAAAoE,GAAArE,MACA,OAAA4Q,EAAA,OAIAC,oBAAA,SAAAtN,EAAA0K,GACA,SAAA1K,EAAAE,QAAAvD,OAAA+N,GAAA7N,QAIAuD,GAAA8K,UAAA,IAAAlL,EAAAR,UAAA,cAAAkL,GACArN,MAAA,aACAiE,KAAA,qBAAAsI,EAAA9I,GACA,IAAAxB,EAAAC,EACA,aAAAmL,EACApL,EAAAU,EAAA0M,oBAAA5L,GAAAxB,EACAC,EAAAS,EAAA0M,oBAAA5L,GAAAvB,MACK,CACL,IAAAgO,EAAA5H,GAAA,KAAwC3F,EAAA8I,WAGxC,GAAA9I,EAAAmI,YAAA,GACA,IAAAoC,EAAA1L,EAAAyN,gBAAAxL,EAAAd,EAAAE,QAAAhE,KAAAQ,QAAAsD,EAAA4E,UAAA,CAAwF2H,UAAA,IACxFiB,EAAA3I,EAAA8E,UAAA3J,EAAA8I,UAAAxJ,EAAAU,EAAA8I,UAAAvJ,EAAAS,EAAAmI,YAAAoC,GACAgD,EAAAjO,EAAAkO,EAAAlO,EACAiO,EAAAhO,EAAAiO,EAAAjO,EAGA,IAAAuM,EAAAnL,EAAAqC,cAAAhD,EAAAR,UAAA,aAAAsB,EAAA,UACA2M,EAAA3B,EAAA5I,EAAA,EACAwK,EAAA5B,EAAA3I,EAAA,EAEA7D,EAAAiO,EAAAjO,GAAAU,EAAAgM,gBAAAlL,GAAA,GAAAxB,EAAAiO,EAAAjO,GAAA,IACAC,EAAAgO,EAAAhO,GAAAS,EAAAgM,gBAAAlL,GAAA,GAAAvB,EAAAgO,EAAAhO,GAAA,IAEAD,GAAAmO,EACAlO,GAAAmO,EAGA,mBAAApO,EAAA,IAAAC,EAAA,OAKAoO,qBAAA,SAAA3N,GAGA,IAAA4N,EAAA,YAAA5N,EAAAE,QAAAzC,QAAAC,KAAAC,OAAAqC,EAAAE,QAAAzC,QAAAC,KAAAE,MAAA,EACAiQ,WAAA,WACA,IAAAC,EAAA,YAAA9N,EAAAE,QAAAzC,QAAAC,KAAAC,OAAA,MAEAyC,GAAA8K,UAAA,IAAAlL,EAAAR,UAAA,oBACAuO,aACAC,SAAAF,GACAzQ,MAAA,mBAAAuM,EAAA9I,GACA,IAAA5D,EAAA8C,EAAAE,QAAAvD,OAAAC,MAAAE,2BACAsQ,EAAAvO,EAAA4M,cAAAzL,EAAAc,EAAAd,EAAAE,QAAAvD,OAAAO,WAAAC,eACA,cAAAD,GAAAkQ,EAAAlQ,EAAA,MAGAkD,GAAA8K,UAAA,IAAAlL,EAAAR,UAAA,oBACAuO,aACAC,SAAAF,GACAzQ,MAAA,mBAAAuM,EAAA9I,GACA,IAAA5D,EAAA8C,EAAAE,QAAAvD,OAAAK,MAAAF,2BACAsQ,EAAAvO,EAAA4M,cAAAzL,EAAAc,EAAAd,EAAAE,QAAAvD,OAAAO,WAAAC,eACA,cAAAD,GAAAkQ,EAAAlQ,EAAA,MAGAkD,GAAA8K,UAAA,KAAAlL,EAAAR,UAAA,cACAuO,aACAC,SAAAF,GACAzQ,MAAA,aAGAsD,EAAA0E,WAAArF,EAAAE,QAAAT,UAAAC,SACAmO,WAAA,WACA,IACA7N,EAAAE,QAAAT,UAAAC,SACM,MAAA6H,MACDuG,IAEFF,IAGH/C,YAAA,SAAAoD,GACA,IAAAC,GAAA,EACAC,GAAA,EACAC,GAAA,EAEA,OAAAH,GACA,YACAC,GAAA,EACA,MACA,YACAC,GAAA,EACA,MACA,iBACAC,GAAA,EACA,MACA,mBACA,mBACAF,GAAA,EACAC,GAAA,EACA,MACA,wBACA,wBACAD,GAAA,EACAE,GAAA,EAGA,OACAnR,UAAAiR,EACA3R,MAAA4R,EACAjR,WAAAkR,IAUAC,wBAAA,SAAArO,GAGAA,EAAAmB,IAAA+J,UAAA,IAAAlL,EAAAR,UAAA,oBACAoM,KAAA,SAAAhC,EAAA9I,GACA,OAAAnE,EAAA2R,4BAAAtO,EAAAc,KAIAnE,EAAA4R,4BAAAvO,IAMAuO,4BAAA,SAAAvO,GACA,YAAAA,EAAAE,QAAAvD,OAAAC,MAAAC,OAAA,CAIA,IAAAhB,EAAAmE,EAAAE,QAAAhE,KAAAQ,QAAAmE,OACAlE,EAAA6R,cAAAxO,EAAA,cAAAnE,GACAc,EAAA6R,cAAAxO,EAAAnE,EAAA,kBAAAA,KAGA2S,cAAA,SAAAxO,EAAAyO,EAAAC,EAAA7S,GACA,IAAAiF,EAAA6N,EAEA,KAAA9S,GAAA,IAIA,IAAA+S,EAAA5O,EAAA0M,oBAAA+B,GAAAI,GACA,mBAAAH,GAAA,UAAAE,GAGA,kBAAAF,GAAA,SAAAE,GAAA,CAGA,IAAAE,EAAA,cAAAJ,EAAAD,EAAA,EAAAA,EAAA,EAIAM,EAAA/O,EAAA0M,oBAAA+B,GAGAO,EAAAhP,EAAA0M,oBAAAoC,GAEAG,EAAA,CACAC,aAAAlP,EAAA0M,oBAAA,GAAAvJ,EACAgM,OAAAnP,EAAA8I,UACAsG,WAAApP,EAAAqI,YAAArI,EAAAE,QAAAvD,OAAAC,MAAAG,YACAsS,aAAArP,EAAA0M,oBAAA,GAAAvJ,EAAA,GAKA,iBAAAuL,GAEA,IADA5N,EAAA,EACSA,GAAA2N,EAAc3N,IAKvB,GAJA6N,EAAA3O,EAAA0M,oBAAA5L,GAIAH,EAAA6C,cAAAmL,EAAAK,GAAA,CACArS,EAAA2S,eAAAtP,EAAA8O,EAAAC,EAAAE,GACA,YAKA,IADAnO,EAAAjF,EAAA,EACSiF,GAAA2N,EAAgB3N,IAKzB,GAJA6N,EAAA3O,EAAA0M,oBAAA5L,GAIAH,EAAA6C,cAAAmL,EAAAK,GAAA,CACArS,EAAA2S,eAAAtP,EAAA8O,EAAAC,EAAAE,GACA,MAIAtS,EAAA6R,cAAAxO,EAAA8O,EAAAJ,EAAA7S,MAIAyT,eAAA,SAAAtP,EAAA8O,EAAAS,EAAAN,GACA,IAAAO,EAAAC,EAAAC,EAAAC,EACAA,EAAAJ,EAAAhQ,EAAA0P,EAAAI,aACAI,EAAAR,EAAAE,OAAA5P,EAAAoQ,EAGAH,EADAhN,KAAAoN,IAAAX,EAAAG,YAAA5M,KAAAoN,IAAAH,GACAjN,KAAAqN,KAAAZ,EAAAG,WAAAH,EAAAG,WAAAK,KAEAjN,KAAAqN,KAAAJ,IAAAR,EAAAG,WAAAH,EAAAG,YAIAM,EADA,UAAAH,EAAAV,GACAI,EAAAE,OAAA7P,EAAAkQ,EAEAP,EAAAE,OAAA7P,EAAAkQ,EAAAxP,EAAA0M,oBAAAoC,GAAA5L,EAGAlD,EAAA0M,oBAAAoC,GAAAxP,EAAAoQ,EACA1P,EAAA0M,oBAAAoC,GAAAvP,EAAAoQ,GAMArB,4BAAA,SAAAtO,EAAAc,GACA,IAAAgP,EAAA1P,GAAAgB,OAAA,IAAApB,EAAAR,UAAA,aAAAsB,EAAA,UAAA+K,OACA,GAAAiE,EAAA,CAGA,IAAAC,EAAAD,EAAAzM,UACAkH,EAAA1L,EAAAyN,gBAAAxL,EAAAd,EAAAE,QAAAhE,KAAAQ,QAAAsD,EAAA4E,UAAA,CAAoF2H,UAAA,IAEpFyD,EAAAhQ,EAAA8I,UAAAxJ,EACA2Q,EAAAjQ,EAAA8I,UAAAvJ,GAAAS,EAAAqI,YAAArI,EAAAE,QAAAvD,OAAAC,MAAAG,aACAyQ,EAAA3I,EAAAuE,OAAA4G,EAAAC,EAAAjQ,EAAA8I,UAAAxJ,EAAAU,EAAA8I,UAAAvJ,EAAAgL,GAGA2F,EAAA,QACA3F,EAAA,KACAiD,EAAAlO,GAAAyQ,EAAAzM,MAAA,EACA4M,EAAA,QAEA1C,EAAAlO,GAAA,EAGAU,EAAA0M,oBAAA5L,GAAA,CACAxB,EAAAkO,EAAAlO,EACAC,EAAAiO,EAAAjO,EACA2D,EAAA6M,EAAAzM,MACAH,EAAA4M,EAAAxM,OACAsL,GAAAqB,MAMArR,EAAA,CAMAsR,OAAA,SAAAnQ,GACA,IAAA8I,EAAA9I,EAAA8I,UACAnK,EAAAqB,EAAAE,QAAAvB,OACAyR,EAAApQ,EAAAE,QAAAzC,QAAAC,KACAoB,EAAAkB,EAAAE,QAAAxB,KAAAC,OAAAG,cAGAuR,EAAArQ,EAAAmB,IAAA6J,OAAA,QAAAhL,EAAAR,UAAA,SACA8B,KAAA,uBAAkC,OAAAuD,EAAAgE,sBAAAC,KAClCxH,KAAA,QAAAtB,EAAAR,UAAA,YAEA8Q,EAAAlQ,GAAAe,IAAAmP,MACAnI,YAAAnI,EAAAmI,aACAE,YAAArI,EAAAqI,aACA8B,WAAA,GACAE,SAAA,SAAAT,GACA,OAAAA,EAAArN,MAAAyD,EAAA4E,UAAA,EAAApC,KAAAoF,KAGA2I,EAAAF,EAAAnF,UAAA,IAAAlL,EAAAR,UAAA,OACAtD,KAAA8D,EAAAE,QAAAhE,KAAAQ,SACAyO,QACA9J,OAAA,KACAC,KAAA,QAAAtB,EAAAR,UAAA,OAGAoO,EAAAwC,EAAAxS,MACA,SAAAwS,EAAAzS,SACAiQ,EAAA,GAGA2C,EAAAlP,OAAA,QACAC,KAAA,cAAAsI,EAAA9I,GAA+B,OAAAd,EAAAR,UAAA,UAAAsB,IAC/BQ,KAAA,gBAAAsI,EAAA9I,GACA,IAAAxF,EAAAqD,EAAAmC,GAIA,OAHAd,EAAAE,QAAAxB,KAAAK,SAAA1C,UACAf,EAAA,QAAA0E,EAAAR,UAAA,OAAAsB,EAAA,KAEAxF,IAEA+B,MAAA,SAAAyB,GACAzB,MAAA,kBACA0Q,aACAyC,KAAA,gBACAxC,SAAAJ,GACAtM,KAAA,sBAAAsI,EAAA9I,GAAuC,OAAAA,IACvC2P,UAAA,aAAA9H,GACA,IAAA7H,EAAAV,GAAA+M,YAAA,CAA4B5Q,MAAA,GAAWoM,GACvC,gBAAA+H,GACA,OAAA1Q,EAAAsQ,IAAAxP,EAAA4P,OAIA1Q,EAAAmB,IAAA+J,UAAA,KAAAlL,EAAAR,UAAA,OACA8B,KAAA,YACA,SAAAsI,EAAA9I,GACA,IAAAyJ,EAAA,EAIA,OAHAzJ,EAAA,IACAyJ,EAAA1L,EAAAyN,gBAAAxL,EAAA,EAAAd,EAAAE,QAAAhE,KAAAQ,QAAAsD,EAAA4E,YAEA,UAAA2F,EAAA,MAGAvK,EAAAsQ,OAGAK,aAAA,SAAA3Q,GACA,IAAA4Q,EAAA5Q,EAAAmB,IAAAE,OAAA,QACA6J,UAAA,kBACAhP,KAAA8D,EAAAE,QAAAhE,KAAAQ,SACAyO,QAAA9J,OAAA,kBACAC,KAAA,kCACAA,KAAA,QACAA,KAAA,QACAA,KAAA,YACAA,KAAA,cAAAsI,EAAA9I,GAA+B,OAAAd,EAAAR,UAAA,OAAAsB,IAE/B8P,EAAAvP,OAAA,QAAAC,KAAA,eAAAjE,MAAA,sBAAAuM,EAAA9I,GAAgF,OAAAd,EAAAE,QAAAvB,OAAAmC,KAChF8P,EAAAvP,OAAA,QAAAC,KAAA,SAAAtB,EAAAE,QAAAxB,KAAAK,SAAA7B,WAAA,KAAAG,MAAA,aAAA2C,EAAAE,QAAAxB,KAAAK,SAAAzD,QAGAuV,wBAAA,SAAA7Q,GACA,IAAAsQ,EAAAlQ,GAAA8K,UAAA,IAAAlL,EAAAR,UAAA,QAAAQ,EAAAR,UAAA,qBAAAQ,EAAAR,UAAA,oBAEA8Q,EAAAQ,GAAA,mBACA,IACAC,EADAC,EAAA5Q,GAAAgB,OAAAqG,MAIA,GAAAuJ,EAAA1P,KAAA,WAAAtB,EAAAR,UAAA,MACAuR,EAAAC,EAAA5P,OAAA,YACI,CACJ,IAAAkK,EAAA0F,EAAA1P,KAAA,cACAyP,EAAA3Q,GAAAgB,OAAA,IAAApB,EAAAR,UAAA,UAAA8L,GAEA,IAAA2F,EAAAF,EAAAzP,KAAA,WAAAtB,EAAAR,UAAA,WACAX,EAAAqS,eAAAlR,IAAAE,QAAAT,UAAAI,eAAAkR,EAAAE,GACA,SAAAjR,EAAAE,QAAAzC,QAAAI,sBAAAF,SACAsT,EACApS,EAAAsS,aAAAnR,EAAA+Q,EAAAlF,QAEAhN,EAAAuS,YAAApR,EAAA+Q,EAAAlF,WAKAyE,EAAAQ,GAAA,uBACA,IACAC,EAAAzF,EADA0F,EAAA5Q,GAAAgB,OAAAqG,MAUA,GAPAuJ,EAAA1P,KAAA,WAAAtB,EAAAR,UAAA,MACAuR,EAAAC,EAAA5P,OAAA,SAEAkK,EAAA0F,EAAA1P,KAAA,cACAyP,EAAA3Q,GAAAgB,OAAA,IAAApB,EAAAR,UAAA,UAAA8L,IAGAtL,EAAAE,QAAAzC,QAAAK,4BAAA,CACAwN,EAAAyF,EAAAzP,KAAA,cACA,IAAA+P,EAAArR,EAAAE,QAAAvB,OAAA2M,GACAyF,EAAA1T,MAAA,OAAAsD,EAAAiD,cAAAyN,EAAArR,EAAAE,QAAAzC,QAAAM,sBAGAiC,EAAAE,QAAAlC,SAAA3B,UACAiP,EAAAyF,EAAAzP,KAAA,cACAgQ,EAAAC,YAAAvR,EAAAsL,IAGA,IAAA2F,EAAAF,EAAAzP,KAAA,WAAAtB,EAAAR,UAAA,WACAX,EAAAqS,eAAAlR,IAAAE,QAAAT,UAAAE,mBAAAoR,EAAAE,KAGAX,EAAAQ,GAAA,uBACAQ,EAAAE,YAAAxR,KAGAsQ,EAAAQ,GAAA,sBACA,IACAC,EAAAzF,EADA0F,EAAA5Q,GAAAgB,OAAAqG,MAUA,GAPAuJ,EAAA1P,KAAA,WAAAtB,EAAAR,UAAA,MACAuR,EAAAC,EAAA5P,OAAA,SAEAkK,EAAA0F,EAAA1P,KAAA,cACAyP,EAAA3Q,GAAAgB,OAAA,IAAApB,EAAAR,UAAA,UAAA8L,IAGAtL,EAAAE,QAAAzC,QAAAK,4BAAA,CACAwN,EAAAyF,EAAAzP,KAAA,cACA,IAAAhG,EAAA0E,EAAAE,QAAAvB,OAAA2M,GACAtL,EAAAE,QAAAxB,KAAAK,SAAA1C,UACAf,EAAA,QAAA0E,EAAAR,UAAA,OAAA8L,EAAA,KAEAyF,EAAA1T,MAAA,OAAA/B,GAGA0E,EAAAE,QAAAlC,SAAA3B,UACAiP,EAAAyF,EAAAzP,KAAA,cACAgQ,EAAAG,YAAAzR,EAAAsL,IAGA,IAAA2F,EAAAF,EAAAzP,KAAA,WAAAtB,EAAAR,UAAA,WACAX,EAAAqS,eAAAlR,IAAAE,QAAAT,UAAAG,kBAAAmR,EAAAE,MAKAC,eAAA,SAAAlR,EAAA0R,EAAAX,EAAAE,GACA,GAAAtQ,EAAA0E,WAAAqM,GAAA,CAGA,IAAApG,EAAAnH,SAAA4M,EAAAzP,KAAA,kBACAoQ,EAAA,CACAX,UAAAlF,OACAP,QACAqG,SAAAV,EACA/U,KAAA8D,EAAAE,QAAAhE,KAAAQ,QAAA4O,OAIA8F,YAAA,SAAApR,EAAA+Q,GACA/Q,EAAA4R,mBAGA5R,EAAA4R,kBAAA,EAGAxR,GAAA8K,UAAA,IAAAlL,EAAAR,UAAA,YAAAqB,OAAA,GACAhC,EAAAsS,aAAAnR,EAAAI,GAAAgB,OAAA,IAAApB,EAAAR,UAAA,YAAAqM,QAGAzL,GAAAgB,OAAA2P,GAAAhD,aACAyC,KAAAxQ,EAAAE,QAAAzC,QAAAI,sBAAAF,QACAqQ,SAAAhO,EAAAE,QAAAzC,QAAAI,sBAAAD,OACA0D,KAAA,qBAAAsI,EAAA9I,GACA,IAAAoD,EAAAlE,EAAAsQ,IAAAuB,SAAAjI,GACAtK,EAAA4E,EAAA,GACA3E,EAAA2E,EAAA,GACAf,EAAAX,KAAAqN,KAAAvQ,IAAAC,KACAuS,EAAA3N,SAAAnE,EAAAE,QAAAzC,QAAAI,sBAAAhC,KAAA,IAEA,mBAAAyD,EAAA6D,EAAA2O,EAAA,IAAAvS,EAAA4D,EAAA2O,EAAA,MAEAlG,KAAA,eAAAhC,EAAA9I,GACAd,EAAA+R,qBAAAhB,EACA/Q,EAAA4R,kBAAA,EACAxR,GAAAgB,OAAAqG,MAAAnG,KAAA,QAAAtB,EAAAR,UAAA,gBAIA2R,aAAA,SAAAnR,EAAA+Q,GACA3Q,GAAAgB,OAAA2P,GAAAhD,aACAC,SAAA,KACA1M,KAAA,8BACAsK,KAAA,eAAAhC,EAAA9I,GACAV,GAAAgB,OAAAqG,MAAAnG,KAAA,YACAtB,EAAA+R,qBAAA,QAIAC,YAAA,SAAA/O,GACA,IAAAgP,EAAAhP,EAAAI,UACA,OACA/D,EAAA2S,EAAA3S,EAAA2S,EAAA3O,MAAA,EACA/D,EAAA0S,EAAA1S,EAAA0S,EAAA1O,OAAA,IASA+I,gBAAA,SAAAhB,EAAApP,EAAA0I,EAAAsN,GACA,IASAC,EATAjS,EAAAyF,EAAA,CAEAyM,YAAA,EAGA7F,UAAA,GACG2F,GAEHG,EAAAnW,EAAAoP,GAAA/O,MAEA,GAAA2D,EAAAkS,WAAA,CACAD,EAAA,EAGA,QAAArR,EAAA,EAAgBA,GAAAwK,EAAUxK,IAC1BqR,GAAAjW,EAAA4E,GAAAvE,WAIA,IAAA4V,IACAA,EAAAE,GAIA,IAAA9H,EAAA4H,EAAAvN,EAAA,IAGA,GAAA1E,EAAAqM,SAAA,CACA,IAAA+F,EAAAD,EAAAzN,EAAA,IACA2F,GAAA+H,EAAA,EAGA,OAAA/H,GAGAkB,cAAA,SAAAzL,EAAAsL,EAAAnO,GACA,IAAAoV,EAAAvS,EAAAE,QAAAhE,KAAAQ,QAAA4O,GAAA/O,MAAAyD,EAAA4E,UACA,OAAAzH,GAAA,EACAqF,KAAA6B,MAAA,IAAAkO,IAEA,IAAAA,GAAAC,QAAArV,KAOA9B,EAAA,CACAoX,gBAAA,IAEAC,SAAA,SAAA1S,GACAA,EAAAmB,IAAA+J,UAAA,IAAAlL,EAAAR,UAAA,SACAtD,KAAA,CAAA8D,EAAAE,QAAA/E,OAAAC,QACA+P,QACA9J,OAAA,QACAhG,KAAA,SAAAuO,GAAsB,OAAAA,EAAAvO,OACtBiG,KAAA,CACAE,GAAAxB,EAAAR,UAAA,QACAmT,MAAA3S,EAAAR,UAAA,QACAF,EAAAjE,EAAAoX,eACAlT,EAAAlE,EAAAoX,iBAEAnR,KAAA,yBAOA,MALA,eAAAtB,EAAAE,QAAA/E,OAAAO,UAAA,eAAAsE,EAAAE,QAAA/E,OAAAO,SACA,SAEA,SAIA4F,KAAA,gBAAAsI,GAA8B,OAAAA,EAAAtO,QAC9B+B,MAAA,qBAAAuM,GAAoC,OAAAA,EAAArO,SAAA,OACpC8B,MAAA,uBAAAuM,GAAsC,OAAAA,EAAApO,QAGtCoX,cAAA,SAAA5S,GACA,IAMAV,EANA0I,EAAAhI,EAAAgI,eACA6K,EAAA7S,EAAAE,QAAA/E,OAAAO,SACAsD,EAAAgB,EAAAE,QAAAxB,KAAAM,cACAjD,EAAAiE,EAAAE,QAAArE,KAAAE,YACAJ,EAAAqE,EAAAE,QAAA/E,OAAAQ,qBAIA2D,EADA,aAAAuT,EACA7T,EAAAI,MAEArD,EAAAiD,EAAAE,OAAA,EAAAF,EAAAI,KAIAE,GAAAU,EAAAE,QAAAxB,KAAAW,gBAAAC,EAEA,IAAAC,EAAAP,EAAAC,IAAA+I,EAAA5M,MAAA+H,EAEA,kBAAA0P,EAIA,GAHAtT,EAAAS,EAAA8I,UAAAvJ,EAGAyI,EAAAvM,SAAAyM,OAAA,CACA,IAAA4K,EAAA9K,EAAA5M,MAAA+H,EAAAxH,EAAAqM,EAAAvM,SAAA0H,EACA5D,IAAAuT,EAAA,EAAA9K,EAAA5M,MAAA+H,OAEA5D,GAAAyI,EAAA5M,MAAA+H,EAAA,EAIAnD,EAAAmB,IAAAC,OAAA,IAAApB,EAAAR,UAAA,SACA8B,KAAA,IAAAhC,GACAgC,KAAA,IAAA/B,IAGAwT,YAAA,SAAA/S,GACA,IAAA6S,EAAA7S,EAAAE,QAAA/E,OAAAO,SAEAsE,EAAAmB,IAAA+J,UAAA,IAAAlL,EAAAR,UAAA,YACAtD,KAAA,CAAA8D,EAAAE,QAAA/E,OAAAM,WACA0P,QACA9J,OAAA,QACAhG,KAAA,SAAAuO,GAAsB,OAAAA,EAAAvO,OACtBiG,KAAA,IAAAjG,EAAAoX,gBACAnR,KAAA,IAAAjG,EAAAoX,gBACAnR,KAAA,KAAAtB,EAAAR,UAAA,YACA8B,KAAA,QAAAtB,EAAAR,UAAA,YACA8B,KAAA,yBAOA,MALA,eAAAuR,GAAA,eAAAA,EACA,SAEA,SAIAvR,KAAA,gBAAAsI,GAA8B,OAAAA,EAAAtO,QAC9B+B,MAAA,qBAAAuM,GAAoC,OAAAA,EAAArO,SAAA,OACpC8B,MAAA,uBAAAuM,GAAsC,OAAAA,EAAApO,QAGtCwX,iBAAA,SAAAhT,GACA,IAGAV,EAHAN,EAAAgB,EAAAE,QAAAxB,KAAAM,cACAjD,EAAAiE,EAAAE,QAAArE,KAAAE,YAIAuD,EADA,aAAAU,EAAAE,QAAA/E,OAAAO,SACAsD,EAAAI,MAEArD,EAAAiD,EAAAE,OAAA,EAAAF,EAAAI,KAIAE,GAAAU,EAAAE,QAAAxB,KAAAW,gBAAAC,EAEA,IAAAC,EAAAlE,EAAA4X,gBAAAjT,GACAA,EAAAmB,IAAAC,OAAA,IAAApB,EAAAR,UAAA,YACA8B,KAAA,IAAAhC,GACAgC,KAAA,IAAA/B,IAGA2T,UAAA,SAAAlT,GACAA,EAAAmB,IAAA+J,UAAA,IAAAlL,EAAAR,UAAA,UACAtD,KAAA,CAAA8D,EAAAE,QAAAtE,SACAuP,QACA9J,OAAA,QACAhG,KAAA,SAAAuO,GAAsB,OAAAA,EAAAvO,OACtBiG,KAAA,IAAAjG,EAAAoX,gBACAnR,KAAA,IAAAjG,EAAAoX,gBACAnR,KAAA,KAAAtB,EAAAR,UAAA,UACA8B,KAAA,QAAAtB,EAAAR,UAAA,UACA8B,KAAA,yBACA,IAAA5F,EAAA,OAMA,MALA,kBAAAsE,EAAAE,QAAAtE,OAAAF,SACAA,EAAA,SACK,iBAAAsE,EAAAE,QAAAtE,OAAAF,WACLA,EAAA,QAEAA,IAEA4F,KAAA,gBAAAsI,GAA8B,OAAAA,EAAAtO,QAC9B+B,MAAA,qBAAAuM,GAAoC,OAAAA,EAAArO,SAAA,OACpC8B,MAAA,uBAAAuM,GAAsC,OAAAA,EAAApO,QAGtC2X,eAAA,SAAAnT,GACA,IAMAV,EANA8T,EAAApT,EAAAE,QAAAtE,OAAAF,SACA2X,EAAArT,EAAAgI,eAAApM,OAAAsH,EACAnH,EAAAiE,EAAAE,QAAArE,KAAAE,YACAD,EAAAkE,EAAAE,QAAArE,KAAAC,aACAkD,EAAAgB,EAAAE,QAAAxB,KAAAM,cAIAM,EADA,gBAAA8T,EACApU,EAAAI,KACG,iBAAAgU,EACHrX,EAAAsX,EAAArU,EAAAE,MAEAnD,EAAA,EAGAiE,EAAAmB,IAAAC,OAAA,IAAApB,EAAAR,UAAA,UACA8B,KAAA,IAAAhC,GACAgC,KAAA,IAAAxF,EAAAkD,EAAAG,SAGA8T,gBAAA,SAAAjT,GACA,IAAAmD,EACA,GAAAnD,EAAAgI,eAAA5M,MAAA8M,OAAA,CAGA,IAAA4K,EAAA9S,EAAAgI,eAAA5M,MAAA+H,EAAAnD,EAAAE,QAAA/E,OAAAQ,qBAAAqE,EAAAgI,eAAAvM,SAAA0H,EAEAA,EADA,eAAAnD,EAAAE,QAAA/E,OAAAO,SACAsE,EAAA8I,UAAAvJ,EAAAuT,EAAA,EAAAA,EAEAA,EAAA9S,EAAAE,QAAAxB,KAAAM,cAAAC,SAGA,kBAAAe,EAAAE,QAAA/E,OAAAO,SAAA,CACA,IAAA4X,EAAAtT,EAAAE,QAAAxB,KAAAM,cAAAG,OAAAa,EAAAgI,eAAApM,OAAAuH,EACAA,GAAAnD,EAAAE,QAAArE,KAAAC,aAAAwX,GAAA,EAAAtT,EAAAE,QAAAxB,KAAAM,cAAAC,IAAAe,EAAAgI,eAAAvM,SAAA0H,EAAA,OAEAA,EAAAnD,EAAAE,QAAAxB,KAAAM,cAAAC,IAAAe,EAAAgI,eAAAvM,SAAA0H,EAGA,OAAAA,IAKAmO,EAAA,CACAiC,YAAA,SAAAvT,GAGA,IAAAhC,EAAAgC,EAAAmB,IAAA6J,OAAA,KACA1J,KAAA,QAAAtB,EAAAR,UAAA,YAEAxB,EAAAkN,UAAA,IAAAlL,EAAAR,UAAA,WACAtD,KAAA8D,EAAAE,QAAAhE,KAAAQ,SACAyO,QACA9J,OAAA,KACAC,KAAA,QAAAtB,EAAAR,UAAA,WACA8B,KAAA,cAAAsI,EAAA9I,GAAoC,OAAAd,EAAAR,UAAA,UAAAsB,IACpCzD,MAAA,aACAgE,OAAA,QACAC,KAAA,CACAkS,GAAAxT,EAAAE,QAAAlC,SAAAI,OAAAI,aACAiV,GAAAzT,EAAAE,QAAAlC,SAAAI,OAAAI,aACAc,GAAAU,EAAAE,QAAAlC,SAAAI,OAAAK,QACAiV,QAAA1T,EAAAE,QAAAlC,SAAAI,OAAAG,oBAEAlB,MAAA,OAAA2C,EAAAE,QAAAlC,SAAAI,OAAAE,iBAEAN,EAAAkN,UAAA,IAAAlL,EAAAR,UAAA,WACAtD,KAAA8D,EAAAE,QAAAhE,KAAAQ,SACA2E,OAAA,QACAC,KAAA,gBAAAsI,GAAmC,OAAA5J,EAAAE,QAAAlC,SAAAI,OAAA9C,QACnC+B,MAAA,qBAAAuM,GAAyC,OAAA5J,EAAAE,QAAAlC,SAAAI,OAAA7C,WACzC8B,MAAA,uBAAAuM,GAA2C,OAAA5J,EAAAE,QAAAlC,SAAAI,OAAA5C,OAC3CH,KAAA,SAAAuO,EAAA9I,GACA,IAAA6S,EAAA3T,EAAAE,QAAAlC,SAAAE,OAIA,MAHA,YAAA8B,EAAAE,QAAAlC,SAAAC,OACA0V,EAAA/J,EAAA+J,SAEArC,EAAAsC,oBAAA5T,EAAA2T,EAAA7S,EAAA,CACArE,MAAAmN,EAAAnN,MACAF,MAAAqN,EAAArN,MACAW,WAAA2B,EAAA4M,cAAAzL,EAAAc,EAAAd,EAAAE,QAAAvD,OAAAO,WAAAC,mBAIAa,EAAAkN,UAAA,IAAAlL,EAAAR,UAAA,gBACA8B,KAAA,CACAgC,MAAA,SAAAsG,EAAA9I,GACA,IAAAgL,EAAAnL,EAAAqC,cAAAhD,EAAAR,UAAA,UAAAsB,GACA,OAAAgL,EAAA5I,EAAA,EAAAlD,EAAAE,QAAAlC,SAAAI,OAAAK,SAEA8E,OAAA,SAAAqG,EAAA9I,GACA,IAAAgL,EAAAnL,EAAAqC,cAAAhD,EAAAR,UAAA,UAAAsB,GACA,OAAAgL,EAAA3I,EAAA,EAAAnD,EAAAE,QAAAlC,SAAAI,OAAAK,SAEAc,EAAA,SAAAqK,EAAA9I,GACA,IAAAgL,EAAAnL,EAAAqC,cAAAhD,EAAAR,UAAA,UAAAsB,GACA,OAAAgL,EAAA3I,EAAA,QAKAoO,YAAA,SAAAvR,EAAAsL,GAEA,IAAAjN,EAAA2B,EAAAE,QAAAlC,SAAAI,OAAAC,YACAiT,EAAAuC,iBAAAvI,IACAjN,EAAA,GAGAiT,EAAAuC,eAAAvI,EACAlL,GAAAgB,OAAA,IAAApB,EAAAR,UAAA,UAAA8L,GACAyC,aACAC,SAAA3P,GACAhB,MAAA,qBAAoC,WAEpCiU,EAAAE,YAAAxR,IAGAwR,YAAA,SAAAxR,GACAI,GAAA8K,UAAA,IAAAlL,EAAAR,UAAA,UAAA8R,EAAAuC,gBACAvS,KAAA,qBAAAsI,GACA,IAAAkK,EAAA1T,GAAA2T,MAAAtM,KAAAuM,YACA1U,EAAAwU,EAAA,GAAA9T,EAAAE,QAAAlC,SAAAI,OAAAK,QAAA,EACAc,EAAAuU,EAAA,KAAA9T,EAAAE,QAAAlC,SAAAI,OAAAK,QAAA,EACA,mBAAAa,EAAA,IAAAC,EAAA,OAIAkS,YAAA,SAAAzR,EAAAsL,GACAlL,GAAAgB,OAAA,IAAApB,EAAAR,UAAA,UAAA8L,GACAjO,MAAA,qBAAoC,WAIpC+C,GAAAgB,OAAA,IAAApB,EAAAR,UAAA,UAAA8R,EAAAuC,gBACAvS,KAAA,qBAAAsI,EAAA9I,GAGA,IAAAxB,EAAAU,EAAAE,QAAArE,KAAAE,YAAA,IACAwD,EAAAS,EAAAE,QAAArE,KAAAC,aAAA,IACA,mBAAAwD,EAAA,IAAAC,EAAA,OAIAqU,oBAAA,SAAA5T,EAAAqL,EAAAC,EAAA2I,GAiBA,OAdAtT,EAAA0E,WAAArF,EAAAE,QAAAlC,SAAAG,oBACA6B,EAAAE,QAAAlC,SAAAG,kBAAAmN,EAAA2I,GAaA5I,EAAArH,QAAA,aATA,SAAAkQ,GACA,IAAAC,EAAAjO,UAAA,GACA,OAAA+N,EAAA5T,eAAA8T,GACAF,EAAA/N,UAAA,IAEAA,UAAA,OAYAkO,EAAA,SAAAnU,EAAAC,GAIA,GADAuH,KAAAxH,UACA,iBAAAA,EAAA,CACA,IAAAgD,EAAAhD,EAAA+D,QAAA,SACAyD,KAAAxH,QAAA4B,SAAAC,eAAAmB,GAGA,IAAAiP,EAAA,GACAvM,GAAA,EAAAuM,EAAAhX,EAAAgF,GACAuH,KAAAvH,QAAAgS,EAGA,OAAAzK,KAAAvH,QAAAxB,KAAAc,UACAiI,KAAAjI,UAAAiI,KAAAvH,QAAAxB,KAAAc,WAEAiI,KAAAjI,UAAA,IAAAvE,EAAA,IACAA,KAKA6E,EAAAC,aAAA0H,QAKArH,GAAAgB,OAAAqG,KAAAxH,SAAAqB,KAz1DA,QACA,SA21DAmG,KAAAvH,QAAAhE,KAAAQ,QAAAmI,EAAA2D,YAAAf,MACAA,KAAAvH,QAAAhE,KAAAM,qBAAAH,UACAoL,KAAAvH,QAAAhE,KAAAQ,QAAAiE,EAAAgE,0BAAA8C,KAAAvH,QAAAhE,KAAAQ,QAAA+K,KAAAvH,QAAAhE,KAAAM,uBAEAiL,KAAAvH,QAAAvB,OAAAgC,EAAA8D,kBAAAgD,MACAA,KAAA7C,UAAAC,EAAAC,gBAAA2C,KAAAvH,QAAAhE,KAAAQ,SAEA2X,EAAA9O,KAAAkC,QAGA2M,EAAA1O,UAAA4O,SAAA,WAEAxU,EAAAC,aAAA0H,QAGAA,KAAAvH,QAAAhE,KAAAQ,QAAAmI,EAAA2D,YAAAf,MACAA,KAAAvH,QAAAhE,KAAAM,qBAAAH,UACAoL,KAAAvH,QAAAhE,KAAAQ,QAAAiE,EAAAgE,0BAAA8C,KAAAvH,QAAAhE,KAAAQ,QAAA+K,KAAAvH,QAAAhE,KAAAM,uBAEAiL,KAAAvH,QAAAvB,OAAAgC,EAAA8D,kBAAAgD,MACAA,KAAA7C,UAAAC,EAAAC,gBAAA2C,KAAAvH,QAAAhE,KAAAQ,SAEA2X,EAAA9O,KAAAkC,QAGA2M,EAAA1O,UAAA6O,OAAA,WACA9M,KAAAxH,QAAAuU,UAAA,GACAH,EAAA9O,KAAAkC,OAGA2M,EAAA1O,UAAA+O,QAAA,WACAhN,KAAAxH,QAAAuU,UAAA,GACApU,GAAAgB,OAAAqG,KAAAxH,SAAAqB,KA53DA,QA43DA,OAYA8S,EAAA1O,UAAAgP,eAAA,WACA,IAAA3D,EAAAtJ,KAAAsK,qBACA,GAAAhB,QAAA,CACA,IAAAzF,EAAAnH,SAAA/D,GAAAgB,OAAA2P,GAAAzP,KAAA,kBACA,OACArB,QAAA8Q,EACAzF,QACApP,KAAAuL,KAAAvH,QAAAhE,KAAAQ,QAAA4O,IAGA,aAIA8I,EAAA1O,UAAA0L,YAAA,SAAA9F,IACAA,EAAAnH,SAAAmH,EAAA,KACA,GAAAA,EAAA7D,KAAAvH,QAAAhE,KAAAQ,QAAAmE,OAAA,GAGAhC,EAAAuS,YAAA3J,KAAArH,GAAAgB,OAAA,IAAAqG,KAAAjI,UAAA,UAAA8L,GAAAO,SAGAuI,EAAA1O,UAAAyL,aAAA,WACA,IAAAJ,EAAAtJ,KAAAsK,qBACAhB,GACAlS,EAAAsS,aAAA1J,KAAAsJ,IAOAqD,EAAA1O,UAAAiP,WAAA,SAAAC,EAAArY,GACA,OAAAqY,GACA,wBACA,IAAAC,EAAAlU,EAAAgC,WAAA8E,KAAAvH,QAAA0U,GACAjU,EAAAgC,WAAA8E,KAAAvH,QAAA0U,EAAArY,GACA6D,GAAAgB,OAAA,IAAAqG,KAAAjI,UAAA,SAAAsV,KAAAvY,IACA,KAAAsY,GAAA,KAAAtY,GAAA,KAAAsY,GAAA,KAAAtY,IACAkL,KAAA8M,SAEA,MAEA,2BACA,IAAAQ,EAAApU,EAAAgC,WAAA8E,KAAAvH,QAAA0U,GACAjU,EAAAgC,WAAA8E,KAAAvH,QAAA0U,EAAArY,GACA6D,GAAAgB,OAAA,IAAAqG,KAAAjI,UAAA,YAAAsV,KAAAvY,IACA,KAAAwY,GAAA,KAAAxY,GAAA,KAAAwY,GAAA,KAAAxY,IACAkL,KAAA8M,SAEA,MAEA,uBACA,mCACA,kCACA,+BACA,2CACA,0CACA,yCACA,0CACA,kCACA5T,EAAAgC,WAAA8E,KAAAvH,QAAA0U,EAAArY,GACA,MAGA,QACAoE,EAAAgC,WAAA8E,KAAAvH,QAAA0U,EAAArY,GAEAkL,KAAAgN,UACAhN,KAAA6M,aASA,IAAAD,EAAA,WAGA5M,KAAAtG,IAAAR,EAAAO,YAAAuG,MAGAA,KAAAO,eAAA,CACAC,aAAA,EACA7M,MAAA,CACA8M,OAAA,KAAAT,KAAAvH,QAAA/E,OAAAC,MAAAC,KACA8H,EAAA,EACAD,EAAA,GAEAzH,SAAA,CACAyM,OAAA,KAAAT,KAAAvH,QAAA/E,OAAAM,SAAAJ,KACA8H,EAAA,EACAD,EAAA,GAEAtH,OAAA,CACAsM,OAAA,KAAAT,KAAAvH,QAAAtE,OAAAP,KACA8H,EAAA,EACAD,EAAA,IAIAuE,KAAAiF,oBAAA,GAGAjF,KAAAO,eAAA5M,MAAA8M,QACA7M,EAAAqX,SAAAjL,MAEAA,KAAAO,eAAAvM,SAAAyM,QACA7M,EAAA0X,YAAAtL,MAEApM,EAAA6X,UAAAzL,MAGA,IAAAuN,EAAAvN,KACA9G,EAAAY,aAAAkG,KAAAjI,UAAA,oBACAnE,EAAA8X,eAAA6B,GACA,IAAA5U,EAAAO,EAAAqC,cAAAgS,EAAAxV,UAAA,UACAwV,EAAAhN,eAAApM,OAAAuH,EAAA/C,EAAA+C,EACA6R,EAAAhN,eAAApM,OAAAsH,EAAA9C,EAAA8C,IAIA,IAAA+R,EAAA,GACAxN,KAAAO,eAAA5M,MAAA8M,QAA4C+M,EAAAhU,KAAAwG,KAAAjI,UAAA,SAC5CiI,KAAAO,eAAAvM,SAAAyM,QAA4C+M,EAAAhU,KAAAwG,KAAAjI,UAAA,YAC5CiI,KAAAO,eAAApM,OAAAsM,QAA4C+M,EAAAhU,KAAAwG,KAAAjI,UAAA,UAE5CmB,EAAAqB,kBAAAiT,EAAA,WACA,GAAAD,EAAAhN,eAAA5M,MAAA8M,OAAA,CACA,IAAAgN,EAAAvU,EAAAqC,cAAAgS,EAAAxV,UAAA,SACAwV,EAAAhN,eAAA5M,MAAA+H,EAAA+R,EAAA/R,EACA6R,EAAAhN,eAAA5M,MAAA8H,EAAAgS,EAAAhS,EAEA,GAAA8R,EAAAhN,eAAAvM,SAAAyM,OAAA,CACA,IAAAiN,EAAAxU,EAAAqC,cAAAgS,EAAAxV,UAAA,YACAwV,EAAAhN,eAAAvM,SAAA0H,EAAAgS,EAAAhS,EACA6R,EAAAhN,eAAAvM,SAAAyH,EAAAiS,EAAAjS,EAGA,GAAA8R,EAAAhN,eAAA5M,MAAA8M,QAAA8M,EAAAhN,eAAAvM,SAAAyM,OAAA,CACA,IAAAD,EAAA,EACA+M,EAAAhN,eAAA5M,MAAA8M,SACAD,GAAA+M,EAAAhN,eAAA5M,MAAA+H,EACA6R,EAAAhN,eAAAvM,SAAAyM,SACAD,GAAA+M,EAAA9U,QAAA/E,OAAAQ,uBAGAqZ,EAAAhN,eAAAvM,SAAAyM,SACAD,GAAA+M,EAAAhN,eAAAvM,SAAA0H,GAEA6R,EAAAhN,eAAAC,eAIApD,EAAAkD,iBAAAiN,GAIAnQ,EAAAkE,mBAAAiM,GAGA3Z,EAAAuX,cAAAoC,GACA3Z,EAAA2X,iBAAAgC,GAGAA,EAAA9U,QAAAxB,KAAAK,SAAA1C,SACAwC,EAAA8R,aAAAqE,GAEAnW,EAAAsR,OAAA6E,GACArY,EAAA8N,IAAAuK,EAAA,QAAAA,EAAA9U,QAAAvD,OAAAK,MAAAH,QACAF,EAAA8N,IAAAuK,EAAA,QAAAA,EAAA9U,QAAAvD,OAAAC,MAAAC,QAGAF,EAAA+O,sBAAAsJ,EAAA,QAAAA,EAAA9U,QAAAvD,OAAAK,MAAAH,QACAF,EAAA+O,sBAAAsJ,EAAA,QAAAA,EAAA9U,QAAAvD,OAAAC,MAAAC,QACAF,EAAA0R,wBAAA2G,GAGArY,EAAA2Q,oBAAA0H,EAAA,SAGArY,EAAAoP,0BAAAiJ,GAGAA,EAAA9U,QAAAvD,OAAAS,MAAAf,SAAA,SAAA2Y,EAAA9U,QAAAvD,OAAAC,MAAAC,QACAF,EAAAmQ,cAAAkI,GAGArY,EAAA2Q,oBAAA0H,EAAA,SACArY,EAAAgR,qBAAAqH,GAGAA,EAAA9U,QAAAlC,SAAA3B,SACAiV,EAAAiC,YAAAyB,GAGAnW,EAAAgS,wBAAAmE,MAIA,OAAAZ,IA7lEsBvZ,EAAAua,MAAA1a,EAAAI,GAAAD,KAAAJ,EAAAC,QAAAK","file":"14.js","sourcesContent":["var baseFor = require('./_baseFor'),\n    keys = require('./keys');\n\n/**\n * The base implementation of `_.forOwn` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Object} Returns `object`.\n */\nfunction baseForOwn(object, iteratee) {\n  return object && baseFor(object, iteratee, keys);\n}\n\nmodule.exports = baseForOwn;\n","/*!\n * d3pie\n * @author Ben Keen\n * @version 0.1.9\n * @date June 17th, 2015\n * @repo http://github.com/benkeen/d3pie\n */\n\n// UMD pattern from https://github.com/umdjs/umd/blob/master/returnExports.js\n(function(root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    // AMD. Register as an anonymous module\n    define([], factory);\n  } else if (typeof exports === 'object') {\n    // Node. Does not work with strict CommonJS, but only CommonJS-like environments that support module.exports,\n    // like Node\n    module.exports = factory();\n  } else {\n    // browser globals (root is window)\n    root.d3pie = factory(root);\n  }\n}(this, function() {\n\n\tvar _scriptName = \"d3pie\";\n\tvar _version = \"0.1.6\";\n\n\t// used to uniquely generate IDs and classes, ensuring no conflict between multiple pies on the same page\n\tvar _uniqueIDCounter = 0;\n\n\n\t// this section includes all helper libs on the d3pie object. They're populated via grunt-template. Note: to keep\n\t// the syntax highlighting from getting all messed up, I commented out each line. That REQUIRES each of the files\n\t// to have an empty first line. Crumby, yes, but acceptable.\n\t//// --------- _default-settings.js -----------/**\n/**\n * Contains the out-the-box settings for the script. Any of these settings that aren't explicitly overridden for the\n * d3pie instance will inherit from these. This is also included on the main website for use in the generation script.\n */\nvar defaultSettings = {\n\theader: {\n\t\ttitle: {\n\t\t\ttext:     \"\",\n\t\t\tcolor:    \"#333333\",\n\t\t\tfontSize: 18,\n\t\t\tfont:     \"arial\"\n\t\t},\n\t\tsubtitle: {\n\t\t\ttext:     \"\",\n\t\t\tcolor:    \"#666666\",\n\t\t\tfontSize: 14,\n\t\t\tfont:     \"arial\"\n\t\t},\n\t\tlocation: \"top-center\",\n\t\ttitleSubtitlePadding: 8\n\t},\n\tfooter: {\n\t\ttext: \t  \"\",\n\t\tcolor:    \"#666666\",\n\t\tfontSize: 14,\n\t\tfont:     \"arial\",\n\t\tlocation: \"left\"\n\t},\n\tsize: {\n\t\tcanvasHeight: 500,\n\t\tcanvasWidth: 500,\n\t\tpieInnerRadius: \"0%\",\n\t\tpieOuterRadius: null\n\t},\n\tdata: {\n\t\tsortOrder: \"none\",\n\t\tignoreSmallSegments: {\n\t\t\tenabled: false,\n\t\t\tvalueType: \"percentage\",\n\t\t\tvalue: null\n\t\t},\n\t\tsmallSegmentGrouping: {\n\t\t\tenabled: false,\n\t\t\tvalue: 1,\n\t\t\tvalueType: \"percentage\",\n\t\t\tlabel: \"Other\",\n\t\t\tcolor: \"#cccccc\"\n\t\t},\n\t\tcontent: []\n\t},\n\tlabels: {\n\t\touter: {\n\t\t\tformat: \"label\",\n\t\t\thideWhenLessThanPercentage: null,\n\t\t\tpieDistance: 30\n\t\t},\n\t\tinner: {\n\t\t\tformat: \"percentage\",\n\t\t\thideWhenLessThanPercentage: null\n\t\t},\n\t\tmainLabel: {\n\t\t\tcolor: \"#333333\",\n\t\t\tfont: \"arial\",\n\t\t\tfontSize: 10\n\t\t},\n\t\tpercentage: {\n\t\t\tcolor: \"#dddddd\",\n\t\t\tfont: \"arial\",\n\t\t\tfontSize: 10,\n\t\t\tdecimalPlaces: 0\n\t\t},\n\t\tvalue: {\n\t\t\tcolor: \"#cccc44\",\n\t\t\tfont: \"arial\",\n\t\t\tfontSize: 10\n\t\t},\n\t\tlines: {\n\t\t\tenabled: true,\n\t\t\tstyle: \"curved\",\n\t\t\tcolor: \"segment\"\n\t\t},\n\t\ttruncation: {\n\t\t\tenabled: false,\n\t\t\ttruncateLength: 30\n\t\t},\n    formatter: null\n\t},\n\teffects: {\n\t\tload: {\n\t\t\teffect: \"default\",\n\t\t\tspeed: 1000\n\t\t},\n\t\tpullOutSegmentOnClick: {\n\t\t\teffect: \"bounce\",\n\t\t\tspeed: 300,\n\t\t\tsize: 10\n\t\t},\n\t\thighlightSegmentOnMouseover: true,\n\t\thighlightLuminosity: -0.2\n\t},\n\ttooltips: {\n\t\tenabled: false,\n\t\ttype: \"placeholder\", // caption|placeholder\n    string: \"\",\n    placeholderParser: null,\n\t\tstyles: {\n      fadeInSpeed: 250,\n\t\t\tbackgroundColor: \"#000000\",\n      backgroundOpacity: 0.5,\n\t\t\tcolor: \"#efefef\",\n      borderRadius: 2,\n      font: \"arial\",\n      fontSize: 10,\n      padding: 4\n\t\t}\n\t},\n\tmisc: {\n\t\tcolors: {\n\t\t\tbackground: null,\n\t\t\tsegments: [\n\t\t\t\t\"#2484c1\", \"#65a620\", \"#7b6888\", \"#a05d56\", \"#961a1a\", \"#d8d23a\", \"#e98125\", \"#d0743c\", \"#635222\", \"#6ada6a\",\n\t\t\t\t\"#0c6197\", \"#7d9058\", \"#207f33\", \"#44b9b0\", \"#bca44a\", \"#e4a14b\", \"#a3acb2\", \"#8cc3e9\", \"#69a6f9\", \"#5b388f\",\n\t\t\t\t\"#546e91\", \"#8bde95\", \"#d2ab58\", \"#273c71\", \"#98bf6e\", \"#4daa4b\", \"#98abc5\", \"#cc1010\", \"#31383b\", \"#006391\",\n\t\t\t\t\"#c2643f\", \"#b0a474\", \"#a5a39c\", \"#a9c2bc\", \"#22af8c\", \"#7fcecf\", \"#987ac6\", \"#3d3b87\", \"#b77b1c\", \"#c9c2b6\",\n\t\t\t\t\"#807ece\", \"#8db27c\", \"#be66a2\", \"#9ed3c6\", \"#00644b\", \"#005064\", \"#77979f\", \"#77e079\", \"#9c73ab\", \"#1f79a7\"\n\t\t\t],\n\t\t\tsegmentStroke: \"#ffffff\"\n\t\t},\n\t\tgradient: {\n\t\t\tenabled: false,\n\t\t\tpercentage: 95,\n\t\t\tcolor: \"#000000\"\n\t\t},\n\t\tcanvasPadding: {\n\t\t\ttop: 5,\n\t\t\tright: 5,\n\t\t\tbottom: 5,\n\t\t\tleft: 5\n\t\t},\n\t\tpieCenterOffset: {\n\t\t\tx: 0,\n\t\t\ty: 0\n\t\t},\n\t\tcssPrefix: null\n\t},\n\tcallbacks: {\n\t\tonload: null,\n\t\tonMouseoverSegment: null,\n\t\tonMouseoutSegment: null,\n\t\tonClickSegment: null\n\t}\n};\n\n\t//// --------- validate.js -----------\nvar validate = {\n\n\t// called whenever a new pie chart is created\n\tinitialCheck: function(pie) {\n\t\tvar cssPrefix = pie.cssPrefix;\n\t\tvar element = pie.element;\n\t\tvar options = pie.options;\n\n\t\t// confirm d3 is available [check minimum version]\n\t\tif (!window.d3 || !window.d3.hasOwnProperty(\"version\")) {\n\t\t\tconsole.error(\"d3pie error: d3 is not available\");\n\t\t\treturn false;\n\t\t}\n\n\t\t// confirm element is either a DOM element or a valid string for a DOM element\n\t\tif (!(element instanceof HTMLElement || element instanceof SVGElement)) {\n\t\t\tconsole.error(\"d3pie error: the first d3pie() param must be a valid DOM element (not jQuery) or a ID string.\");\n\t\t\treturn false;\n\t\t}\n\n\t\t// confirm the CSS prefix is valid. It has to start with a-Z and contain nothing but a-Z0-9_-\n\t\tif (!(/[a-zA-Z][a-zA-Z0-9_-]*$/.test(cssPrefix))) {\n\t\t\tconsole.error(\"d3pie error: invalid options.misc.cssPrefix\");\n\t\t\treturn false;\n\t\t}\n\n\t\t// confirm some data has been supplied\n\t\tif (!helpers.isArray(options.data.content)) {\n\t\t\tconsole.error(\"d3pie error: invalid config structure: missing data.content property.\");\n\t\t\treturn false;\n\t\t}\n\t\tif (options.data.content.length === 0) {\n\t\t\tconsole.error(\"d3pie error: no data supplied.\");\n\t\t\treturn false;\n\t\t}\n\n\t\t// clear out any invalid data. Each data row needs a valid positive number and a label\n\t\tvar data = [];\n\t\tfor (var i=0; i<options.data.content.length; i++) {\n\t\t\tif (typeof options.data.content[i].value !== \"number\" || isNaN(options.data.content[i].value)) {\n\t\t\t\tconsole.log(\"not valid: \", options.data.content[i]);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (options.data.content[i].value <= 0) {\n\t\t\t\tconsole.log(\"not valid - should have positive value: \", options.data.content[i]);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tdata.push(options.data.content[i]);\n\t\t}\n\t\tpie.options.data.content = data;\n\n\t\t// labels.outer.hideWhenLessThanPercentage - 1-100\n\t\t// labels.inner.hideWhenLessThanPercentage - 1-100\n\n\t\treturn true;\n\t}\n};\n\n\t//// --------- helpers.js -----------\nvar helpers = {\n\n\t// creates the SVG element\n\taddSVGSpace: function(pie) {\n\t\tvar element = pie.element;\n\t\tvar canvasWidth = pie.options.size.canvasWidth;\n\t\tvar canvasHeight = pie.options.size.canvasHeight;\n\t\tvar backgroundColor = pie.options.misc.colors.background;\n\n\t\tvar svg = d3.select(element).append(\"svg:svg\")\n\t\t\t.attr(\"width\", canvasWidth)\n\t\t\t.attr(\"height\", canvasHeight);\n\n\t\tif (backgroundColor !== \"transparent\") {\n\t\t\tsvg.style(\"background-color\", function() { return backgroundColor; });\n\t\t}\n\n\t\treturn svg;\n\t},\n\n\twhenIdExists: function(id, callback) {\n\t\tvar inc = 1;\n\t\tvar giveupIterationCount = 1000;\n\n\t\tvar interval = setInterval(function() {\n\t\t\tif (document.getElementById(id)) {\n\t\t\t\tclearInterval(interval);\n\t\t\t\tcallback();\n\t\t\t}\n\t\t\tif (inc > giveupIterationCount) {\n\t\t\t\tclearInterval(interval);\n\t\t\t}\n\t\t\tinc++;\n\t\t}, 1);\n\t},\n\n\twhenElementsExist: function(els, callback) {\n\t\tvar inc = 1;\n\t\tvar giveupIterationCount = 1000;\n\n\t\tvar interval = setInterval(function() {\n\t\t\tvar allExist = true;\n\t\t\tfor (var i=0; i<els.length; i++) {\n\t\t\t\tif (!document.getElementById(els[i])) {\n\t\t\t\t\tallExist = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (allExist) {\n\t\t\t\tclearInterval(interval);\n\t\t\t\tcallback();\n\t\t\t}\n\t\t\tif (inc > giveupIterationCount) {\n\t\t\t\tclearInterval(interval);\n\t\t\t}\n\t\t\tinc++;\n\t\t}, 1);\n\t},\n\n\tshuffleArray: function(array) {\n\t\tvar currentIndex = array.length, tmpVal, randomIndex;\n\n\t\twhile (0 !== currentIndex) {\n\t\t\trandomIndex = Math.floor(Math.random() * currentIndex);\n\t\t\tcurrentIndex -= 1;\n\n\t\t\t// and swap it with the current element\n\t\t\ttmpVal = array[currentIndex];\n\t\t\tarray[currentIndex] = array[randomIndex];\n\t\t\tarray[randomIndex] = tmpVal;\n\t\t}\n\t\treturn array;\n\t},\n\n\tprocessObj: function(obj, is, value) {\n\t\tif (typeof is === 'string') {\n\t\t\treturn helpers.processObj(obj, is.split('.'), value);\n\t\t} else if (is.length === 1 && value !== undefined) {\n            obj[is[0]] = value;\n\t\t\treturn obj[is[0]];\n\t\t} else if (is.length === 0) {\n\t\t\treturn obj;\n\t\t} else {\n\t\t\treturn helpers.processObj(obj[is[0]], is.slice(1), value);\n\t\t}\n\t},\n\n\tgetDimensions: function(id) {\n\t\tvar el = document.getElementById(id);\n\t\tvar w = 0, h = 0;\n\t\tif (el) {\n\t\t\tvar dimensions = el.getBBox();\n\t\t\tw = dimensions.width;\n\t\t\th = dimensions.height;\n\t\t} else {\n\t\t\tconsole.log(\"error: getDimensions() \" + id + \" not found.\");\n\t\t}\n\t\treturn { w: w, h: h };\n\t},\n\n\t/**\n\t * This is based on the SVG coordinate system, where top-left is 0,0 and bottom right is n-n.\n\t * @param r1\n\t * @param r2\n\t * @returns {boolean}\n\t */\n\trectIntersect: function(r1, r2) {\n\t\tvar returnVal = (\n\t\t\t// r2.left > r1.right\n\t\t\t(r2.x > (r1.x + r1.w)) ||\n\n\t\t\t// r2.right < r1.left\n\t\t\t((r2.x + r2.w) < r1.x) ||\n\n\t\t\t// r2.top < r1.bottom\n\t\t\t((r2.y + r2.h) < r1.y) ||\n\n\t\t\t// r2.bottom > r1.top\n\t\t\t(r2.y > (r1.y + r1.h))\n\t\t);\n\n\t\treturn !returnVal;\n\t},\n\n\t/**\n\t * Returns a lighter/darker shade of a hex value, based on a luminance value passed.\n\t * @param hex a hex color value such as #abc or #123456 (the hash is optional)\n\t * @param lum the luminosity factor: -0.1 is 10% darker, 0.2 is 20% lighter, etc.\n\t * @returns {string}\n\t */\n\tgetColorShade: function(hex, lum) {\n\n\t\t// validate hex string\n\t\thex = String(hex).replace(/[^0-9a-f]/gi, '');\n\t\tif (hex.length < 6) {\n\t\t\thex = hex[0]+hex[0]+hex[1]+hex[1]+hex[2]+hex[2];\n\t\t}\n\t\tlum = lum || 0;\n\n\t\t// convert to decimal and change luminosity\n\t\tvar newHex = \"#\";\n\t\tfor (var i=0; i<3; i++) {\n\t\t\tvar c = parseInt(hex.substr(i * 2, 2), 16);\n\t\t\tc = Math.round(Math.min(Math.max(0, c + (c * lum)), 255)).toString(16);\n\t\t\tnewHex += (\"00\" + c).substr(c.length);\n\t\t}\n\n\t\treturn newHex;\n\t},\n\n\t/**\n\t * Users can choose to specify segment colors in three ways (in order of precedence):\n\t * \t1. include a \"color\" attribute for each row in data.content\n\t * \t2. include a misc.colors.segments property which contains an array of hex codes\n\t * \t3. specify nothing at all and rely on this lib provide some reasonable defaults\n\t *\n\t * This function sees what's included and populates this.options.colors with whatever's required\n\t * for this pie chart.\n\t * @param data\n\t */\n\tinitSegmentColors: function(pie) {\n\t\tvar data   = pie.options.data.content;\n\t\tvar colors = pie.options.misc.colors.segments;\n\n\t\t// TODO this needs a ton of error handling\n\n\t\tvar finalColors = [];\n\t\tfor (var i=0; i<data.length; i++) {\n\t\t\tif (data[i].hasOwnProperty(\"color\")) {\n\t\t\t\tfinalColors.push(data[i].color);\n\t\t\t} else {\n\t\t\t\tfinalColors.push(colors[i]);\n\t\t\t}\n\t\t}\n\n\t\treturn finalColors;\n\t},\n\n\tapplySmallSegmentGrouping: function(data, smallSegmentGrouping) {\n\t\tvar totalSize;\n\t\tif (smallSegmentGrouping.valueType === \"percentage\") {\n\t\t\ttotalSize = math.getTotalPieSize(data);\n\t\t}\n\n\t\t// loop through each data item\n\t\tvar newData = [];\n\t\tvar groupedData = [];\n\t\tvar totalGroupedData = 0;\n\t\tfor (var i=0; i<data.length; i++) {\n\t\t\tif (smallSegmentGrouping.valueType === \"percentage\") {\n\t\t\t\tvar dataPercent = (data[i].value / totalSize) * 100;\n\t\t\t\tif (dataPercent <= smallSegmentGrouping.value) {\n\t\t\t\t\tgroupedData.push(data[i]);\n\t\t\t\t\ttotalGroupedData += data[i].value;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tdata[i].isGrouped = false;\n\t\t\t\tnewData.push(data[i]);\n\t\t\t} else {\n\t\t\t\tif (data[i].value <= smallSegmentGrouping.value) {\n\t\t\t\t\tgroupedData.push(data[i]);\n\t\t\t\t\ttotalGroupedData += data[i].value;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tdata[i].isGrouped = false;\n\t\t\t\tnewData.push(data[i]);\n\t\t\t}\n\t\t}\n\n\t\t// we're done! See if there's any small segment groups to add\n\t\tif (groupedData.length) {\n\t\t\tnewData.push({\n\t\t\t\tcolor: smallSegmentGrouping.color,\n\t\t\t\tlabel: smallSegmentGrouping.label,\n\t\t\t\tvalue: totalGroupedData,\n\t\t\t\tisGrouped: true,\n\t\t\t\tgroupedData: groupedData\n\t\t\t});\n\t\t}\n\n\t\treturn newData;\n\t},\n\n\t// for debugging\n\tshowPoint: function(svg, x, y) {\n\t\tsvg.append(\"circle\").attr(\"cx\", x).attr(\"cy\", y).attr(\"r\", 2).style(\"fill\", \"black\");\n\t},\n\n\tisFunction: function(functionToCheck) {\n\t\tvar getType = {};\n\t\treturn functionToCheck && getType.toString.call(functionToCheck) === '[object Function]';\n\t},\n\n\tisArray: function(o) {\n\t\treturn Object.prototype.toString.call(o) === '[object Array]';\n\t}\n};\n\n\n// taken from jQuery\nvar extend = function() {\n\tvar options, name, src, copy, copyIsArray, clone, target = arguments[0] || {},\n\t\ti = 1,\n\t\tlength = arguments.length,\n\t\tdeep = false,\n\t\ttoString = Object.prototype.toString,\n\t\thasOwn = Object.prototype.hasOwnProperty,\n\t\tclass2type = {\n\t\t\t\"[object Boolean]\": \"boolean\",\n\t\t\t\"[object Number]\": \"number\",\n\t\t\t\"[object String]\": \"string\",\n\t\t\t\"[object Function]\": \"function\",\n\t\t\t\"[object Array]\": \"array\",\n\t\t\t\"[object Date]\": \"date\",\n\t\t\t\"[object RegExp]\": \"regexp\",\n\t\t\t\"[object Object]\": \"object\"\n\t\t},\n\n\t\tjQuery = {\n\t\t\tisFunction: function (obj) {\n\t\t\t\treturn jQuery.type(obj) === \"function\";\n\t\t\t},\n\t\t\tisArray: Array.isArray ||\n\t\t\t\tfunction (obj) {\n\t\t\t\t\treturn jQuery.type(obj) === \"array\";\n\t\t\t\t},\n\t\t\tisWindow: function (obj) {\n\t\t\t\treturn obj !== null && obj === obj.window;\n\t\t\t},\n\t\t\tisNumeric: function (obj) {\n\t\t\t\treturn !isNaN(parseFloat(obj)) && isFinite(obj);\n\t\t\t},\n\t\t\ttype: function (obj) {\n\t\t\t\treturn obj === null ? String(obj) : class2type[toString.call(obj)] || \"object\";\n\t\t\t},\n\t\t\tisPlainObject: function (obj) {\n\t\t\t\tif (!obj || jQuery.type(obj) !== \"object\" || obj.nodeType) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\ttry {\n\t\t\t\t\tif (obj.constructor && !hasOwn.call(obj, \"constructor\") && !hasOwn.call(obj.constructor.prototype, \"isPrototypeOf\")) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tvar key;\n\t\t\t\tfor (key in obj) {}\n\t\t\t\treturn key === undefined || hasOwn.call(obj, key);\n\t\t\t}\n\t\t};\n\tif (typeof target === \"boolean\") {\n\t\tdeep = target;\n\t\ttarget = arguments[1] || {};\n\t\ti = 2;\n\t}\n\tif (typeof target !== \"object\" && !jQuery.isFunction(target)) {\n\t\ttarget = {};\n\t}\n\tif (length === i) {\n\t\ttarget = this;\n\t\t--i;\n\t}\n\tfor (i; i < length; i++) {\n\t\tif ((options = arguments[i]) !== null) {\n\t\t\tfor (name in options) {\n\t\t\t\tsrc = target[name];\n\t\t\t\tcopy = options[name];\n\t\t\t\tif (target === copy) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (deep && copy && (jQuery.isPlainObject(copy) || (copyIsArray = jQuery.isArray(copy)))) {\n\t\t\t\t\tif (copyIsArray) {\n\t\t\t\t\t\tcopyIsArray = false;\n\t\t\t\t\t\tclone = src && jQuery.isArray(src) ? src : [];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tclone = src && jQuery.isPlainObject(src) ? src : {};\n\t\t\t\t\t}\n\t\t\t\t\t// WARNING: RECURSION\n\t\t\t\t\ttarget[name] = extend(deep, clone, copy);\n\t\t\t\t} else if (copy !== undefined) {\n\t\t\t\t\ttarget[name] = copy;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn target;\n};\n\t//// --------- math.js -----------\nvar math = {\n\n\ttoRadians: function(degrees) {\n\t\treturn degrees * (Math.PI / 180);\n\t},\n\n\ttoDegrees: function(radians) {\n\t\treturn radians * (180 / Math.PI);\n\t},\n\n\tcomputePieRadius: function(pie) {\n\t\tvar size = pie.options.size;\n\t\tvar canvasPadding = pie.options.misc.canvasPadding;\n\n\t\t// outer radius is either specified (e.g. through the generator), or omitted altogether\n\t\t// and calculated based on the canvas dimensions. Right now the estimated version isn't great - it should\n\t\t// be possible to calculate it to precisely generate the maximum sized pie, but it's fussy as heck. Something\n\t\t// for the next release.\n\n\t\t// first, calculate the default _outerRadius\n\t\tvar w = size.canvasWidth - canvasPadding.left - canvasPadding.right;\n\t\tvar h = size.canvasHeight - canvasPadding.top - canvasPadding.bottom;\n\n\t\t// now factor in the footer, title & subtitle\n    if (pie.options.header.location !== \"pie-center\") {\n      h -= pie.textComponents.headerHeight;\n    }\n\n    if (pie.textComponents.footer.exists) {\n      h -= pie.textComponents.footer.h;\n    }\n\n\t\t// for really teeny pies, h may be < 0. Adjust it back\n\t\th = (h < 0) ? 0 : h;\n\n\t\tvar outerRadius = ((w < h) ? w : h) / 3;\n\t\tvar innerRadius, percent;\n\n\t\t// if the user specified something, use that instead\n\t\tif (size.pieOuterRadius !== null) {\n\t\t\tif (/%/.test(size.pieOuterRadius)) {\n\t\t\t\tpercent = parseInt(size.pieOuterRadius.replace(/[\\D]/, \"\"), 10);\n\t\t\t\tpercent = (percent > 99) ? 99 : percent;\n\t\t\t\tpercent = (percent < 0) ? 0 : percent;\n\n\t\t\t\tvar smallestDimension = (w < h) ? w : h;\n\n\t\t\t\t// now factor in the label line size\n\t\t\t\tif (pie.options.labels.outer.format !== \"none\") {\n\t\t\t\t\tvar pieDistanceSpace = parseInt(pie.options.labels.outer.pieDistance, 10) * 2;\n\t\t\t\t\tif (smallestDimension - pieDistanceSpace > 0) {\n\t\t\t\t\t\tsmallestDimension -= pieDistanceSpace;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\touterRadius = Math.floor((smallestDimension / 100) * percent) / 2;\n\t\t\t} else {\n\t\t\t\touterRadius = parseInt(size.pieOuterRadius, 10);\n\t\t\t}\n\t\t}\n\n\t\t// inner radius\n\t\tif (/%/.test(size.pieInnerRadius)) {\n\t\t\tpercent = parseInt(size.pieInnerRadius.replace(/[\\D]/, \"\"), 10);\n\t\t\tpercent = (percent > 99) ? 99 : percent;\n\t\t\tpercent = (percent < 0) ? 0 : percent;\n\t\t\tinnerRadius = Math.floor((outerRadius / 100) * percent);\n\t\t} else {\n\t\t\tinnerRadius = parseInt(size.pieInnerRadius, 10);\n\t\t}\n\n\t\tpie.innerRadius = innerRadius;\n\t\tpie.outerRadius = outerRadius;\n\t},\n\n\tgetTotalPieSize: function(data) {\n\t\tvar totalSize = 0;\n\t\tfor (var i=0; i<data.length; i++) {\n\t\t\ttotalSize += data[i].value;\n\t\t}\n\t\treturn totalSize;\n\t},\n\n\tsortPieData: function(pie) {\n\t\tvar data                 = pie.options.data.content;\n\t\tvar sortOrder            = pie.options.data.sortOrder;\n\n\t\tswitch (sortOrder) {\n\t\t\tcase \"none\":\n\t\t\t\t// do nothing\n\t\t\t\tbreak;\n\t\t\tcase \"random\":\n\t\t\t\tdata = helpers.shuffleArray(data);\n\t\t\t\tbreak;\n\t\t\tcase \"value-asc\":\n\t\t\t\tdata.sort(function(a, b) { return (a.value < b.value) ? -1 : 1; });\n\t\t\t\tbreak;\n\t\t\tcase \"value-desc\":\n\t\t\t\tdata.sort(function(a, b) { return (a.value < b.value) ? 1 : -1; });\n\t\t\t\tbreak;\n\t\t\tcase \"label-asc\":\n\t\t\t\tdata.sort(function(a, b) { return (a.label.toLowerCase() > b.label.toLowerCase()) ? 1 : -1; });\n\t\t\t\tbreak;\n\t\t\tcase \"label-desc\":\n\t\t\t\tdata.sort(function(a, b) { return (a.label.toLowerCase() < b.label.toLowerCase()) ? 1 : -1; });\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn data;\n\t},\n\n\t\n\n\t// var pieCenter = math.getPieCenter();\n\tgetPieTranslateCenter: function(pieCenter) {\n\t\treturn \"translate(\" + pieCenter.x + \",\" + pieCenter.y + \")\";\n\t},\n\n\t/**\n\t * Used to determine where on the canvas the center of the pie chart should be. It takes into account the\n\t * height and position of the title, subtitle and footer, and the various paddings.\n\t * @private\n\t */\n\tcalculatePieCenter: function(pie) {\n\t\tvar pieCenterOffset = pie.options.misc.pieCenterOffset;\n\t\tvar hasTopTitle    = (pie.textComponents.title.exists && pie.options.header.location !== \"pie-center\");\n\t\tvar hasTopSubtitle = (pie.textComponents.subtitle.exists && pie.options.header.location !== \"pie-center\");\n\n\t\tvar headerOffset = pie.options.misc.canvasPadding.top;\n\t\tif (hasTopTitle && hasTopSubtitle) {\n\t\t\theaderOffset += pie.textComponents.title.h + pie.options.header.titleSubtitlePadding + pie.textComponents.subtitle.h;\n\t\t} else if (hasTopTitle) {\n\t\t\theaderOffset += pie.textComponents.title.h;\n\t\t} else if (hasTopSubtitle) {\n\t\t\theaderOffset += pie.textComponents.subtitle.h;\n\t\t}\n\n\t\tvar footerOffset = 0;\n\t\tif (pie.textComponents.footer.exists) {\n\t\t\tfooterOffset = pie.textComponents.footer.h + pie.options.misc.canvasPadding.bottom;\n\t\t}\n\n\t\tvar x = ((pie.options.size.canvasWidth - pie.options.misc.canvasPadding.left - pie.options.misc.canvasPadding.right) / 2) + pie.options.misc.canvasPadding.left;\n\t\tvar y = ((pie.options.size.canvasHeight - footerOffset - headerOffset) / 2) + headerOffset;\n\n\t\tx += pieCenterOffset.x;\n\t\ty += pieCenterOffset.y;\n\n\t\tpie.pieCenter = { x: x, y: y };\n\t},\n\n\n\t/**\n\t * Rotates a point (x, y) around an axis (xm, ym) by degrees (a).\n\t * @param x\n\t * @param y\n\t * @param xm\n\t * @param ym\n\t * @param a angle in degrees\n\t * @returns {Array}\n\t */\n\trotate: function(x, y, xm, ym, a) {\n\n        a = a * Math.PI / 180; // convert to radians\n\n        var cos = Math.cos,\n\t\t\tsin = Math.sin,\n\t\t// subtract midpoints, so that midpoint is translated to origin and add it in the end again\n\t\txr = (x - xm) * cos(a) - (y - ym) * sin(a) + xm,\n\t\tyr = (x - xm) * sin(a) + (y - ym) * cos(a) + ym;\n\n\t\treturn { x: xr, y: yr };\n\t},\n\n\t/**\n\t * Translates a point x, y by distance d, and by angle a.\n\t * @param x\n\t * @param y\n\t * @param dist\n\t * @param a angle in degrees\n\t */\n\ttranslate: function(x, y, d, a) {\n\t\tvar rads = math.toRadians(a);\n\t\treturn {\n\t\t\tx: x + d * Math.sin(rads),\n\t\t\ty: y - d * Math.cos(rads)\n\t\t};\n\t},\n\n\t// from: http://stackoverflow.com/questions/19792552/d3-put-arc-labels-in-a-pie-chart-if-there-is-enough-space\n\tpointIsInArc: function(pt, ptData, d3Arc) {\n\t\t// Center of the arc is assumed to be 0,0\n\t\t// (pt.x, pt.y) are assumed to be relative to the center\n\t\tvar r1 = d3Arc.innerRadius()(ptData), // Note: Using the innerRadius\n\t\t\tr2 = d3Arc.outerRadius()(ptData),\n\t\t\ttheta1 = d3Arc.startAngle()(ptData),\n\t\t\ttheta2 = d3Arc.endAngle()(ptData);\n\n\t\tvar dist = pt.x * pt.x + pt.y * pt.y,\n\t\t\tangle = Math.atan2(pt.x, -pt.y); // Note: different coordinate system\n\n\t\tangle = (angle < 0) ? (angle + Math.PI * 2) : angle;\n\n\t\treturn (r1 * r1 <= dist) && (dist <= r2 * r2) &&\n\t\t\t(theta1 <= angle) && (angle <= theta2);\n\t}\n};\n\n\t//// --------- labels.js -----------\nvar labels = {\n\n\t/**\n\t * Adds the labels to the pie chart, but doesn't position them. There are two locations for the\n\t * labels: inside (center) of the segments, or outside the segments on the edge.\n\t * @param section \"inner\" or \"outer\"\n\t * @param sectionDisplayType \"percentage\", \"value\", \"label\", \"label-value1\", etc.\n\t * @param pie\n\t */\n\tadd: function(pie, section, sectionDisplayType) {\n\t\tvar include = labels.getIncludes(sectionDisplayType);\n\t\tvar settings = pie.options.labels;\n\n\t\t// group the label groups (label, percentage, value) into a single element for simpler positioning\n\t\tvar outerLabel = pie.svg.insert(\"g\", \".\" + pie.cssPrefix + \"labels-\" + section)\n\t\t\t.attr(\"class\", pie.cssPrefix + \"labels-\" + section);\n\n\t\tvar labelGroup = outerLabel.selectAll(\".\" + pie.cssPrefix + \"labelGroup-\" + section)\n\t\t\t.data(pie.options.data.content)\n\t\t\t.enter()\n\t\t\t.append(\"g\")\n\t\t\t.attr(\"id\", function(d, i) { return pie.cssPrefix + \"labelGroup\" + i + \"-\" + section; })\n\t\t\t.attr(\"data-index\", function(d, i) { return i; })\n\t\t\t.attr(\"class\", pie.cssPrefix + \"labelGroup-\" + section)\n\t\t\t.style(\"opacity\", 0);\n\n    var formatterContext = { section: section, sectionDisplayType: sectionDisplayType };\n\n\t\t// 1. Add the main label\n\t\tif (include.mainLabel) {\n\t\t\tlabelGroup.append(\"text\")\n\t\t\t\t.attr(\"id\", function(d, i) { return pie.cssPrefix + \"segmentMainLabel\" + i + \"-\" + section; })\n\t\t\t\t.attr(\"class\", pie.cssPrefix + \"segmentMainLabel-\" + section)\n\t\t\t\t.text(function(d, i) {\n\t\t\t\t\tvar str = d.label;\n\n          // if a custom formatter has been defined, pass it the raw label string - it can do whatever it wants with it.\n          // we only apply truncation if it's not defined\n\t\t\t\t\tif (settings.formatter) {\n            formatterContext.index = i;\n            formatterContext.part = 'mainLabel';\n            formatterContext.value = d.value;\n            formatterContext.label = str;\n            str = settings.formatter(formatterContext);\n          } else if (settings.truncation.enabled && d.label.length > settings.truncation.truncateLength) {\n            str = d.label.substring(0, settings.truncation.truncateLength) + \"...\";\n          }\n          return str;\n\t\t\t\t})\n\t\t\t\t.style(\"font-size\", settings.mainLabel.fontSize + \"px\")\n\t\t\t\t.style(\"font-family\", settings.mainLabel.font)\n\t\t\t\t.style(\"fill\", settings.mainLabel.color);\n\t\t}\n\n\t\t// 2. Add the percentage label\n\t\tif (include.percentage) {\n\t\t\tlabelGroup.append(\"text\")\n\t\t\t\t.attr(\"id\", function(d, i) { return pie.cssPrefix + \"segmentPercentage\" + i + \"-\" + section; })\n\t\t\t\t.attr(\"class\", pie.cssPrefix + \"segmentPercentage-\" + section)\n\t\t\t\t.text(function(d, i) {\n\t\t\t\t\tvar percentage = segments.getPercentage(pie, i, pie.options.labels.percentage.decimalPlaces);\n          if (settings.formatter) {\n            formatterContext.index = i;\n            formatterContext.part = \"percentage\";\n            formatterContext.value = d.value;\n            formatterContext.label = percentage;\n            percentage = settings.formatter(formatterContext);\n          } else {\n            percentage += \"%\";\n          }\n          return percentage;\n\t\t\t\t})\n\t\t\t\t.style(\"font-size\", settings.percentage.fontSize + \"px\")\n\t\t\t\t.style(\"font-family\", settings.percentage.font)\n\t\t\t\t.style(\"fill\", settings.percentage.color);\n\t\t}\n\n\t\t// 3. Add the value label\n\t\tif (include.value) {\n\t\t\tlabelGroup.append(\"text\")\n\t\t\t\t.attr(\"id\", function(d, i) { return pie.cssPrefix +  \"segmentValue\" + i + \"-\" + section; })\n\t\t\t\t.attr(\"class\", pie.cssPrefix + \"segmentValue-\" + section)\n\t\t\t\t.text(function(d, i) {\n          formatterContext.index = i;\n          formatterContext.part = \"value\";\n          formatterContext.value = d.value;\n          formatterContext.label = d.value;\n          return settings.formatter ? settings.formatter(formatterContext, d.value) : d.value;\n        })\n\t\t\t\t.style(\"font-size\", settings.value.fontSize + \"px\")\n\t\t\t\t.style(\"font-family\", settings.value.font)\n\t\t\t\t.style(\"fill\", settings.value.color);\n\t\t}\n\t},\n\n\t/**\n\t * @param section \"inner\" / \"outer\"\n\t */\n\tpositionLabelElements: function(pie, section, sectionDisplayType) {\n\t\tlabels[\"dimensions-\" + section] = [];\n\n\t\t// get the latest widths, heights\n\t\tvar labelGroups = d3.selectAll(\".\" + pie.cssPrefix + \"labelGroup-\" + section);\n\t\tlabelGroups.each(function(d, i) {\n\t\t\tvar mainLabel  = d3.select(this).selectAll(\".\" + pie.cssPrefix + \"segmentMainLabel-\" + section);\n\t\t\tvar percentage = d3.select(this).selectAll(\".\" + pie.cssPrefix + \"segmentPercentage-\" + section);\n\t\t\tvar value      = d3.select(this).selectAll(\".\" + pie.cssPrefix + \"segmentValue-\" + section);\n\n\t\t\tlabels[\"dimensions-\" + section].push({\n\t\t\t\tmainLabel:  (mainLabel.node() !== null) ? mainLabel.node().getBBox() : null,\n\t\t\t\tpercentage: (percentage.node() !== null) ? percentage.node().getBBox() : null,\n\t\t\t\tvalue:      (value.node() !== null) ? value.node().getBBox() : null\n\t\t\t});\n\t\t});\n\n\t\tvar singleLinePad = 5;\n\t\tvar dims = labels[\"dimensions-\" + section];\n\t\tswitch (sectionDisplayType) {\n\t\t\tcase \"label-value1\":\n\t\t\t\td3.selectAll(\".\" + pie.cssPrefix + \"segmentValue-\" + section)\n\t\t\t\t\t.attr(\"dx\", function(d, i) { return dims[i].mainLabel.width + singleLinePad; });\n\t\t\t\tbreak;\n\t\t\tcase \"label-value2\":\n\t\t\t\td3.selectAll(\".\" + pie.cssPrefix + \"segmentValue-\" + section)\n\t\t\t\t\t.attr(\"dy\", function(d, i) { return dims[i].mainLabel.height; });\n\t\t\t\tbreak;\n\t\t\tcase \"label-percentage1\":\n\t\t\t\td3.selectAll(\".\" + pie.cssPrefix + \"segmentPercentage-\" + section)\n\t\t\t\t\t.attr(\"dx\", function(d, i) { return dims[i].mainLabel.width + singleLinePad; });\n\t\t\t\tbreak;\n\t\t\tcase \"label-percentage2\":\n\t\t\t\td3.selectAll(\".\" + pie.cssPrefix + \"segmentPercentage-\" + section)\n\t\t\t\t\t.attr(\"dx\", function(d, i) { return (dims[i].mainLabel.width / 2) - (dims[i].percentage.width / 2); })\n\t\t\t\t\t.attr(\"dy\", function(d, i) { return dims[i].mainLabel.height; });\n\t\t\t\tbreak;\n\t \t}\n\t},\n\n\tcomputeLabelLinePositions: function(pie) {\n\t\tpie.lineCoordGroups = [];\n\t\td3.selectAll(\".\" + pie.cssPrefix + \"labelGroup-outer\")\n\t\t\t.each(function(d, i) { return labels.computeLinePosition(pie, i); });\n\t},\n\n\tcomputeLinePosition: function(pie, i) {\n\t\tvar angle = segments.getSegmentAngle(i, pie.options.data.content, pie.totalSize, { midpoint: true });\n\t\tvar originCoords = math.rotate(pie.pieCenter.x, pie.pieCenter.y - pie.outerRadius, pie.pieCenter.x, pie.pieCenter.y, angle);\n\t\tvar heightOffset = pie.outerLabelGroupData[i].h / 5; // TODO check\n\t\tvar labelXMargin = 6; // the x-distance of the label from the end of the line [TODO configurable]\n\n\t\tvar quarter = Math.floor(angle / 90);\n\t\tvar midPoint = 4;\n\t\tvar x2, y2, x3, y3;\n\n\t\t// this resolves an issue when the\n\t\tif (quarter === 2 && angle === 180) {\n\t\t\tquarter = 1;\n\t\t}\n\n\t\tswitch (quarter) {\n\t\t\tcase 0:\n\t\t\t\tx2 = pie.outerLabelGroupData[i].x - labelXMargin - ((pie.outerLabelGroupData[i].x - labelXMargin - originCoords.x) / 2);\n\t\t\t\ty2 = pie.outerLabelGroupData[i].y + ((originCoords.y - pie.outerLabelGroupData[i].y) / midPoint);\n\t\t\t\tx3 = pie.outerLabelGroupData[i].x - labelXMargin;\n\t\t\t\ty3 = pie.outerLabelGroupData[i].y - heightOffset;\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tx2 = originCoords.x + (pie.outerLabelGroupData[i].x - originCoords.x) / midPoint;\n\t\t\t\ty2 = originCoords.y + (pie.outerLabelGroupData[i].y - originCoords.y) / midPoint;\n\t\t\t\tx3 = pie.outerLabelGroupData[i].x - labelXMargin;\n\t\t\t\ty3 = pie.outerLabelGroupData[i].y - heightOffset;\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tvar startOfLabelX = pie.outerLabelGroupData[i].x + pie.outerLabelGroupData[i].w + labelXMargin;\n\t\t\t\tx2 = originCoords.x - (originCoords.x - startOfLabelX) / midPoint;\n\t\t\t\ty2 = originCoords.y + (pie.outerLabelGroupData[i].y - originCoords.y) / midPoint;\n\t\t\t\tx3 = pie.outerLabelGroupData[i].x + pie.outerLabelGroupData[i].w + labelXMargin;\n\t\t\t\ty3 = pie.outerLabelGroupData[i].y - heightOffset;\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tvar startOfLabel = pie.outerLabelGroupData[i].x + pie.outerLabelGroupData[i].w + labelXMargin;\n\t\t\t\tx2 = startOfLabel + ((originCoords.x - startOfLabel) / midPoint);\n\t\t\t\ty2 = pie.outerLabelGroupData[i].y + (originCoords.y - pie.outerLabelGroupData[i].y) / midPoint;\n\t\t\t\tx3 = pie.outerLabelGroupData[i].x + pie.outerLabelGroupData[i].w + labelXMargin;\n\t\t\t\ty3 = pie.outerLabelGroupData[i].y - heightOffset;\n\t\t\t\tbreak;\n\t\t}\n\n\t\t/*\n\t\t * x1 / y1: the x/y coords of the start of the line, at the mid point of the segments arc on the pie circumference\n\t\t * x2 / y2: if \"curved\" line style is being used, this is the midpoint of the line. Other\n\t\t * x3 / y3: the end of the line; closest point to the label\n\t\t */\n\t\tif (pie.options.labels.lines.style === \"straight\") {\n\t\t\tpie.lineCoordGroups[i] = [\n\t\t\t\t{ x: originCoords.x, y: originCoords.y },\n\t\t\t\t{ x: x3, y: y3 }\n\t\t\t];\n\t\t} else {\n\t\t\tpie.lineCoordGroups[i] = [\n\t\t\t\t{ x: originCoords.x, y: originCoords.y },\n\t\t\t\t{ x: x2, y: y2 },\n\t\t\t\t{ x: x3, y: y3 }\n\t\t\t];\n\t\t}\n\t},\n\n\taddLabelLines: function(pie) {\n\t\tvar lineGroups = pie.svg.insert(\"g\", \".\" + pie.cssPrefix + \"pieChart\") // meaning, BEFORE .pieChart\n\t\t\t.attr(\"class\", pie.cssPrefix + \"lineGroups\")\n\t\t\t.style(\"opacity\", 0);\n\n\t\tvar lineGroup = lineGroups.selectAll(\".\" + pie.cssPrefix + \"lineGroup\")\n\t\t\t.data(pie.lineCoordGroups)\n\t\t\t.enter()\n\t\t\t.append(\"g\")\n\t\t\t.attr(\"class\", pie.cssPrefix + \"lineGroup\");\n\n\t\tvar lineFunction = d3.svg.line()\n\t\t\t.interpolate(\"basis\")\n\t\t\t.x(function(d) { return d.x; })\n\t\t\t.y(function(d) { return d.y; });\n\n\t\tlineGroup.append(\"path\")\n\t\t\t.attr(\"d\", lineFunction)\n\t\t\t.attr(\"stroke\", function(d, i) {\n\t\t\t\treturn (pie.options.labels.lines.color === \"segment\") ? pie.options.colors[i] : pie.options.labels.lines.color;\n\t\t\t})\n\t\t\t.attr(\"stroke-width\", 1)\n\t\t\t.attr(\"fill\", \"none\")\n\t\t\t.style(\"opacity\", function(d, i) {\n\t\t\t\tvar percentage = pie.options.labels.outer.hideWhenLessThanPercentage;\n\t\t\t\tvar segmentPercentage = segments.getPercentage(pie, i, pie.options.labels.percentage.decimalPlaces);\n\t\t\t\tvar isHidden = (percentage !== null && segmentPercentage < percentage) || pie.options.data.content[i].label === \"\";\n\t\t\t\treturn isHidden ? 0 : 1;\n\t\t\t});\n\t},\n\n\tpositionLabelGroups: function(pie, section) {\n    if (pie.options.labels[section].format === \"none\") {\n      return;\n    }\n\n\t\td3.selectAll(\".\" + pie.cssPrefix + \"labelGroup-\" + section)\n\t\t\t.style(\"opacity\", 0)\n\t\t\t.attr(\"transform\", function(d, i) {\n\t\t\t\tvar x, y;\n\t\t\t\tif (section === \"outer\") {\n\t\t\t\t\tx = pie.outerLabelGroupData[i].x;\n\t\t\t\t\ty = pie.outerLabelGroupData[i].y;\n\t\t\t\t} else {\n\t\t\t\t\tvar pieCenterCopy = extend(true, {}, pie.pieCenter);\n\n\t\t\t\t\t// now recompute the \"center\" based on the current _innerRadius\n\t\t\t\t\tif (pie.innerRadius > 0) {\n\t\t\t\t\t\tvar angle = segments.getSegmentAngle(i, pie.options.data.content, pie.totalSize, { midpoint: true });\n\t\t\t\t\t\tvar newCoords = math.translate(pie.pieCenter.x, pie.pieCenter.y, pie.innerRadius, angle);\n\t\t\t\t\t\tpieCenterCopy.x = newCoords.x;\n\t\t\t\t\t\tpieCenterCopy.y = newCoords.y;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar dims = helpers.getDimensions(pie.cssPrefix + \"labelGroup\" + i + \"-inner\");\n\t\t\t\t\tvar xOffset = dims.w / 2;\n\t\t\t\t\tvar yOffset = dims.h / 4; // confusing! Why 4? should be 2, but it doesn't look right\n\n\t\t\t\t\tx = pieCenterCopy.x + (pie.lineCoordGroups[i][0].x - pieCenterCopy.x) / 1.8;\n\t\t\t\t\ty = pieCenterCopy.y + (pie.lineCoordGroups[i][0].y - pieCenterCopy.y) / 1.8;\n\n\t\t\t\t\tx = x - xOffset;\n\t\t\t\t\ty = y + yOffset;\n\t\t\t\t}\n\n\t\t\t\treturn \"translate(\" + x + \",\" + y + \")\";\n\t\t\t});\n\t},\n\n\n\tfadeInLabelsAndLines: function(pie) {\n\n\t\t// fade in the labels when the load effect is complete - or immediately if there's no load effect\n\t\tvar loadSpeed = (pie.options.effects.load.effect === \"default\") ? pie.options.effects.load.speed : 1;\n\t\tsetTimeout(function() {\n\t\t\tvar labelFadeInTime = (pie.options.effects.load.effect === \"default\") ? 400 : 1; // 400 is hardcoded for the present\n\n\t\t\td3.selectAll(\".\" + pie.cssPrefix + \"labelGroup-outer\")\n\t\t\t\t.transition()\n\t\t\t\t.duration(labelFadeInTime)\n\t\t\t\t.style(\"opacity\", function(d, i) {\n\t\t\t\t\tvar percentage = pie.options.labels.outer.hideWhenLessThanPercentage;\n\t\t\t\t\tvar segmentPercentage = segments.getPercentage(pie, i, pie.options.labels.percentage.decimalPlaces);\n\t\t\t\t\treturn (percentage !== null && segmentPercentage < percentage) ? 0 : 1;\n\t\t\t\t});\n\n\t\t\td3.selectAll(\".\" + pie.cssPrefix + \"labelGroup-inner\")\n\t\t\t\t.transition()\n\t\t\t\t.duration(labelFadeInTime)\n\t\t\t\t.style(\"opacity\", function(d, i) {\n\t\t\t\t\tvar percentage = pie.options.labels.inner.hideWhenLessThanPercentage;\n\t\t\t\t\tvar segmentPercentage = segments.getPercentage(pie, i, pie.options.labels.percentage.decimalPlaces);\n\t\t\t\t\treturn (percentage !== null && segmentPercentage < percentage) ? 0 : 1;\n\t\t\t\t});\n\n\t\t\td3.selectAll(\"g.\" + pie.cssPrefix + \"lineGroups\")\n\t\t\t\t.transition()\n\t\t\t\t.duration(labelFadeInTime)\n\t\t\t\t.style(\"opacity\", 1);\n\n\t\t\t// once everything's done loading, trigger the onload callback if defined\n\t\t\tif (helpers.isFunction(pie.options.callbacks.onload)) {\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tpie.options.callbacks.onload();\n\t\t\t\t\t} catch (e) { }\n\t\t\t\t}, labelFadeInTime);\n\t\t\t}\n\t\t}, loadSpeed);\n\t},\n\n\tgetIncludes: function(val) {\n\t\tvar addMainLabel  = false;\n\t\tvar addValue      = false;\n\t\tvar addPercentage = false;\n\n\t\tswitch (val) {\n\t\t\tcase \"label\":\n\t\t\t\taddMainLabel = true;\n\t\t\t\tbreak;\n\t\t\tcase \"value\":\n\t\t\t\taddValue = true;\n\t\t\t\tbreak;\n\t\t\tcase \"percentage\":\n\t\t\t\taddPercentage = true;\n\t\t\t\tbreak;\n\t\t\tcase \"label-value1\":\n\t\t\tcase \"label-value2\":\n\t\t\t\taddMainLabel = true;\n\t\t\t\taddValue = true;\n\t\t\t\tbreak;\n\t\t\tcase \"label-percentage1\":\n\t\t\tcase \"label-percentage2\":\n\t\t\t\taddMainLabel = true;\n\t\t\t\taddPercentage = true;\n\t\t\t\tbreak;\n\t\t}\n\t\treturn {\n\t\t\tmainLabel: addMainLabel,\n\t\t\tvalue: addValue,\n\t\t\tpercentage: addPercentage\n\t\t};\n\t},\n\n\n\t/**\n\t * This does the heavy-lifting to compute the actual coordinates for the outer label groups. It does two things:\n\t * 1. Make a first pass and position them in the ideal positions, based on the pie sizes\n\t * 2. Do some basic collision avoidance.\n\t */\n\tcomputeOuterLabelCoords: function(pie) {\n\n\t\t// 1. figure out the ideal positions for the outer labels\n\t\tpie.svg.selectAll(\".\" + pie.cssPrefix + \"labelGroup-outer\")\n\t\t\t.each(function(d, i) {\n\t\t\t\treturn labels.getIdealOuterLabelPositions(pie, i);\n\t\t\t});\n\n\t\t// 2. now adjust those positions to try to accommodate conflicts\n\t\tlabels.resolveOuterLabelCollisions(pie);\n\t},\n\n\t/**\n\t * This attempts to resolve label positioning collisions.\n\t */\n\tresolveOuterLabelCollisions: function(pie) {\n    if (pie.options.labels.outer.format === \"none\") {\n      return;\n    }\n\n\t\tvar size = pie.options.data.content.length;\n\t\tlabels.checkConflict(pie, 0, \"clockwise\", size);\n\t\tlabels.checkConflict(pie, size-1, \"anticlockwise\", size);\n\t},\n\n\tcheckConflict: function(pie, currIndex, direction, size) {\n    var i, curr;\n\n\t\tif (size <= 1) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar currIndexHemisphere = pie.outerLabelGroupData[currIndex].hs;\n\t\tif (direction === \"clockwise\" && currIndexHemisphere !== \"right\") {\n\t\t\treturn;\n\t\t}\n\t\tif (direction === \"anticlockwise\" && currIndexHemisphere !== \"left\") {\n\t\t\treturn;\n\t\t}\n\t\tvar nextIndex = (direction === \"clockwise\") ? currIndex+1 : currIndex-1;\n\n\t\t// this is the current label group being looked at. We KNOW it's positioned properly (the first item\n\t\t// is always correct)\n\t\tvar currLabelGroup = pie.outerLabelGroupData[currIndex];\n\n\t\t// this one we don't know about. That's the one we're going to look at and move if necessary\n\t\tvar examinedLabelGroup = pie.outerLabelGroupData[nextIndex];\n\n\t\tvar info = {\n\t\t\tlabelHeights: pie.outerLabelGroupData[0].h,\n\t\t\tcenter: pie.pieCenter,\n\t\t\tlineLength: (pie.outerRadius + pie.options.labels.outer.pieDistance),\n\t\t\theightChange: pie.outerLabelGroupData[0].h + 1 // 1 = padding\n\t\t};\n\n\t\t// loop through *ALL* label groups examined so far to check for conflicts. This is because when they're\n\t\t// very tightly fitted, a later label group may still appear high up on the page\n\t\tif (direction === \"clockwise\") {\n      i = 0;\n\t\t\tfor (; i<=currIndex; i++) {\n\t\t\t\tcurr = pie.outerLabelGroupData[i];\n\n\t\t\t\t// if there's a conflict with this label group, shift the label to be AFTER the last known\n\t\t\t\t// one that's been properly placed\n\t\t\t\tif (helpers.rectIntersect(curr, examinedLabelGroup)) {\n\t\t\t\t\tlabels.adjustLabelPos(pie, nextIndex, currLabelGroup, info);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n      i = size - 1;\n\t\t\tfor (; i >= currIndex; i--) {\n\t\t\t\tcurr = pie.outerLabelGroupData[i];\n\n\t\t\t\t// if there's a conflict with this label group, shift the label to be AFTER the last known\n\t\t\t\t// one that's been properly placed\n\t\t\t\tif (helpers.rectIntersect(curr, examinedLabelGroup)) {\n\t\t\t\t\tlabels.adjustLabelPos(pie, nextIndex, currLabelGroup, info);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tlabels.checkConflict(pie, nextIndex, direction, size);\n\t},\n\n\t// does a little math to shift a label into a new position based on the last properly placed one\n\tadjustLabelPos: function(pie, nextIndex, lastCorrectlyPositionedLabel, info) {\n\t\tvar xDiff, yDiff, newXPos, newYPos;\n\t\tnewYPos = lastCorrectlyPositionedLabel.y + info.heightChange;\n\t\tyDiff = info.center.y - newYPos;\n\n\t\tif (Math.abs(info.lineLength) > Math.abs(yDiff)) {\n\t\t\txDiff = Math.sqrt((info.lineLength * info.lineLength) - (yDiff * yDiff));\n\t\t} else {\n\t\t\txDiff = Math.sqrt((yDiff * yDiff) - (info.lineLength * info.lineLength));\n\t\t}\n\n\t\tif (lastCorrectlyPositionedLabel.hs === \"right\") {\n\t\t\tnewXPos = info.center.x + xDiff;\n\t\t} else {\n\t\t\tnewXPos = info.center.x - xDiff - pie.outerLabelGroupData[nextIndex].w;\n\t\t}\n\n\t\tpie.outerLabelGroupData[nextIndex].x = newXPos;\n\t\tpie.outerLabelGroupData[nextIndex].y = newYPos;\n\t},\n\n\t/**\n\t * @param i 0-N where N is the dataset size - 1.\n\t */\n\tgetIdealOuterLabelPositions: function(pie, i) {\n    var labelGroupNode = d3.select(\"#\" + pie.cssPrefix + \"labelGroup\" + i + \"-outer\").node();\n    if (!labelGroupNode) {\n      return;\n    }\n    var labelGroupDims = labelGroupNode.getBBox();\n\t\tvar angle = segments.getSegmentAngle(i, pie.options.data.content, pie.totalSize, { midpoint: true });\n\n\t\tvar originalX = pie.pieCenter.x;\n\t\tvar originalY = pie.pieCenter.y - (pie.outerRadius + pie.options.labels.outer.pieDistance);\n\t\tvar newCoords = math.rotate(originalX, originalY, pie.pieCenter.x, pie.pieCenter.y, angle);\n\n\t\t// if the label is on the left half of the pie, adjust the values\n\t\tvar hemisphere = \"right\"; // hemisphere\n\t\tif (angle > 180) {\n\t\t\tnewCoords.x -= (labelGroupDims.width + 8);\n\t\t\themisphere = \"left\";\n\t\t} else {\n\t\t\tnewCoords.x += 8;\n\t\t}\n\n\t\tpie.outerLabelGroupData[i] = {\n\t\t\tx: newCoords.x,\n\t\t\ty: newCoords.y,\n\t\t\tw: labelGroupDims.width,\n\t\t\th: labelGroupDims.height,\n\t\t\ths: hemisphere\n\t\t};\n\t}\n};\n\n\t//// --------- segments.js -----------\nvar segments = {\n\n\t/**\n\t * Creates the pie chart segments and displays them according to the desired load effect.\n\t * @private\n\t */\n\tcreate: function(pie) {\n\t\tvar pieCenter = pie.pieCenter;\n\t\tvar colors = pie.options.colors;\n\t\tvar loadEffects = pie.options.effects.load;\n\t\tvar segmentStroke = pie.options.misc.colors.segmentStroke;\n\n\t\t// we insert the pie chart BEFORE the title, to ensure the title overlaps the pie\n\t\tvar pieChartElement = pie.svg.insert(\"g\", \"#\" + pie.cssPrefix + \"title\")\n\t\t\t.attr(\"transform\", function() { return math.getPieTranslateCenter(pieCenter); })\n\t\t\t.attr(\"class\", pie.cssPrefix + \"pieChart\");\n\n\t\tvar arc = d3.svg.arc()\n\t\t\t.innerRadius(pie.innerRadius)\n\t\t\t.outerRadius(pie.outerRadius)\n\t\t\t.startAngle(0)\n\t\t\t.endAngle(function(d) {\n\t\t\t\treturn (d.value / pie.totalSize) * 2 * Math.PI;\n\t\t\t});\n\n\t\tvar g = pieChartElement.selectAll(\".\" + pie.cssPrefix + \"arc\")\n\t\t\t.data(pie.options.data.content)\n\t\t\t.enter()\n\t\t\t.append(\"g\")\n\t\t\t.attr(\"class\", pie.cssPrefix + \"arc\");\n\n\t\t// if we're not fading in the pie, just set the load speed to 0\n\t\tvar loadSpeed = loadEffects.speed;\n\t\tif (loadEffects.effect === \"none\") {\n\t\t\tloadSpeed = 0;\n\t\t}\n\n\t\tg.append(\"path\")\n\t\t\t.attr(\"id\", function(d, i) { return pie.cssPrefix + \"segment\" + i; })\n\t\t\t.attr(\"fill\", function(d, i) {\n\t\t\t\tvar color = colors[i];\n\t\t\t\tif (pie.options.misc.gradient.enabled) {\n\t\t\t\t\tcolor = \"url(#\" + pie.cssPrefix + \"grad\" + i + \")\";\n\t\t\t\t}\n\t\t\t\treturn color;\n\t\t\t})\n\t\t\t.style(\"stroke\", segmentStroke)\n\t\t\t.style(\"stroke-width\", 1)\n\t\t\t.transition()\n\t\t\t.ease(\"cubic-in-out\")\n\t\t\t.duration(loadSpeed)\n\t\t\t.attr(\"data-index\", function(d, i) { return i; })\n\t\t\t.attrTween(\"d\", function(b) {\n\t\t\t\tvar i = d3.interpolate({ value: 0 }, b);\n\t\t\t\treturn function(t) {\n\t\t\t\t\treturn pie.arc(i(t));\n\t\t\t\t};\n\t\t\t});\n\n\t\tpie.svg.selectAll(\"g.\" + pie.cssPrefix + \"arc\")\n\t\t\t.attr(\"transform\",\n\t\t\tfunction(d, i) {\n\t\t\t\tvar angle = 0;\n\t\t\t\tif (i > 0) {\n\t\t\t\t\tangle = segments.getSegmentAngle(i-1, pie.options.data.content, pie.totalSize);\n\t\t\t\t}\n\t\t\t\treturn \"rotate(\" + angle + \")\";\n\t\t\t}\n\t\t);\n\t\tpie.arc = arc;\n\t},\n\n\taddGradients: function(pie) {\n\t\tvar grads = pie.svg.append(\"defs\")\n\t\t\t.selectAll(\"radialGradient\")\n\t\t\t.data(pie.options.data.content)\n\t\t\t.enter().append(\"radialGradient\")\n\t\t\t.attr(\"gradientUnits\", \"userSpaceOnUse\")\n\t\t\t.attr(\"cx\", 0)\n\t\t\t.attr(\"cy\", 0)\n\t\t\t.attr(\"r\", \"120%\")\n\t\t\t.attr(\"id\", function(d, i) { return pie.cssPrefix + \"grad\" + i; });\n\n\t\tgrads.append(\"stop\").attr(\"offset\", \"0%\").style(\"stop-color\", function(d, i) { return pie.options.colors[i]; });\n\t\tgrads.append(\"stop\").attr(\"offset\", pie.options.misc.gradient.percentage + \"%\").style(\"stop-color\", pie.options.misc.gradient.color);\n\t},\n\n\taddSegmentEventHandlers: function(pie) {\n\t\tvar arc = d3.selectAll(\".\" + pie.cssPrefix + \"arc,.\" + pie.cssPrefix + \"labelGroup-inner,.\" + pie.cssPrefix + \"labelGroup-outer\");\n\n\t\tarc.on(\"click\", function() {\n\t\t\tvar currentEl = d3.select(this);\n\t\t\tvar segment;\n\n\t\t\t// mouseover works on both the segments AND the segment labels, hence the following\n\t\t\tif (currentEl.attr(\"class\") === pie.cssPrefix + \"arc\") {\n\t\t\t\tsegment = currentEl.select(\"path\");\n\t\t\t} else {\n\t\t\t\tvar index = currentEl.attr(\"data-index\");\n\t\t\t\tsegment = d3.select(\"#\" + pie.cssPrefix + \"segment\" + index);\n\t\t\t}\n\t\t\tvar isExpanded = segment.attr(\"class\") === pie.cssPrefix + \"expanded\";\n\t\t\tsegments.onSegmentEvent(pie, pie.options.callbacks.onClickSegment, segment, isExpanded);\n\t\t\tif (pie.options.effects.pullOutSegmentOnClick.effect !== \"none\") {\n\t\t\t\tif (isExpanded) {\n\t\t\t\t\tsegments.closeSegment(pie, segment.node());\n\t\t\t\t} else {\n\t\t\t\t\tsegments.openSegment(pie, segment.node());\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tarc.on(\"mouseover\", function() {\n\t\t\tvar currentEl = d3.select(this);\n\t\t\tvar segment, index;\n\n\t\t\tif (currentEl.attr(\"class\") === pie.cssPrefix + \"arc\") {\n\t\t\t\tsegment = currentEl.select(\"path\");\n\t\t\t} else {\n\t\t\t\tindex = currentEl.attr(\"data-index\");\n\t\t\t\tsegment = d3.select(\"#\" + pie.cssPrefix + \"segment\" + index);\n\t\t\t}\n\n\t\t\tif (pie.options.effects.highlightSegmentOnMouseover) {\n\t\t\t\tindex = segment.attr(\"data-index\");\n\t\t\t\tvar segColor = pie.options.colors[index];\n\t\t\t\tsegment.style(\"fill\", helpers.getColorShade(segColor, pie.options.effects.highlightLuminosity));\n\t\t\t}\n\n      if (pie.options.tooltips.enabled) {\n        index = segment.attr(\"data-index\");\n        tt.showTooltip(pie, index);\n      }\n\n\t\t\tvar isExpanded = segment.attr(\"class\") === pie.cssPrefix + \"expanded\";\n\t\t\tsegments.onSegmentEvent(pie, pie.options.callbacks.onMouseoverSegment, segment, isExpanded);\n\t\t});\n\n    arc.on(\"mousemove\", function() {\n      tt.moveTooltip(pie);\n    });\n\n\t\tarc.on(\"mouseout\", function() {\n\t\t\tvar currentEl = d3.select(this);\n\t\t\tvar segment, index;\n\n\t\t\tif (currentEl.attr(\"class\") === pie.cssPrefix + \"arc\") {\n\t\t\t\tsegment = currentEl.select(\"path\");\n\t\t\t} else {\n\t\t\t\tindex = currentEl.attr(\"data-index\");\n\t\t\t\tsegment = d3.select(\"#\" + pie.cssPrefix + \"segment\" + index);\n\t\t\t}\n\n\t\t\tif (pie.options.effects.highlightSegmentOnMouseover) {\n\t\t\t\tindex = segment.attr(\"data-index\");\n\t\t\t\tvar color = pie.options.colors[index];\n\t\t\t\tif (pie.options.misc.gradient.enabled) {\n\t\t\t\t\tcolor = \"url(#\" + pie.cssPrefix + \"grad\" + index + \")\";\n\t\t\t\t}\n\t\t\t\tsegment.style(\"fill\", color);\n\t\t\t}\n\n      if (pie.options.tooltips.enabled) {\n        index = segment.attr(\"data-index\");\n        tt.hideTooltip(pie, index);\n      }\n\n\t\t\tvar isExpanded = segment.attr(\"class\") === pie.cssPrefix + \"expanded\";\n\t\t\tsegments.onSegmentEvent(pie, pie.options.callbacks.onMouseoutSegment, segment, isExpanded);\n\t\t});\n\t},\n\n\t// helper function used to call the click, mouseover, mouseout segment callback functions\n\tonSegmentEvent: function(pie, func, segment, isExpanded) {\n\t\tif (!helpers.isFunction(func)) {\n\t\t\treturn;\n\t\t}\n\t\tvar index = parseInt(segment.attr(\"data-index\"), 10);\n\t\tfunc({\n\t\t\tsegment: segment.node(),\n\t\t\tindex: index,\n\t\t\texpanded: isExpanded,\n\t\t\tdata: pie.options.data.content[index]\n\t\t});\n\t},\n\n\topenSegment: function(pie, segment) {\n\t\tif (pie.isOpeningSegment) {\n\t\t\treturn;\n\t\t}\n\t\tpie.isOpeningSegment = true;\n\n\t\t// close any open segments\n\t\tif (d3.selectAll(\".\" + pie.cssPrefix + \"expanded\").length > 0) {\n\t\t\tsegments.closeSegment(pie, d3.select(\".\" + pie.cssPrefix + \"expanded\").node());\n\t\t}\n\n\t\td3.select(segment).transition()\n\t\t\t.ease(pie.options.effects.pullOutSegmentOnClick.effect)\n\t\t\t.duration(pie.options.effects.pullOutSegmentOnClick.speed)\n\t\t\t.attr(\"transform\", function(d, i) {\n\t\t\t\tvar c = pie.arc.centroid(d),\n\t\t\t\t\tx = c[0],\n\t\t\t\t\ty = c[1],\n\t\t\t\t\th = Math.sqrt(x*x + y*y),\n\t\t\t\t\tpullOutSize = parseInt(pie.options.effects.pullOutSegmentOnClick.size, 10);\n\n\t\t\t\treturn \"translate(\" + ((x/h) * pullOutSize) + ',' + ((y/h) * pullOutSize) + \")\";\n\t\t\t})\n\t\t\t.each(\"end\", function(d, i) {\n\t\t\t\tpie.currentlyOpenSegment = segment;\n\t\t\t\tpie.isOpeningSegment = false;\n\t\t\t\td3.select(this).attr(\"class\", pie.cssPrefix + \"expanded\");\n\t\t\t});\n\t},\n\n\tcloseSegment: function(pie, segment) {\n\t\td3.select(segment).transition()\n\t\t\t.duration(400)\n\t\t\t.attr(\"transform\", \"translate(0,0)\")\n\t\t\t.each(\"end\", function(d, i) {\n\t\t\t\td3.select(this).attr(\"class\", \"\");\n\t\t\t\tpie.currentlyOpenSegment = null;\n\t\t\t});\n\t},\n\n\tgetCentroid: function(el) {\n\t\tvar bbox = el.getBBox();\n\t\treturn {\n\t\t\tx: bbox.x + bbox.width / 2,\n\t\t\ty: bbox.y + bbox.height / 2\n\t\t};\n\t},\n\n\t/**\n\t * General helper function to return a segment's angle, in various different ways.\n\t * @param index\n\t * @param opts optional object for fine-tuning exactly what you want.\n\t */\n\tgetSegmentAngle: function(index, data, totalSize, opts) {\n\t\tvar options = extend({\n\t\t\t// if true, this returns the full angle from the origin. Otherwise it returns the single segment angle\n\t\t\tcompounded: true,\n\n\t\t\t// optionally returns the midpoint of the angle instead of the full angle\n\t\t\tmidpoint: false\n\t\t}, opts);\n\n\t\tvar currValue = data[index].value;\n\t\tvar fullValue;\n\t\tif (options.compounded) {\n\t\t\tfullValue = 0;\n\n\t\t\t// get all values up to and including the specified index\n\t\t\tfor (var i=0; i<=index; i++) {\n\t\t\t\tfullValue += data[i].value;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fullValue === 'undefined') {\n\t\t\tfullValue = currValue;\n\t\t}\n\n\t\t// now convert the full value to an angle\n\t\tvar angle = (fullValue / totalSize) * 360;\n\n\t\t// lastly, if we want the midpoint, factor that sucker in\n\t\tif (options.midpoint) {\n\t\t\tvar currAngle = (currValue / totalSize) * 360;\n\t\t\tangle -= (currAngle / 2);\n\t\t}\n\n\t\treturn angle;\n\t},\n\n\tgetPercentage: function(pie, index, decimalPlaces) {\n\t\tvar relativeAmount = pie.options.data.content[index].value / pie.totalSize;\n\t\tif (decimalPlaces <= 0) {\n\t\t\treturn Math.round(relativeAmount * 100);\n\t\t} else {\n\t\t\treturn (relativeAmount * 100).toFixed(decimalPlaces);\n\t\t}\n\t}\n\n};\n\n\t//// --------- text.js -----------\nvar text = {\n\toffscreenCoord: -10000,\n\n\taddTitle: function(pie) {\n\t\tvar title = pie.svg.selectAll(\".\" + pie.cssPrefix + \"title\")\n\t\t\t.data([pie.options.header.title])\n\t\t\t.enter()\n\t\t\t.append(\"text\")\n\t\t\t.text(function(d) { return d.text; })\n\t\t\t.attr({\n        id: pie.cssPrefix + \"title\",\n        class: pie.cssPrefix + \"title\",\n        x: text.offscreenCoord,\n        y: text.offscreenCoord\n      })\n\t\t\t.attr(\"text-anchor\", function() {\n\t\t\t\tvar location;\n\t\t\t\tif (pie.options.header.location === \"top-center\" || pie.options.header.location === \"pie-center\") {\n\t\t\t\t\tlocation = \"middle\";\n\t\t\t\t} else {\n\t\t\t\t\tlocation = \"left\";\n\t\t\t\t}\n\t\t\t\treturn location;\n\t\t\t})\n\t\t\t.attr(\"fill\", function(d) { return d.color; })\n\t\t\t.style(\"font-size\", function(d) { return d.fontSize + \"px\"; })\n\t\t\t.style(\"font-family\", function(d) { return d.font; });\n\t},\n\n\tpositionTitle: function(pie) {\n\t\tvar textComponents = pie.textComponents;\n\t\tvar headerLocation = pie.options.header.location;\n\t\tvar canvasPadding = pie.options.misc.canvasPadding;\n\t\tvar canvasWidth = pie.options.size.canvasWidth;\n\t\tvar titleSubtitlePadding = pie.options.header.titleSubtitlePadding;\n\n\t\tvar x;\n\t\tif (headerLocation === \"top-left\") {\n\t\t\tx = canvasPadding.left;\n\t\t} else {\n\t\t\tx = ((canvasWidth - canvasPadding.right) / 2) + canvasPadding.left;\n\t\t}\n\n    // add whatever offset has been added by user\n    x += pie.options.misc.pieCenterOffset.x;\n\n\t\tvar y = canvasPadding.top + textComponents.title.h;\n\n\t\tif (headerLocation === \"pie-center\") {\n\t\t\ty = pie.pieCenter.y;\n\n\t\t\t// still not fully correct\n\t\t\tif (textComponents.subtitle.exists) {\n\t\t\t\tvar totalTitleHeight = textComponents.title.h + titleSubtitlePadding + textComponents.subtitle.h;\n\t\t\t\ty = y - (totalTitleHeight / 2) + textComponents.title.h;\n\t\t\t} else {\n\t\t\t\ty += (textComponents.title.h / 4);\n\t\t\t}\n\t\t}\n\n\t\tpie.svg.select(\"#\" + pie.cssPrefix + \"title\")\n\t\t\t.attr(\"x\", x)\n\t\t\t.attr(\"y\", y);\n\t},\n\n\taddSubtitle: function(pie) {\n\t\tvar headerLocation = pie.options.header.location;\n\n\t\tpie.svg.selectAll(\".\" + pie.cssPrefix + \"subtitle\")\n\t\t\t.data([pie.options.header.subtitle])\n\t\t\t.enter()\n\t\t\t.append(\"text\")\n\t\t\t.text(function(d) { return d.text; })\n\t\t\t.attr(\"x\", text.offscreenCoord)\n\t\t\t.attr(\"y\", text.offscreenCoord)\n\t\t\t.attr(\"id\", pie.cssPrefix + \"subtitle\")\n\t\t\t.attr(\"class\", pie.cssPrefix + \"subtitle\")\n\t\t\t.attr(\"text-anchor\", function() {\n\t\t\t\tvar location;\n\t\t\t\tif (headerLocation === \"top-center\" || headerLocation === \"pie-center\") {\n\t\t\t\t\tlocation = \"middle\";\n\t\t\t\t} else {\n\t\t\t\t\tlocation = \"left\";\n\t\t\t\t}\n\t\t\t\treturn location;\n\t\t\t})\n\t\t\t.attr(\"fill\", function(d) { return d.color; })\n\t\t\t.style(\"font-size\", function(d) { return d.fontSize + \"px\"; })\n\t\t\t.style(\"font-family\", function(d) { return d.font; });\n\t},\n\n\tpositionSubtitle: function(pie) {\n\t\tvar canvasPadding = pie.options.misc.canvasPadding;\n\t\tvar canvasWidth = pie.options.size.canvasWidth;\n\n\t\tvar x;\n\t\tif (pie.options.header.location === \"top-left\") {\n\t\t\tx = canvasPadding.left;\n\t\t} else {\n\t\t\tx = ((canvasWidth - canvasPadding.right) / 2) + canvasPadding.left;\n\t\t}\n\n    // add whatever offset has been added by user\n    x += pie.options.misc.pieCenterOffset.x;\n\n\t\tvar y = text.getHeaderHeight(pie);\n\t\tpie.svg.select(\"#\" + pie.cssPrefix + \"subtitle\")\n\t\t\t.attr(\"x\", x)\n\t\t\t.attr(\"y\", y);\n\t},\n\n\taddFooter: function(pie) {\n\t\tpie.svg.selectAll(\".\" + pie.cssPrefix + \"footer\")\n\t\t\t.data([pie.options.footer])\n\t\t\t.enter()\n\t\t\t.append(\"text\")\n\t\t\t.text(function(d) { return d.text; })\n\t\t\t.attr(\"x\", text.offscreenCoord)\n\t\t\t.attr(\"y\", text.offscreenCoord)\n\t\t\t.attr(\"id\", pie.cssPrefix + \"footer\")\n\t\t\t.attr(\"class\", pie.cssPrefix + \"footer\")\n\t\t\t.attr(\"text-anchor\", function() {\n\t\t\t\tvar location = \"left\";\n\t\t\t\tif (pie.options.footer.location === \"bottom-center\") {\n\t\t\t\t\tlocation = \"middle\";\n\t\t\t\t} else if (pie.options.footer.location === \"bottom-right\") {\n\t\t\t\t\tlocation = \"left\"; // on purpose. We have to change the x-coord to make it properly right-aligned\n\t\t\t\t}\n\t\t\t\treturn location;\n\t\t\t})\n\t\t\t.attr(\"fill\", function(d) { return d.color; })\n\t\t\t.style(\"font-size\", function(d) { return d.fontSize + \"px\"; })\n\t\t\t.style(\"font-family\", function(d) { return d.font; });\n\t},\n\n\tpositionFooter: function(pie) {\n\t\tvar footerLocation = pie.options.footer.location;\n\t\tvar footerWidth = pie.textComponents.footer.w;\n\t\tvar canvasWidth = pie.options.size.canvasWidth;\n\t\tvar canvasHeight = pie.options.size.canvasHeight;\n\t\tvar canvasPadding = pie.options.misc.canvasPadding;\n\n\t\tvar x;\n\t\tif (footerLocation === \"bottom-left\") {\n\t\t\tx = canvasPadding.left;\n\t\t} else if (footerLocation === \"bottom-right\") {\n\t\t\tx = canvasWidth - footerWidth - canvasPadding.right;\n\t\t} else {\n\t\t\tx = canvasWidth / 2; // TODO - shouldn't this also take into account padding?\n\t\t}\n\n\t\tpie.svg.select(\"#\" + pie.cssPrefix + \"footer\")\n\t\t\t.attr(\"x\", x)\n\t\t\t.attr(\"y\", canvasHeight - canvasPadding.bottom);\n\t},\n\n\tgetHeaderHeight: function(pie) {\n\t\tvar h;\n\t\tif (pie.textComponents.title.exists) {\n\n\t\t\t// if the subtitle isn't defined, it'll be set to 0\n\t\t\tvar totalTitleHeight = pie.textComponents.title.h + pie.options.header.titleSubtitlePadding + pie.textComponents.subtitle.h;\n\t\t\tif (pie.options.header.location === \"pie-center\") {\n\t\t\t\th = pie.pieCenter.y - (totalTitleHeight / 2) + totalTitleHeight;\n\t\t\t} else {\n\t\t\t\th = totalTitleHeight + pie.options.misc.canvasPadding.top;\n\t\t\t}\n\t\t} else {\n\t\t\tif (pie.options.header.location === \"pie-center\") {\n\t\t\t\tvar footerPlusPadding = pie.options.misc.canvasPadding.bottom + pie.textComponents.footer.h;\n\t\t\t\th = ((pie.options.size.canvasHeight - footerPlusPadding) / 2) + pie.options.misc.canvasPadding.top + (pie.textComponents.subtitle.h / 2);\n\t\t\t} else {\n\t\t\t\th = pie.options.misc.canvasPadding.top + pie.textComponents.subtitle.h;\n\t\t\t}\n\t\t}\n\t\treturn h;\n\t}\n};\n\n  //// --------- validate.js -----------\nvar tt = {\n\taddTooltips: function(pie) {\n\n\t\t// group the label groups (label, percentage, value) into a single element for simpler positioning\n\t\tvar tooltips = pie.svg.insert(\"g\")\n\t\t\t.attr(\"class\", pie.cssPrefix + \"tooltips\");\n\n    tooltips.selectAll(\".\" + pie.cssPrefix + \"tooltip\")\n      .data(pie.options.data.content)\n      .enter()\n      .append(\"g\")\n        .attr(\"class\", pie.cssPrefix + \"tooltip\")\n        .attr(\"id\", function(d, i) { return pie.cssPrefix + \"tooltip\" + i; })\n        .style(\"opacity\", 0)\n      .append(\"rect\")\n        .attr({\n\t\t\t    rx: pie.options.tooltips.styles.borderRadius,\n\t\t\t    ry: pie.options.tooltips.styles.borderRadius,\n\t\t\t    x: -pie.options.tooltips.styles.padding,\n\t\t\t    opacity: pie.options.tooltips.styles.backgroundOpacity\n\t\t    })\n\t\t    .style(\"fill\", pie.options.tooltips.styles.backgroundColor);\n\n    tooltips.selectAll(\".\" + pie.cssPrefix + \"tooltip\")\n      .data(pie.options.data.content)\n      .append(\"text\")\n        .attr(\"fill\", function(d) { return pie.options.tooltips.styles.color; })\n        .style(\"font-size\", function(d) { return pie.options.tooltips.styles.fontSize; })\n        .style(\"font-family\", function(d) { return pie.options.tooltips.styles.font; })\n        .text(function(d, i) {\n          var caption = pie.options.tooltips.string;\n          if (pie.options.tooltips.type === \"caption\") {\n            caption = d.caption;\n          }\n          return tt.replacePlaceholders(pie, caption, i, {\n            label: d.label,\n            value: d.value,\n            percentage: segments.getPercentage(pie, i, pie.options.labels.percentage.decimalPlaces)\n          });\n        });\n\n\t\ttooltips.selectAll(\".\" + pie.cssPrefix + \"tooltip rect\")\n\t\t\t.attr({\n\t\t\t\twidth: function (d, i) {\n\t\t\t\t\tvar dims = helpers.getDimensions(pie.cssPrefix + \"tooltip\" + i);\n\t\t\t\t\treturn dims.w + (2 * pie.options.tooltips.styles.padding);\n\t\t\t\t},\n\t\t\t\theight: function (d, i) {\n\t\t\t\t\tvar dims = helpers.getDimensions(pie.cssPrefix + \"tooltip\" + i);\n\t\t\t\t\treturn dims.h + (2 * pie.options.tooltips.styles.padding);\n\t\t\t\t},\n\t\t\t\ty: function (d, i) {\n\t\t\t\t\tvar dims = helpers.getDimensions(pie.cssPrefix + \"tooltip\" + i);\n\t\t\t\t\treturn -(dims.h / 2) + 1;\n\t\t\t\t}\n\t\t\t});\n\t},\n\n  showTooltip: function(pie, index) {\n\n\t  var fadeInSpeed = pie.options.tooltips.styles.fadeInSpeed;\n\t  if (tt.currentTooltip === index) {\n\t\t  fadeInSpeed = 1;\n\t  }\n\n    tt.currentTooltip = index;\n    d3.select(\"#\" + pie.cssPrefix + \"tooltip\" + index)\n      .transition()\n      .duration(fadeInSpeed)\n      .style(\"opacity\", function() { return 1; });\n\n    tt.moveTooltip(pie);\n  },\n\n  moveTooltip: function(pie) {\n    d3.selectAll(\"#\" + pie.cssPrefix + \"tooltip\" + tt.currentTooltip)\n      .attr(\"transform\", function(d) {\n        var mouseCoords = d3.mouse(this.parentNode);\n        var x = mouseCoords[0] + pie.options.tooltips.styles.padding + 2;\n        var y = mouseCoords[1] - (2 * pie.options.tooltips.styles.padding) - 2;\n        return \"translate(\" + x + \",\" + y + \")\";\n      });\n  },\n\n  hideTooltip: function(pie, index) {\n    d3.select(\"#\" + pie.cssPrefix + \"tooltip\" + index)\n      .style(\"opacity\", function() { return 0; });\n\n    // move the tooltip offscreen. This ensures that when the user next mouseovers the segment the hidden\n    // element won't interfere\n    d3.select(\"#\" + pie.cssPrefix + \"tooltip\" + tt.currentTooltip)\n       .attr(\"transform\", function(d, i) {\n\n         // klutzy, but it accounts for tooltip padding which could push it onscreen\n         var x = pie.options.size.canvasWidth + 1000;\n         var y = pie.options.size.canvasHeight + 1000;\n         return \"translate(\" + x + \",\" + y + \")\";\n       });\n  },\n\n  replacePlaceholders: function(pie, str, index, replacements) {\n\n    // if the user has defined a placeholderParser function, call it before doing the replacements\n    if (helpers.isFunction(pie.options.tooltips.placeholderParser)) {\n      pie.options.tooltips.placeholderParser(index, replacements);\n    }\n\n    var replacer = function()  {\n      return function(match) {\n        var placeholder = arguments[1];\n        if (replacements.hasOwnProperty(placeholder)) {\n          return replacements[arguments[1]];\n        } else {\n          return arguments[0];\n        }\n      };\n    };\n    return str.replace(/\\{(\\w+)\\}/g, replacer(replacements));\n  }\n};\n\n\n\t// --------------------------------------------------------------------------------------------\n\n\t// our constructor\n\tvar d3pie = function(element, options) {\n\n\t\t// element can be an ID or DOM element\n\t\tthis.element = element;\n\t\tif (typeof element === \"string\") {\n\t\t\tvar el = element.replace(/^#/, \"\"); // replace any jQuery-like ID hash char\n\t\t\tthis.element = document.getElementById(el);\n\t\t}\n\n\t\tvar opts = {};\n\t\textend(true, opts, defaultSettings, options);\n\t\tthis.options = opts;\n\n\t\t// if the user specified a custom CSS element prefix (ID, class), use it\n\t\tif (this.options.misc.cssPrefix !== null) {\n\t\t\tthis.cssPrefix = this.options.misc.cssPrefix;\n\t\t} else {\n\t\t\tthis.cssPrefix = \"p\" + _uniqueIDCounter + \"_\";\n\t\t\t_uniqueIDCounter++;\n\t\t}\n\n\n\t\t// now run some validation on the user-defined info\n\t\tif (!validate.initialCheck(this)) {\n\t\t\treturn;\n\t\t}\n\n\t\t// add a data-role to the DOM node to let anyone know that it contains a d3pie instance, and the d3pie version\n\t\td3.select(this.element).attr(_scriptName, _version);\n\n\t\t// things that are done once\n\t\tthis.options.data.content = math.sortPieData(this);\n\t\tif (this.options.data.smallSegmentGrouping.enabled) {\n\t\t\tthis.options.data.content = helpers.applySmallSegmentGrouping(this.options.data.content, this.options.data.smallSegmentGrouping);\n\t\t}\n\t\tthis.options.colors = helpers.initSegmentColors(this);\n\t\tthis.totalSize      = math.getTotalPieSize(this.options.data.content);\n\n\t\t_init.call(this);\n\t};\n\n\td3pie.prototype.recreate = function() {\n\t\t// now run some validation on the user-defined info\n\t\tif (!validate.initialCheck(this)) {\n\t\t\treturn;\n\t\t}\n\t\tthis.options.data.content = math.sortPieData(this);\n\t\tif (this.options.data.smallSegmentGrouping.enabled) {\n\t\t\tthis.options.data.content = helpers.applySmallSegmentGrouping(this.options.data.content, this.options.data.smallSegmentGrouping);\n\t\t}\n\t\tthis.options.colors = helpers.initSegmentColors(this);\n\t\tthis.totalSize      = math.getTotalPieSize(this.options.data.content);\n\n\t\t_init.call(this);\n\t};\n\n\td3pie.prototype.redraw = function() {\n\t\tthis.element.innerHTML = \"\";\n\t\t_init.call(this);\n\t};\n\n\td3pie.prototype.destroy = function() {\n\t\tthis.element.innerHTML = \"\"; // clear out the SVG\n\t\td3.select(this.element).attr(_scriptName, null); // remove the data attr\n\t};\n\n\t/**\n\t * Returns all pertinent info about the current open info. Returns null if nothing's open, or if one is, an object of\n\t * the following form:\n\t * \t{\n\t * \t  element: DOM NODE,\n\t * \t  index: N,\n\t * \t  data: {}\n\t * \t}\n\t */\n\td3pie.prototype.getOpenSegment = function() {\n\t\tvar segment = this.currentlyOpenSegment;\n\t\tif (segment !== null && typeof segment !== \"undefined\") {\n\t\t\tvar index = parseInt(d3.select(segment).attr(\"data-index\"), 10);\n\t\t\treturn {\n\t\t\t\telement: segment,\n\t\t\t\tindex: index,\n\t\t\t\tdata: this.options.data.content[index]\n\t\t\t};\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t};\n\n\td3pie.prototype.openSegment = function(index) {\n\t\tindex = parseInt(index, 10);\n\t\tif (index < 0 || index > this.options.data.content.length-1) {\n\t\t\treturn;\n\t\t}\n\t\tsegments.openSegment(this, d3.select(\"#\" + this.cssPrefix + \"segment\" + index).node());\n\t};\n\n\td3pie.prototype.closeSegment = function() {\n\t\tvar segment = this.currentlyOpenSegment;\n\t\tif (segment) {\n\t\t\tsegments.closeSegment(this, segment);\n\t\t}\n\t};\n\n\t// this let's the user dynamically update aspects of the pie chart without causing a complete redraw. It\n\t// intelligently re-renders only the part of the pie that the user specifies. Some things cause a repaint, others\n\t// just redraw the single element\n\td3pie.prototype.updateProp = function(propKey, value) {\n\t\tswitch (propKey) {\n\t\t\tcase \"header.title.text\":\n\t\t\t\tvar oldVal = helpers.processObj(this.options, propKey);\n\t\t\t\thelpers.processObj(this.options, propKey, value);\n\t\t\t\td3.select(\"#\" + this.cssPrefix + \"title\").html(value);\n\t\t\t\tif ((oldVal === \"\" && value !== \"\") || (oldVal !== \"\" && value === \"\")) {\n\t\t\t\t\tthis.redraw();\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase \"header.subtitle.text\":\n\t\t\t\tvar oldValue = helpers.processObj(this.options, propKey);\n\t\t\t\thelpers.processObj(this.options, propKey, value);\n\t\t\t\td3.select(\"#\" + this.cssPrefix + \"subtitle\").html(value);\n\t\t\t\tif ((oldValue === \"\" && value !== \"\") || (oldValue !== \"\" && value === \"\")) {\n\t\t\t\t\tthis.redraw();\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase \"callbacks.onload\":\n\t\t\tcase \"callbacks.onMouseoverSegment\":\n\t\t\tcase \"callbacks.onMouseoutSegment\":\n\t\t\tcase \"callbacks.onClickSegment\":\n\t\t\tcase \"effects.pullOutSegmentOnClick.effect\":\n\t\t\tcase \"effects.pullOutSegmentOnClick.speed\":\n\t\t\tcase \"effects.pullOutSegmentOnClick.size\":\n\t\t\tcase \"effects.highlightSegmentOnMouseover\":\n\t\t\tcase \"effects.highlightLuminosity\":\n\t\t\t\thelpers.processObj(this.options, propKey, value);\n\t\t\t\tbreak;\n\n\t\t\t// everything else, attempt to update it & do a repaint\n\t\t\tdefault:\n\t\t\t\thelpers.processObj(this.options, propKey, value);\n\n\t\t\t\tthis.destroy();\n\t\t\t\tthis.recreate();\n\t\t\t\tbreak;\n\t\t}\n\t};\n\n\n\t// ------------------------------------------------------------------------------------------------\n\n\n\tvar _init = function() {\n\n\t\t// prep-work\n\t\tthis.svg = helpers.addSVGSpace(this);\n\n\t\t// store info about the main text components as part of the d3pie object instance\n\t\tthis.textComponents = {\n\t\t\theaderHeight: 0,\n\t\t\ttitle: {\n\t\t\t\texists: this.options.header.title.text !== \"\",\n\t\t\t\th: 0,\n\t\t\t\tw: 0\n\t\t\t},\n\t\t\tsubtitle: {\n\t\t\t\texists: this.options.header.subtitle.text !== \"\",\n\t\t\t\th: 0,\n\t\t\t\tw: 0\n\t\t\t},\n\t\t\tfooter: {\n\t\t\t\texists: this.options.footer.text !== \"\",\n\t\t\t\th: 0,\n\t\t\t\tw: 0\n\t\t\t}\n\t\t};\n\n\t\tthis.outerLabelGroupData = [];\n\n\t\t// add the key text components offscreen (title, subtitle, footer). We need to know their widths/heights for later computation\n\t\tif (this.textComponents.title.exists) {\n\t\t\ttext.addTitle(this);\n\t\t}\n\t\tif (this.textComponents.subtitle.exists) {\n\t\t\ttext.addSubtitle(this);\n\t\t}\n\t\ttext.addFooter(this);\n\n\t\t// the footer never moves. Put it in place now\n\t\tvar self = this;\n\t\thelpers.whenIdExists(this.cssPrefix + \"footer\", function() {\n\t\t\ttext.positionFooter(self);\n\t\t\tvar d3 = helpers.getDimensions(self.cssPrefix + \"footer\");\n\t\t\tself.textComponents.footer.h = d3.h;\n\t\t\tself.textComponents.footer.w = d3.w;\n\t\t});\n\n\t\t// now create the pie chart and position everything accordingly\n\t\tvar reqEls = [];\n\t\tif (this.textComponents.title.exists)    { reqEls.push(this.cssPrefix + \"title\"); }\n\t\tif (this.textComponents.subtitle.exists) { reqEls.push(this.cssPrefix + \"subtitle\"); }\n\t\tif (this.textComponents.footer.exists)   { reqEls.push(this.cssPrefix + \"footer\"); }\n\n\t\thelpers.whenElementsExist(reqEls, function() {\n\t\t\tif (self.textComponents.title.exists) {\n\t\t\t\tvar d1 = helpers.getDimensions(self.cssPrefix + \"title\");\n\t\t\t\tself.textComponents.title.h = d1.h;\n\t\t\t\tself.textComponents.title.w = d1.w;\n\t\t\t}\n\t\t\tif (self.textComponents.subtitle.exists) {\n\t\t\t\tvar d2 = helpers.getDimensions(self.cssPrefix + \"subtitle\");\n\t\t\t\tself.textComponents.subtitle.h = d2.h;\n\t\t\t\tself.textComponents.subtitle.w = d2.w;\n\t\t\t}\n\t\t\t// now compute the full header height\n\t\t\tif (self.textComponents.title.exists || self.textComponents.subtitle.exists) {\n\t\t\t\tvar headerHeight = 0;\n\t\t\t\tif (self.textComponents.title.exists) {\n\t\t\t\t\theaderHeight += self.textComponents.title.h;\n\t\t\t\t\tif (self.textComponents.subtitle.exists) {\n\t\t\t\t\t\theaderHeight += self.options.header.titleSubtitlePadding;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (self.textComponents.subtitle.exists) {\n\t\t\t\t\theaderHeight += self.textComponents.subtitle.h;\n\t\t\t\t}\n\t\t\t\tself.textComponents.headerHeight = headerHeight;\n\t\t\t}\n\n\t\t\t// at this point, all main text component dimensions have been calculated\n\t\t\tmath.computePieRadius(self);\n\n\t\t\t// this value is used all over the place for placing things and calculating locations. We figure it out ONCE\n\t\t\t// and store it as part of the object\n\t\t\tmath.calculatePieCenter(self);\n\n\t\t\t// position the title and subtitle\n\t\t\ttext.positionTitle(self);\n\t\t\ttext.positionSubtitle(self);\n\n\t\t\t// now create the pie chart segments, and gradients if the user desired\n\t\t\tif (self.options.misc.gradient.enabled) {\n\t\t\t\tsegments.addGradients(self);\n\t\t\t}\n\t\t\tsegments.create(self); // also creates this.arc\n\t\t\tlabels.add(self, \"inner\", self.options.labels.inner.format);\n\t\t\tlabels.add(self, \"outer\", self.options.labels.outer.format);\n\n\t\t\t// position the label elements relatively within their individual group (label, percentage, value)\n\t\t\tlabels.positionLabelElements(self, \"inner\", self.options.labels.inner.format);\n\t\t\tlabels.positionLabelElements(self, \"outer\", self.options.labels.outer.format);\n\t\t\tlabels.computeOuterLabelCoords(self);\n\n\t\t\t// this is (and should be) dumb. It just places the outer groups at their calculated, collision-free positions\n\t\t\tlabels.positionLabelGroups(self, \"outer\");\n\n\t\t\t// we use the label line positions for many other calculations, so ALWAYS compute them\n\t\t\tlabels.computeLabelLinePositions(self);\n\n\t\t\t// only add them if they're actually enabled\n\t\t\tif (self.options.labels.lines.enabled && self.options.labels.outer.format !== \"none\") {\n\t\t\t\tlabels.addLabelLines(self);\n\t\t\t}\n\n\t\t\tlabels.positionLabelGroups(self, \"inner\");\n\t\t\tlabels.fadeInLabelsAndLines(self);\n\n      // add and position the tooltips\n      if (self.options.tooltips.enabled) {\n        tt.addTooltips(self);\n      }\n\n      segments.addSegmentEventHandlers(self);\n\t\t});\n\t};\n\n  return d3pie;\n}));\n"],"sourceRoot":""}