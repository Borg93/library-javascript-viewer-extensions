(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{466:function(e,t,n){"use strict";var r=n(561);t.a=r.a},561:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return h});var r=n(93),a=n.n(r),i=n(30),o=n.n(i),u=n(43),s=n.n(u),c=n(120),l=n.n(c),f=n(2),p=n.n(f),v=n(3),d=n.n(v),h=function(){function t(){p()(this,t)}var n,r;return d()(t,null,[{key:"guid",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"xxxxxxxxxxxx",t=(new Date).getTime(),n=e.replace(/[xy]/g,function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:7&n|8).toString(16)});return n}},{key:"loadDocument",value:function(t){return new e(function(e,n){var r=t.startsWith("urn:")?t:"urn:"+t;Autodesk.Viewing.Document.load(r,function(t){e(t)},function(e){n(e)})})}},{key:"getViewableItems",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["3d","2d"],n=e.getRootItem(),r=[],a=t?Array.isArray(t)?t:[t]:[];return a.forEach(function(e){r=[].concat(l()(r),l()(Autodesk.Viewing.Document.getSubItemsWithProperties(n,{type:"geometry",role:e},!0)))}),r}},{key:"createButton",value:function(e,t,n,r){var a=new Autodesk.Viewing.UI.Button(e);return a.icon.style.fontSize="24px",a.icon.className=t,a.setToolTip(n),a.onClick=r,a}},{key:"createControlGroup",value:function(e,t){var n=e.getToolbar(!0);if(n){var r=new Autodesk.Viewing.UI.ControlGroup(t);return n.addControl(r),r}}},{key:"getLeafNodes",value:function(t,n){return new e(function(e,r){try{var a=t.getData().instanceTree||t.getFragmentMap();n=n||a.getRootId();var i=Array.isArray(n)?n:[n],o=[];return i.forEach(function(e){!function e(t){var n=0;a.enumNodeChildren(t,function(t){e(t),++n}),0===n&&o.push(t)}(e)}),e(o)}catch(e){return r(e)}})}},{key:"getFragIds",value:function(n,r){return new e(function(){var e=s()(o.a.mark(function e(i,u){var s,c;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.delegateYield(o.a.mark(function e(){var a,u,c,f,p;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.getData().instanceTree,r=r||a.getRootId(),u=Array.isArray(r)?r:[r],!a){e.next=9;break}return e.next=6,t.getLeafNodes(n,u);case 6:e.t0=e.sent,e.next=10;break;case 9:e.t0=u;case 10:for(c=e.t0,f=[],s=0;s<c.length;++s)a?a.enumNodeFragments(c[s],function(e){f.push(e)}):(p=t.getLeafFragIds(n,c[s]),f=[].concat(l()(f),l()(p)));return e.abrupt("return",{v:i(f)});case 14:case"end":return e.stop()}},e)})(),"t0",2);case 2:if(c=e.t0,"object"!==a()(c)){e.next=5;break}return e.abrupt("return",c.v);case 5:e.next=10;break;case 7:return e.prev=7,e.t1=e.catch(0),e.abrupt("return",u(e.t1));case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,n){return e.apply(this,arguments)}}())}},{key:"getLeafFragIds",value:function(e,t){if(e.getData().instanceTree){var n=e.getData().instanceTree,r=[];return n.enumNodeFragments(t,function(e){r.push(e)}),r}var a=e.getData().fragments.dbId2fragId[t];return Array.isArray(a)?a:[a]}},{key:"getWorldBoundingBox",value:function(n,r){return new e(function(){var e=s()(o.a.mark(function e(a,i){var u,s,c,l;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.getFragIds(n,r);case 3:if((u=e.sent).length){e.next=6;break}return e.abrupt("return",i("No geometry, invalid dbId?"));case 6:return s=n.getFragmentList(),c=new THREE.Box3,l=new THREE.Box3,u.forEach(function(e){s.getWorldBounds(e,c),l.union(c)}),e.abrupt("return",a(l));case 13:return e.prev=13,e.t0=e.catch(0),e.abrupt("return",i(e.t0));case 16:case"end":return e.stop()}},e,null,[[0,13]])}));return function(t,n){return e.apply(this,arguments)}}())}},{key:"getProperties",value:function(n,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new e(function(i,o){try{var u=parseInt(r);if(isNaN(u))return o(r+" is not a valid integer");if(a){var s=a.map(function(e){return t.getProperty(n,u,e,"Not Available")});e.all(s).then(function(e){i(e)})}else n.getProperties(u,function(e){return e.properties?i(e.properties):o("No Properties")})}catch(e){return o(e)}})}},{key:"getProperty",value:function(t,n,r,a){return new e(function(e,i){try{t.getProperties(n,function(t){if(t.properties){if(t.properties.forEach(function(t){t.dbId=n,"function"==typeof r?r(t.displayName)&&e(t):r===t.displayName&&e(t)}),a)return e({displayValue:a,displayName:r,dbId:n});i(new Error("Not Found"))}else i(new Error("Error getting properties"))})}catch(e){return i(e)}})}},{key:"getPropertyList",value:function(n,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new e(function(){var i=s()(o.a.mark(function i(u,s){var c,l,f;return o.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,a=a||n.activeModel||n.model,c=r.map(function(e){return t.getProperties(a,e)}),i.next=5,e.all(c);case 5:return l=i.sent,f=[],l.forEach(function(e){e.forEach(function(e){f.indexOf(e.displayName)<0&&f.push(e.displayName)})}),i.abrupt("return",u(f.sort()));case 11:return i.prev=11,i.t0=i.catch(0),i.abrupt("return",s(i.t0));case 14:case"end":return i.stop()}},i,null,[[0,11]])}));return function(e,t){return i.apply(this,arguments)}}())}},{key:"getBulkPropertiesAsync",value:function(t,n,r){var a=this;return new e(function(){var i=s()(o.a.mark(function i(u,s){var c,l,f,p;return o.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if("function"!=typeof r){i.next=9;break}return c=n.map(function(e){return a.getProperty(t,e,r,"Not Found")}),i.next=4,e.all(c);case 4:l=i.sent,f=l.filter(function(e){return"Not Found"!==e.displayValue}),u(f.map(function(e){return{properties:[e],dbId:e.dbId}})),i.next=11;break;case 9:p=Array.isArray(r)?r:[r],t.getBulkProperties(n,p,function(e){u(e)},function(e){console.log(e),s(e)});case 11:case"end":return i.stop()}},i)}));return function(e,t){return i.apply(this,arguments)}}())}},{key:"mapComponentsByProp",value:function(n,r,a,i){return new e(function(){var e=s()(o.a.mark(function e(i,u){var s,c,l;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.getBulkPropertiesAsync(n,a,r);case 3:return s=e.sent,c=s.map(function(e){var t=e.properties[0];return Object.assign({},t,{dbId:e.dbId})}),l={},c.forEach(function(e){var t=e.displayValue;"string"==typeof t&&(t=t.split(":")[0]),l[t]||(l[t]=[]),l[t].push(e.dbId)}),e.abrupt("return",i(l));case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",u(e.t0));case 13:case"end":return e.stop()}},e,null,[[0,10]])}));return function(t,n){return e.apply(this,arguments)}}())}},{key:"runTaskOnDataTree",value:function(t,n){var r=[];return function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t.children&&t.children.forEach(function(n){e(n,t)});var i=n(t,a);r.push(i)}(t),e.all(r)}},{key:"drawBox",value:function(e,t,n,r,a){var i=new THREE.Geometry;i.vertices.push(new THREE.Vector3(t.x,t.y,t.z)),i.vertices.push(new THREE.Vector3(n.x,t.y,t.z)),i.vertices.push(new THREE.Vector3(n.x,t.y,t.z)),i.vertices.push(new THREE.Vector3(n.x,t.y,n.z)),i.vertices.push(new THREE.Vector3(n.x,t.y,n.z)),i.vertices.push(new THREE.Vector3(t.x,t.y,n.z)),i.vertices.push(new THREE.Vector3(t.x,t.y,n.z)),i.vertices.push(new THREE.Vector3(t.x,t.y,t.z)),i.vertices.push(new THREE.Vector3(t.x,n.y,n.z)),i.vertices.push(new THREE.Vector3(n.x,n.y,n.z)),i.vertices.push(new THREE.Vector3(n.x,n.y,n.z)),i.vertices.push(new THREE.Vector3(n.x,n.y,t.z)),i.vertices.push(new THREE.Vector3(n.x,n.y,t.z)),i.vertices.push(new THREE.Vector3(t.x,n.y,t.z)),i.vertices.push(new THREE.Vector3(t.x,n.y,t.z)),i.vertices.push(new THREE.Vector3(t.x,n.y,n.z)),i.vertices.push(new THREE.Vector3(t.x,t.y,t.z)),i.vertices.push(new THREE.Vector3(t.x,n.y,t.z)),i.vertices.push(new THREE.Vector3(n.x,t.y,t.z)),i.vertices.push(new THREE.Vector3(n.x,n.y,t.z)),i.vertices.push(new THREE.Vector3(n.x,t.y,n.z)),i.vertices.push(new THREE.Vector3(n.x,n.y,n.z)),i.vertices.push(new THREE.Vector3(t.x,t.y,n.z)),i.vertices.push(new THREE.Vector3(t.x,n.y,n.z));var o=new THREE.Line(i,r,THREE.LinePieces);return e.impl.addOverlay(a,o),e.impl.invalidate(!0,!0,!0),o}},{key:"setMaterial",value:(r=s()(o.a.mark(function e(n,r,a){var i,u;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getFragIds(n,r);case 2:i=e.sent,u=n.getFragmentList(),i.forEach(function(e){u.setMaterial(e,a)});case 5:case"end":return e.stop()}},e)})),function(e,t,n){return r.apply(this,arguments)})},{key:"buildModelTree",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;function n(e){r.enumNodeChildren(e.dbId,function(a){var i=null;t?i=t(a):(e.children=e.children||[],i={dbId:a,name:r.getNodeName(a)},e.children.push(i)),n(i)})}var r=e.getData().instanceTree,a=r.getRootId(),i={dbId:a,name:r.getNodeName(a)};return n(i),i}},{key:"executeTaskOnModelTree",value:function(e,t){var n=[];var r=e.getData().instanceTree;return function a(i){r.enumNodeChildren(i,function(r){n.push(t(e,r)),a(r)})}(r.getRootId()),n}},{key:"hide",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{r=r||t.activeModel||t.model,t.hide(n);var a=Array.isArray(n)?n:[n],i=a.map(function(n){return new e(function(e){t.impl.visibilityManager.setNodeOff(n,!0),e()})});return e.all(i)}catch(t){return e.reject(t)}}},{key:"show",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{r=r||t.activeModel||t.model,t.show(n);var a=Array.isArray(n)?n:[n];return a.forEach(function(e){t.impl.visibilityManager.setNodeOff(e,!1)}),e.resolve()}catch(t){return e.reject(t)}}},{key:"isolateFull",value:(n=s()(o.a.mark(function n(r){var a,i,u,s,c,l,f=arguments;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a=f.length>1&&void 0!==f[1]?f[1]:[],i=f.length>2&&void 0!==f[2]?f[2]:null,n.prev=2,i=i||r.activeModel||r.model,r.impl.visibilityManager.isolate(a,i),u=Array.isArray(a)?a:[a],n.next=9,t.getLeafNodes(i,u);case 9:return s=n.sent,n.next=12,t.getLeafNodes(i);case 12:return c=n.sent,l=c.map(function(t){return new e(function(e){var n=!s.length||s.indexOf(t)>-1;r[n?"show":"hide"](t,i),e()})}),n.abrupt("return",e.all(l));case 17:return n.prev=17,n.t0=n.catch(2),n.abrupt("return",e.reject(n.t0));case 20:case"end":return n.stop()}},n,null,[[2,17]])})),function(e){return n.apply(this,arguments)})},{key:"rotateFragments",value:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=new THREE.Quaternion;o.setFromAxisAngle(n,r),i=i||e.activeModel||e.model,t.forEach(function(t){var n=e.impl.getFragmentProxy(i,t);n.getAnimTransform();var r=new THREE.Vector3(n.position.x-a.x,n.position.y-a.y,n.position.z-a.z);r.applyQuaternion(o),r.add(a),n.position=r,n.quaternion.multiplyQuaternions(o,n.quaternion),n.updateAnimTransform()})}},{key:"restoreStateWithPivot",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=function n(){e.removeEventListener(Autodesk.Viewing.VIEWER_STATE_RESTORED_EVENT,n);var a=t.viewport.pivotPoint;setTimeout(function(){e.navigation.setPivotPoint(new THREE.Vector3(a[0],a[1],a[2]))},r?0:1250)};e.addEventListener(Autodesk.Viewing.VIEWER_STATE_RESTORED_EVENT,a),e.restoreState(t,n,r)}},{key:"getComponentsByParentName",value:function(e,n){var r=n.getData().instanceTree,a=r.getRootId(),i=0;return r.enumNodeChildren(a,function(t){r.getNodeName(t).indexOf(e)>-1&&(i=t)}),i>0?t.getLeafNodes(n,i):[]}},{key:"buildComponentGeometry",value:function(e,n,r,a){var i=t.getLeafFragIds(n,r),o=null,u=new THREE.Geometry;return i.forEach(function(t){var r=e.impl.getRenderProxy(n,t);o=o||r.matrixWorld;for(var i=r.geometry,s=i.attributes,c=i.vb?i.vb:s.position.array,l=s.index.array||i.ib,f=i.vb?i.vbstride:3,p=[{count:l.length,index:0,start:0}],v=0,d=p.length;v<d;++v)for(var h=p[v].start,g=p[v].count,y=p[v].index,E=h,m=h+g;E<m;E+=3){var w=y+l[E],x=y+l[E+1],T=y+l[E+2],k=new THREE.Vector3,b=new THREE.Vector3,R=new THREE.Vector3;if(k.fromArray(c,w*f),b.fromArray(c,x*f),R.fromArray(c,T*f),!a||a(k,b,R)){var A=u.vertices.length;u.vertices.push(k),u.vertices.push(b),u.vertices.push(R);var V=new THREE.Face3(A,A+1,A+2);u.faces.push(V)}}}),u.applyMatrix(o),u}},{key:"buildComponentMesh",value:function(e,n,r,a,i){var o=t.buildComponentGeometry(e,n,r,a);o.computeFaceNormals(),o.computeVertexNormals();var u=new THREE.Mesh(o,i);return u.dbId=r,u}},{key:"selectiveExplode",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=(r=r||e.activeModel||e.model).getData(),i=r.getVisibleBounds(!0).center(),o=r.getFragmentList(),u=new THREE.Vector3;if(t*=2,a.instanceTree&&a.instanceTree.nodeAccess.nodeBoxes&&0!==t){var s=t*(a.instanceTree.maxDepth-1)+1,c=0|s,l=s-c,f=a.instanceTree,p=new Float32Array(6);!function e(r,i,s,v,d,h,g,y){var E=2*t;i==c&&(E*=l),f.getNodeBox(r,p);var m=.5*(p[0]+p[3]),w=.5*(p[1]+p[4]),x=.5*(p[2]+p[5]);i>0&&i<=c&&(h+=(m-s)*E,g+=(w-v)*E,y+=(x-d)*E);a.instanceTree.enumNodeChildren(r,function(t){e(t,i+1,m,w,x,h,g,y)},!1),a.instanceTree.enumNodeFragments(r,function(e){n.indexOf(e.toString())<0&&(u.x=h,u.y=g,u.z=y,o.updateAnimTransform(e,null,null,u))},!1)}(a.instanceTree.getRootId(),0,i.x,i.y,i.x,0,0,0)}else for(var v=o.fragments.boxes,d=o.getCount(),h=0;h<d;++h)if(n.indexOf(h.toString())<0)if(0==t)o.updateAnimTransform(h);else{var g=6*h,y=.5*(v[g]+v[g+3]),E=.5*(v[g+1]+v[g+4]),m=.5*(v[g+2]+v[g+5]);y=t*(y-i.x),E=t*(E-i.y),m=t*(m-i.z),u.x=y,u.y=E,u.z=m,o.updateAnimTransform(h,null,null,u)}}},{key:"mobile",get:function(){return{getUserAgent:function(){return navigator.userAgent},isAndroid:function(){return this.getUserAgent().match(/Android/i)},isBlackBerry:function(){return this.getUserAgent().match(/BlackBerry/i)},isIOS:function(){return this.getUserAgent().match(/iPhone|iPad|iPod/i)},isOpera:function(){return this.getUserAgent().match(/Opera Mini/i)},isWindows:function(){return this.isWindowsDesktop()||this.isWindowsMobile()},isWindowsMobile:function(){return this.getUserAgent().match(/IEMobile/i)},isWindowsDesktop:function(){return this.getUserAgent().match(/WPDesktop/i)},isAny:function(){return this.isAndroid()||this.isBlackBerry()||this.isIOS()||this.isWindowsMobile()}}}}]),t}()}).call(this,n(31))}}]);
//# sourceMappingURL=1.js.map