{"version":3,"sources":["webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.DataManagement/DMUploader/index.js","webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.DataManagement/DMUploader/DMUploader.js","webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.DataManagement/DMUploader/DMUploader.scss?9e1e","webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.DataManagement/DMUploader/DMUploader.scss"],"names":["__webpack_require__","r","__webpack_exports__","_DMUploader__WEBPACK_IMPORTED_MODULE_0__","DMUploader","props","_this","_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2___default","this","_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4___default","_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5___default","call","onDrop","bind","_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_6___default","dmAPI","api","state","rootFilename","format","arguments","length","undefined","d","Date","getTime","guid","replace","c","Math","random","floor","toString","e","keyCode","stopPropagation","preventDefault","assignState","target","value","file","_this2","Promise","resolve","filename","name","substring","endsWith","dialogSvc","on","onClose","result","off","setState","className","title","onRequestClose","captionCancel","captionOK","content","react__WEBPACK_IMPORTED_MODULE_14___default","a","createElement","react_contenteditable__WEBPACK_IMPORTED_MODULE_8___default","data-placeholder","concat","onChange","onRootFilenameChanged","onKeyDown","html","open","files","isComposite","composite","uploadId","onInitUpload","socketSvc","getSocketId","socketId","hubId","projectId","folderId","nodeId","data","Object","assign","options","progress","percent","_this3","onProgress","upload","react_dropzone__WEBPACK_IMPORTED_MODULE_11__","multiple","BaseComponent","module","i","locals","exports","push"],"mappings":"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","file":"98.js","sourcesContent":["import DMUploader from './DMUploader'\n\nexport default DMUploader\n","import ContentEditable from 'react-contenteditable'\nimport BaseComponent from 'BaseComponent'\nimport {ServiceContext} from 'ServiceContext'\nimport Dropzone from 'react-dropzone'\nimport PropTypes from 'prop-types'\nimport './DMUploader.scss'\nimport React from 'react'\n\nexport default class DMUploader extends BaseComponent {\n\n  /////////////////////////////////////////////////////////\n  //\n  //\n  /////////////////////////////////////////////////////////\n  constructor (props) {\n\n    super (props)\n\n\n\n    this.onDrop = this.onDrop.bind(this)\n\n    this.dmAPI = this.props.api\n\n    this.state = {\n      rootFilename: null\n    }\n  }\n\n  /////////////////////////////////////////////////////////\n  //\n  //\n  /////////////////////////////////////////////////////////\n  guid (format = 'xxxxxxxxxx') {\n\n    var d = new Date().getTime()\n\n    var guid = format.replace(\n      /[xy]/g,\n      function (c) {\n        var r = (d + Math.random() * 16) % 16 | 0\n        d = Math.floor(d / 16)\n        return (c == 'x' ? r : (r & 0x7 | 0x8)).toString(16)\n      })\n\n    return guid\n  }\n\n  /////////////////////////////////////////////////////////\n  //\n  //\n  /////////////////////////////////////////////////////////\n  onKeyDown (e) {\n\n    if (e.keyCode === 13) {\n\n      e.stopPropagation()\n      e.preventDefault()\n    }\n  }\n\n  /////////////////////////////////////////////////////////\n  //\n  //\n  /////////////////////////////////////////////////////////\n  onRootFilenameChanged (e) {\n\n    this.assignState({\n      rootFilename: e.target.value\n    })\n  }\n\n  /////////////////////////////////////////////////////////\n  //\n  //\n  /////////////////////////////////////////////////////////\n  isComposite (file) {\n\n    return new Promise ((resolve) => {\n\n      const filename = file.name\n\n      const rootFilename =\n        filename.substring(\n          0, filename.length - 4)\n\n      if (filename.endsWith('.zip')) {\n\n        const onClose = (result) => {\n\n          this.dialogSvc.off('dialog.close', onClose)\n\n          return (result === 'OK')\n            ? resolve(this.state.rootFilename || rootFilename)\n            : resolve(false)\n        }\n\n        this.dialogSvc.on('dialog.close', onClose)\n\n        this.assignState({\n          rootFilename: null\n        })\n\n        this.dialogSvc.setState({\n          className: 'composite-dlg',\n          title: 'Composite Model',\n          onRequestClose: () => {},\n          captionCancel: 'NO',\n          captionOK: 'Yes',\n          content:\n            <div>\n              <p>\n                Are you uploading a composite model?\n              </p>\n              <ContentEditable\n                data-placeholder={`Specify root filename: ${rootFilename}`}\n                onChange={(e) => this.onRootFilenameChanged(e)}\n                onKeyDown={(e) => this.onKeyDown(e)}\n                html={this.state.rootFilename}\n                className=\"root-filename\"\n              />\n            </div>,\n          open: true\n        })\n\n      } else {\n\n        resolve(false)\n      }\n    })\n  }\n\n  /////////////////////////////////////////////////////////\n  //\n  //\n  /////////////////////////////////////////////////////////\n  async onDrop (files) {\n\n    const composite = await this.isComposite(files[0])\n\n    const uploadId = this.guid()\n\n    const file = files[0]\n\n    if (this.props.onInitUpload) {\n\n      this.props.onInitUpload({\n        uploadId,\n        file\n      })\n    }\n\n    const socketId = await this.socketSvc.getSocketId()\n\n    const {hubId, projectId, folderId, nodeId} = this.props\n\n    const data = Object.assign({\n      socketId,\n      uploadId,\n      nodeId,\n      hubId\n      }, !!composite\n      ? {\n          rootFilename: composite\n        }\n      : null)\n\n    const options = {\n      progress: (percent) => {\n\n        if (this.props.onProgress) {\n\n          this.props.onProgress({\n            uploadId,\n            percent,\n            file\n          })\n        }\n      },\n      data\n    }\n\n    this.dmAPI.upload(\n      projectId, folderId,\n      file, options)\n  }\n\n  /////////////////////////////////////////////////////////\n  //\n  //\n  /////////////////////////////////////////////////////////\n  render () {\n\n    return(\n      <div className=\"dm-uploader\">\n        <Dropzone className=\"content\"\n          onDrop={this.onDrop}\n          multiple={false} >\n          <p>\n            <span className=\"fa fa-cloud-upload\"/>\n            Drop a file here or click to browse ...\n          </p>\n        </Dropzone>\n      </div>\n    )\n  }\n}\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../../node_modules/postcss-loader/src/index.js??ref--6-2!../../../../../../../../node_modules/sass-loader/lib/loader.js!./DMUploader.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// add the styles to the DOM\nvar update = require(\"!../../../../../../../../node_modules/style-loader/addStyles.js\")(content, {});\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../../node_modules/postcss-loader/src/index.js??ref--6-2!../../../../../../../../node_modules/sass-loader/lib/loader.js!./DMUploader.scss\", function() {\n\t\t\tvar newContent = require(\"!!../../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../../node_modules/postcss-loader/src/index.js??ref--6-2!../../../../../../../../node_modules/sass-loader/lib/loader.js!./DMUploader.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \".dm-uploader {\\n  overflow: hidden;\\n  height: 100%; }\\n  .dm-uploader .title > span {\\n    position: relative;\\n    margin-right: 6px;\\n    font-size: 24px;\\n    color: #8e8e8e;\\n    top: 2px; }\\n  .dm-uploader .content {\\n    transition-property: all;\\n    transition-timing-function: ease;\\n    transition-duration: 0.5s;\\n    transition-delay: 0.0s;\\n    border: 2px solid #d2d2d2;\\n    padding: 8px 10px 0 0;\\n    background: white;\\n    cursor: pointer;\\n    height: 90px; }\\n    .dm-uploader .content p {\\n      padding: 10px; }\\n      .dm-uploader .content p span {\\n        left: calc(50% - 40px);\\n        position: absolute;\\n        font-size: 81px;\\n        color: #9b9b9b;\\n        opacity: 0.2;\\n        z-index: 0;\\n        top: 8px; }\\n  .dm-uploader .content:hover {\\n    border-color: #1bb1f4; }\\n\\n.composite-dlg .root-filename {\\n  border: 1px solid #d2d2d2;\\n  background: #fdfdfd;\\n  border-radius: 3px;\\n  padding-left: 6px;\\n  text-align: left; }\\n\", \"\"]);\n"],"sourceRoot":""}