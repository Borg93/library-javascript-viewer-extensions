{"version":3,"sources":["webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.Particle/ParticleSystem/Vector.js","webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.Particle/ParticleSystem/BaseObject.js","webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.Particle/ParticleSystem/ParticleEmitter.js","webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.Particle/ParticleSystem/MagneticField.js","webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.Particle/ParticleSystem/Field.js","webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.Particle/ParticleSystem/EventsEmitter.js","webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.Particle/ParticleSystem/Particle.js","webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.Particle/ParticleSystem/ParticleSystem.js","webpack:///./src/client/components/Viewer/Extensions/Dynamic/Viewing.Extension.Particle/ParticleSystem/index.js"],"names":["Vector","x","arguments","length","undefined","y","z","classCallCheck_default","this","_x","_y","_z","Math","sqrt","m","magnitude","scaleFactor","vector","center","radius","size","data","BaseObject","id","type","_offset","_position","_selectable","_transformable","_type","_id","transformable","selectable","ParticleEmitter","_this","possibleConstructorReturn_default","getPrototypeOf_default","call","_spread","PI","_emissionRate","_velocity","_charge","dt","floor","particle","angle1","random","angle2","cos","sin","emissionRate","velocity","spread","charge","MagneticField","_force","particlePos","fieldPos","dX","dY","dZ","force","pow","abs","particleAcc","_acceleration","Field","EventsEmitter","_events","event","fct","push","splice","indexOf","tmpArray","slice","i","result","apply","Array","prototype","format","d","Date","getTime","guid","replace","c","r","toString","Particle","dof","_recycled","_radius","_dof","_lifeTime","ptr","fields","forEach","field","applyForce","lifeTime","ParticleSystem","maxParticles","_maxParticles","_emittedParticles","_particleIdx","_recycleBin","_particles","_emitters","_fields","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","emitter","value","getId","err","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","addNewParticles","filterParticles","_this2","emitNumber","popRecycle","emitParticle","pop","reset","pushRecycle","_this3","filterParticle","submitToFields","step","__webpack_exports__","Instance"],"mappings":"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","file":"112.js","sourcesContent":["\nexport default class Vector {\n  constructor (x = 0, y = 0, z = 0) {\n    this._x = x\n    this._y = y\n    this._z = z\n  }\n\n  getX () { return this._x }\n  getY () { return this._y }\n  getZ () { return this._z }\n\n  magnitude () {\n    return Math.sqrt(\n      this._x * this._x +\n      this._y * this._y +\n      this._z * this._z)\n  }\n\n  asUnitVector () {\n    var m = this.magnitude()\n\n    return new Vector(\n      this._x / m,\n      this._y / m,\n      this._z / m)\n  }\n\n  scaled (scaleFactor) {\n    var m = this.magnitude()\n\n    return new Vector(\n      this._x * scaleFactor / m,\n      this._y * scaleFactor / m,\n      this._z * scaleFactor / m)\n  }\n\n  multiply (scaleFactor) {\n    this._x *= scaleFactor\n    this._y *= scaleFactor\n    this._z *= scaleFactor\n\n    return this\n  }\n\n  add (vector) {\n    this._x += vector._x\n    this._y += vector._y\n    this._z += vector._z\n\n    return this\n  }\n\n  vectorTo (vector) {\n    return new Vector(\n      vector._x - this._x,\n      vector._y - this._y,\n      vector._z - this._z\n    )\n  }\n\n  withinSphere (center, radius) {\n    var magnitudeSqr =\n      (this._x - center._x) * (this._x - center._x) +\n      (this._y - center._y) * (this._y - center._y) +\n      (this._z - center._z) * (this._z - center._z)\n\n    return magnitudeSqr < radius * radius\n  }\n\n  withinBox (center, size) {\n    // TODO\n\n    return true\n  }\n\n  copy () {\n    return new Vector(this._x, this._y, this._z)\n  }\n\n  static fromArray (data) {\n    return new Vector(data[0], data[1], data[2])\n  }\n}\n","import Vector from './Vector'\n\nexport default class BaseObject {\n  constructor (id, type) {\n    this._offset = new Vector()\n    this._position = new Vector()\n    this._selectable = true\n    this._transformable = true\n    this._type = type\n    this._id = id\n  }\n\n  setPosition (x, y, z) {\n    this._position = new Vector(\n      x + this._offset._x,\n      y + this._offset._y,\n      z + this._offset._z)\n  }\n\n  getPosition () {\n    return this._position\n  }\n\n  setOffset (x, y, z) {\n    this._offset = new Vector(x, y, z)\n  }\n\n  getOffset () {\n    return this._offset\n  }\n\n  setTransformable (transformable) {\n    this._transformable = transformable\n  }\n\n  getTransformable () {\n    return this._transformable\n  }\n\n  setSelectable (selectable) {\n    this._selectable = selectable\n  }\n\n  getSelectable () {\n    return this._selectable\n  }\n\n  getType () {\n    return this._type\n  }\n\n  getId () {\n    return this._id\n  }\n}\n","import BaseObject from './BaseObject'\nimport Vector from './Vector'\n\nexport default class ParticleEmitter extends BaseObject {\n  constructor (id) {\n    super(id, 0)\n\n    this._spread = 2 * Math.PI / 180\n    this._emissionRate = 500\n    this._velocity = 10\n    this._charge = 1\n  }\n\n  emitNumber (dt) {\n    return Math.floor(this._emissionRate * dt)\n  }\n\n  emitParticle (particle) {\n    var angle1 = this._spread * (2 * Math.random() - 1)\n    var angle2 = this._spread * (2 * Math.random() - 1)\n\n    particle._velocity._x = this._velocity *\n      Math.cos(angle1) * Math.cos(angle2)\n\n    particle._velocity._y = this._velocity *\n      Math.sin(angle1) * Math.cos(angle2)\n\n    particle._velocity._z = this._velocity *\n      Math.sin(angle2)\n\n    particle._position._x = this._position._x\n    particle._position._y = this._position._y\n    particle._position._z = this._position._z\n\n    particle._charge = this._charge\n  }\n\n  setEmissionRate (emissionRate) {\n    this._emissionRate = emissionRate\n  }\n\n  getEmissionRate () {\n    return this._emissionRate\n  }\n\n  setVelocity (velocity) {\n    this._velocity = velocity\n  }\n\n  getVelocity () {\n    return this._velocity\n  }\n\n  setSpread (spread) {\n    this._spread = spread\n  }\n\n  getSpread () {\n    return this._spread\n  }\n\n  setCharge (charge) {\n    this._charge = charge\n  }\n\n  getCharge () {\n    return this._charge\n  }\n}\n","\nimport Field from './Field'\n\nexport default class MagneticField extends Field {\n  constructor (id) {\n    super(id, 1)\n\n    this._force = 0\n  }\n\n  applyForce (particle) {\n    const particlePos = particle._position\n\n    const fieldPos = this._position\n\n    const dX = fieldPos._x - particlePos._x\n    const dY = fieldPos._y - particlePos._y\n    const dZ = fieldPos._z - particlePos._z\n\n    const force = particle._charge * this._force / Math.pow((\n      dX * dX +\n      dY * dY +\n      dZ * dZ), 1.5)\n\n    if (Math.abs(force) > 0.001) {\n      const particleAcc = particle._acceleration\n\n      particleAcc._x += dX * force\n      particleAcc._y += dY * force\n      particleAcc._z += dZ * force\n    }\n  }\n\n  setForce (force) {\n    this._force = force\n  }\n\n  getForce () {\n    return this._force\n  }\n}\n","import BaseObject from './BaseObject'\nimport Vector from './Vector'\n\nexport default class Field extends BaseObject {\n  constructor (id, type) {\n    super(id, type)\n  }\n\n  computeAcceleration (particle) {\n    return new Vector()\n  }\n}\n","\nexport default class EventsEmitter {\n  /// ////////////////////////////////////////////////////////////////\n  //\n  //\n  /// ////////////////////////////////////////////////////////////////\n  constructor () {\n    this._events = {}\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  //\n  //\n  /// ////////////////////////////////////////////////////////////////\n  on (event, fct) {\n    this._events[event] = this._events[event]\t|| []\n    this._events[event].push(fct)\n\n    return this\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  //\n  //\n  /// ////////////////////////////////////////////////////////////////\n  off (event, fct) {\n    if (event == undefined) {\n      this._events = {}\n      return\n    }\n\n    if (event in this._events === false) { return }\n\n    if (fct) {\n      this._events[event].splice(\n        this._events[event].indexOf(fct), 1)\n    } else {\n      this._events[event] = []\n    }\n\n    return this\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  //\n  //\n  /// ////////////////////////////////////////////////////////////////\n  emit (event /* , args... */) {\n    if (this._events[event] === undefined) { return }\n\n    var tmpArray = this._events[event].slice()\n\n    for (var i = 0; i < tmpArray.length; ++i) {\n      var result\t= tmpArray[i].apply(this,\n        Array.prototype.slice.call(arguments, 1))\n\n      if (result !== undefined) { return result }\n    }\n\n    return undefined\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  //\n  //\n  /// ////////////////////////////////////////////////////////////////\n  guid (format = 'xxxxxxxxxxxx') {\n    var d = new Date().getTime()\n\n    var guid = format.replace(\n      /[xy]/g,\n      function (c) {\n        var r = (d + Math.random() * 16) % 16 | 0\n        d = Math.floor(d / 16)\n        return (c == 'x' ? r : (r & 0x7 | 0x8)).toString(16)\n      })\n\n    return guid\n  }\n}\n","import Vector from './Vector'\n\nexport default class Particle {\n  constructor (dof) {\n    this._velocity = new Vector()\n    this._position = new Vector()\n    this._acceleration = new Vector()\n    this._recycled = false\n    this._radius = 0.03\n    this._dof = dof\n    this._lifeTime = 30\n    this._charge = 1\n    this.ptr = 1 // compat with wasm\n  }\n\n  reset () {\n    this._recycled = false\n    this._lifeTime = 30\n  }\n\n  submitToFields (fields) {\n    this._acceleration._x = 0\n    this._acceleration._y = 0\n    this._acceleration._z = 0\n\n    fields.forEach((field) => {\n      field.applyForce(this)\n    })\n  }\n\n  step (dt) {\n    this._lifeTime -= dt\n\n    this._velocity._x += this._acceleration._x * dt\n    this._velocity._y += this._acceleration._y * dt\n    this._velocity._z += this._acceleration._z * dt\n\n    this._position._x += this._velocity._x * this._dof._x * dt\n    this._position._y += this._velocity._y * this._dof._y * dt\n    this._position._z += this._velocity._z * this._dof._z * dt\n  }\n\n  getRecycled () {\n    return this._recycled\n  }\n\n  getLifeTime () {\n    return this._lifeTime\n  }\n\n  setLifeTime (lifeTime) {\n    this._lifeTime = lifeTime\n  }\n\n  getAcceleration () {\n    return this._acceleration\n  }\n\n  getPosition () {\n    return this._position\n  }\n\n  getCharge () {\n    return this._charge\n  }\n\n  getRadius () {\n    return this._radius\n  }\n}\n","import ParticleEmitter from './ParticleEmitter'\nimport MagneticField from './MagneticField'\nimport EventsEmitter from './EventsEmitter'\nimport Particle from './Particle'\nimport Vector from './Vector'\n\nexport default class ParticleSystem extends EventsEmitter {\n  /// ////////////////////////////////////////////////////////////////\n  //\n  //\n  /// ////////////////////////////////////////////////////////////////\n  constructor (maxParticles) {\n    super()\n\n    this._maxParticles = maxParticles\n    this._dof = new Vector(1, 1, 1)\n    this._emittedParticles = 0\n    this._particleIdx = 0\n    this._recycleBin = []\n    this._particles = []\n    this._emitters = []\n    this._fields = []\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  //\n  //\n  /// ////////////////////////////////////////////////////////////////\n  setMaxParticles (maxParticles) {\n    this._maxParticles = maxParticles\n  }\n\n  getMaxParticles () {\n    return this._maxParticles\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  // Returns object by id\n  //\n  /// ////////////////////////////////////////////////////////////////\n  getObjectById (id) {\n    for (var emitter of this._emitters) {\n      if (emitter.getId() === id) {\n        return emitter\n      }\n    }\n\n    for (var field of this._fields) {\n      if (field.getId() === id) {\n        return field\n      }\n    }\n\n    return null\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  // Returns emitter by id\n  //\n  /// ////////////////////////////////////////////////////////////////\n  getEmitter (id) {\n    for (var emitter of this._emitters) {\n      if (emitter.getId() === id) {\n        return emitter\n      }\n    }\n\n    return null\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  // Returns magnetic field by id\n  //\n  /// ////////////////////////////////////////////////////////////////\n  getMagneticField (id) {\n    for (var field of this._fields) {\n      if (field.getId() === id) {\n        return field\n      }\n    }\n\n    return null\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  //\n  //\n  /// ////////////////////////////////////////////////////////////////\n  setDof (x, y, z) {\n    this._dof = new Vector(x, y, z)\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  // clean up all objects\n  //\n  /// ////////////////////////////////////////////////////////////////\n  destroy () {\n    this._recycleBin = []\n\n    this._particles = []\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  // Adds emitter object\n  //\n  /// ////////////////////////////////////////////////////////////////\n  addEmitter (id) {\n    var emitter = new ParticleEmitter(id)\n\n    this._emitters.push(emitter)\n\n    return emitter\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  // Adds magnetic field object\n  //\n  /// ////////////////////////////////////////////////////////////////\n  addMagneticField (id) {\n    var field = new MagneticField(id)\n\n    this._fields.push(field)\n\n    return field\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  // updates simulation\n  //\n  /// ////////////////////////////////////////////////////////////////\n  step (dt) {\n    this.addNewParticles(dt)\n    this.filterParticles(dt)\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  // add new particles step\n  //\n  /// ////////////////////////////////////////////////////////////////\n  addNewParticles (dt) {\n    this._emitters.forEach((emitter) => {\n      for (var i = 0; i < emitter.emitNumber(dt); ++i) {\n        var particle = this.popRecycle()\n\n        if (particle) {\n          emitter.emitParticle(particle)\n        }\n      }\n    })\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  // push a particle to recycle bin\n  //\n  /// ////////////////////////////////////////////////////////////////\n  pushRecycle (particle) {\n    --this._emittedParticles\n\n    particle._recycled = true\n\n    this._recycleBin.push(particle)\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  // pop a particle from recycle bin\n  //\n  /// ////////////////////////////////////////////////////////////////\n  popRecycle () {\n    if (this._emittedParticles > this._maxParticles - 1) {\n      return null\n    }\n\n    ++this._emittedParticles\n\n    var particle = this._recycleBin.pop()\n\n    if (particle) {\n      particle.reset()\n\n      return particle\n    }\n\n    particle = new Particle(this._dof)\n\n    this._particles.push(particle)\n\n    return particle\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  // filter particles using lifeTime\n  //\n  /// ////////////////////////////////////////////////////////////////\n  filterParticle (particle) {\n    if (particle._recycled) {\n      return true\n    }\n\n    if (particle._lifeTime < 0) {\n      this.pushRecycle(particle)\n\n      return true\n    }\n\n    return false\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  // filter particles step\n  //\n  /// ////////////////////////////////////////////////////////////////\n  filterParticles (dt) {\n    this._particles.forEach((particle) => {\n      if (!this.filterParticle(particle)) {\n        particle.submitToFields(this._fields)\n\n        particle.step(dt)\n      }\n    })\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  // initialize particle index\n  //\n  /// ////////////////////////////////////////////////////////////////\n  initParticleLoop () {\n    this._particleIdx = 0\n  }\n\n  /// ////////////////////////////////////////////////////////////////\n  // initialize particule index\n  //\n  /// ////////////////////////////////////////////////////////////////\n  nextParticle () {\n    if (this._particleIdx < this._particles.length) {\n      return this._particles[this._particleIdx++]\n    }\n\n    return { ptr: 0 } // compatibility with asm.js/wasm\n  }\n}\n","import ParticleSystem from './ParticleSystem'\nimport Vector from './Vector'\n\nexport default {\n  Instance: ParticleSystem,\n  Vector\n}\n"],"sourceRoot":""}